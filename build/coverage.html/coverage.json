{"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/test.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/test.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":1,"12":1,"13":1,"14":1,"15":2,"16":2,"17":2,"18":2,"19":1,"20":1,"21":2,"22":2,"23":2,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":1,"39":2,"40":2,"41":1,"42":2,"43":2,"44":1,"45":2,"46":2,"47":1,"48":2,"49":2,"50":1,"51":1,"52":1,"53":1,"54":1},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[1,1],"5":[1,1],"6":[1,1],"7":[1,1],"8":[1,1],"9":[1,1],"10":[1,1,1],"11":[1,1],"12":[1,1],"13":[1,1],"14":[1,1],"15":[1,1],"16":[1,1],"17":[1,1]},"f":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":1,"7":1,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":1},"end":{"line":12,"column":13}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":5},"end":{"line":19,"column":17}}},"3":{"name":"(anonymous_3)","line":23,"loc":{"start":{"line":23,"column":24},"end":{"line":23,"column":36}}},"4":{"name":"(anonymous_4)","line":61,"loc":{"start":{"line":61,"column":5},"end":{"line":61,"column":17}}},"5":{"name":"(anonymous_5)","line":82,"loc":{"start":{"line":82,"column":5},"end":{"line":82,"column":17}}},"6":{"name":"(anonymous_6)","line":91,"loc":{"start":{"line":91,"column":77},"end":{"line":94,"column":10}}},"7":{"name":"(anonymous_7)","line":112,"loc":{"start":{"line":112,"column":83},"end":{"line":115,"column":10}},"skip":true},"8":{"name":"(anonymous_8)","line":123,"loc":{"start":{"line":123,"column":77},"end":{"line":126,"column":10}},"skip":true},"9":{"name":"(anonymous_9)","line":139,"loc":{"start":{"line":139,"column":12},"end":{"line":139,"column":40}},"skip":true},"10":{"name":"(anonymous_10)","line":147,"loc":{"start":{"line":147,"column":77},"end":{"line":150,"column":10}},"skip":true},"11":{"name":"(anonymous_11)","line":158,"loc":{"start":{"line":158,"column":83},"end":{"line":161,"column":10}},"skip":true},"12":{"name":"(anonymous_12)","line":169,"loc":{"start":{"line":169,"column":79},"end":{"line":172,"column":10}},"skip":true},"13":{"name":"(anonymous_13)","line":180,"loc":{"start":{"line":180,"column":75},"end":{"line":183,"column":10}},"skip":true}},"statementMap":{"1":{"start":{"line":12,"column":0},"end":{"line":195,"column":5}},"2":{"start":{"line":14,"column":4},"end":{"line":14,"column":14}},"3":{"start":{"line":19,"column":4},"end":{"line":56,"column":9}},"4":{"start":{"line":21,"column":8},"end":{"line":21,"column":19}},"5":{"start":{"line":23,"column":8},"end":{"line":35,"column":13}},"6":{"start":{"line":24,"column":12},"end":{"line":34,"column":13}},"7":{"start":{"line":25,"column":16},"end":{"line":28,"column":30}},"8":{"start":{"line":30,"column":16},"end":{"line":33,"column":27}},"9":{"start":{"line":37,"column":8},"end":{"line":39,"column":21}},"10":{"start":{"line":40,"column":8},"end":{"line":53,"column":9}},"11":{"start":{"line":43,"column":12},"end":{"line":46,"column":14}},"12":{"start":{"line":47,"column":12},"end":{"line":47,"column":18}},"13":{"start":{"line":50,"column":12},"end":{"line":51,"column":33}},"14":{"start":{"line":52,"column":12},"end":{"line":52,"column":18}},"15":{"start":{"line":55,"column":8},"end":{"line":55,"column":35}},"16":{"start":{"line":61,"column":4},"end":{"line":63,"column":9}},"17":{"start":{"line":62,"column":8},"end":{"line":62,"column":15}},"18":{"start":{"line":64,"column":4},"end":{"line":77,"column":5}},"19":{"start":{"line":70,"column":8},"end":{"line":70,"column":14}},"20":{"start":{"line":76,"column":8},"end":{"line":76,"column":14}},"21":{"start":{"line":82,"column":4},"end":{"line":84,"column":9}},"22":{"start":{"line":83,"column":8},"end":{"line":83,"column":15}},"23":{"start":{"line":85,"column":4},"end":{"line":194,"column":5}},"24":{"start":{"line":91,"column":8},"end":{"line":99,"column":10}},"25":{"start":{"line":98,"column":12},"end":{"line":98,"column":35}},"26":{"start":{"line":102,"column":8},"end":{"line":104,"column":63}},"27":{"start":{"line":105,"column":8},"end":{"line":105,"column":14}},"28":{"start":{"line":112,"column":8},"end":{"line":121,"column":10},"skip":true},"29":{"start":{"line":119,"column":12},"end":{"line":119,"column":55},"skip":true},"30":{"start":{"line":120,"column":12},"end":{"line":120,"column":48},"skip":true},"31":{"start":{"line":123,"column":8},"end":{"line":136,"column":10},"skip":true},"32":{"start":{"line":130,"column":12},"end":{"line":130,"column":76},"skip":true},"33":{"start":{"line":131,"column":12},"end":{"line":131,"column":73},"skip":true},"34":{"start":{"line":132,"column":12},"end":{"line":132,"column":74},"skip":true},"35":{"start":{"line":133,"column":12},"end":{"line":133,"column":79},"skip":true},"36":{"start":{"line":134,"column":12},"end":{"line":134,"column":25},"skip":true},"37":{"start":{"line":135,"column":12},"end":{"line":135,"column":45},"skip":true},"38":{"start":{"line":138,"column":8},"end":{"line":145,"column":14},"skip":true},"39":{"start":{"line":143,"column":16},"end":{"line":143,"column":29},"skip":true},"40":{"start":{"line":144,"column":16},"end":{"line":144,"column":55},"skip":true},"41":{"start":{"line":147,"column":8},"end":{"line":156,"column":10},"skip":true},"42":{"start":{"line":154,"column":12},"end":{"line":154,"column":25},"skip":true},"43":{"start":{"line":155,"column":12},"end":{"line":155,"column":45},"skip":true},"44":{"start":{"line":158,"column":8},"end":{"line":167,"column":10},"skip":true},"45":{"start":{"line":165,"column":12},"end":{"line":165,"column":25},"skip":true},"46":{"start":{"line":166,"column":12},"end":{"line":166,"column":48},"skip":true},"47":{"start":{"line":169,"column":8},"end":{"line":178,"column":10},"skip":true},"48":{"start":{"line":176,"column":12},"end":{"line":176,"column":25},"skip":true},"49":{"start":{"line":177,"column":12},"end":{"line":177,"column":46},"skip":true},"50":{"start":{"line":180,"column":8},"end":{"line":189,"column":10},"skip":true},"51":{"start":{"line":187,"column":12},"end":{"line":187,"column":94},"skip":true},"52":{"start":{"line":188,"column":12},"end":{"line":188,"column":48},"skip":true},"53":{"start":{"line":192,"column":8},"end":{"line":192,"column":35},"skip":true},"54":{"start":{"line":193,"column":8},"end":{"line":193,"column":14},"skip":true}},"branchMap":{"1":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":62}},{"start":{"line":26,"column":20},"end":{"line":26,"column":70}},{"start":{"line":27,"column":20},"end":{"line":27,"column":71}},{"start":{"line":28,"column":20},"end":{"line":28,"column":29}}]},"2":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":23},"end":{"line":30,"column":37}},{"start":{"line":31,"column":20},"end":{"line":31,"column":61}},{"start":{"line":32,"column":20},"end":{"line":32,"column":70}},{"start":{"line":33,"column":20},"end":{"line":33,"column":26}}]},"3":{"line":37,"type":"cond-expr","locations":[{"start":{"line":38,"column":14},"end":{"line":38,"column":20}},{"start":{"line":39,"column":14},"end":{"line":39,"column":20}}]},"4":{"line":40,"type":"switch","locations":[{"start":{"line":42,"column":8},"end":{"line":47,"column":18}},{"start":{"line":49,"column":8},"end":{"line":52,"column":18}}]},"5":{"line":44,"type":"binary-expr","locations":[{"start":{"line":44,"column":16},"end":{"line":44,"column":44}},{"start":{"line":44,"column":48},"end":{"line":44,"column":66}}]},"6":{"line":50,"type":"binary-expr","locations":[{"start":{"line":50,"column":21},"end":{"line":50,"column":49}},{"start":{"line":50,"column":53},"end":{"line":50,"column":72}}]},"7":{"line":64,"type":"switch","locations":[{"start":{"line":69,"column":4},"end":{"line":70,"column":14}},{"start":{"line":75,"column":4},"end":{"line":76,"column":14}}]},"8":{"line":85,"type":"switch","locations":[{"start":{"line":90,"column":4},"end":{"line":105,"column":14}},{"start":{"line":111,"column":4},"end":{"line":193,"column":14},"skip":true}]},"9":{"line":91,"type":"binary-expr","locations":[{"start":{"line":91,"column":42},"end":{"line":91,"column":73}},{"start":{"line":91,"column":77},"end":{"line":99,"column":9}}]},"10":{"line":102,"type":"binary-expr","locations":[{"start":{"line":102,"column":18},"end":{"line":102,"column":32}},{"start":{"line":103,"column":12},"end":{"line":103,"column":53}},{"start":{"line":104,"column":12},"end":{"line":104,"column":61}}]},"11":{"line":112,"type":"binary-expr","locations":[{"start":{"line":112,"column":45},"end":{"line":112,"column":79},"skip":true},{"start":{"line":112,"column":83},"end":{"line":121,"column":9},"skip":true}]},"12":{"line":123,"type":"binary-expr","locations":[{"start":{"line":123,"column":42},"end":{"line":123,"column":73},"skip":true},{"start":{"line":123,"column":77},"end":{"line":136,"column":9},"skip":true}]},"13":{"line":138,"type":"binary-expr","locations":[{"start":{"line":138,"column":48},"end":{"line":138,"column":85},"skip":true},{"start":{"line":139,"column":12},"end":{"line":145,"column":13},"skip":true}]},"14":{"line":147,"type":"binary-expr","locations":[{"start":{"line":147,"column":42},"end":{"line":147,"column":73},"skip":true},{"start":{"line":147,"column":77},"end":{"line":156,"column":9},"skip":true}]},"15":{"line":158,"type":"binary-expr","locations":[{"start":{"line":158,"column":45},"end":{"line":158,"column":79},"skip":true},{"start":{"line":158,"column":83},"end":{"line":167,"column":9},"skip":true}]},"16":{"line":169,"type":"binary-expr","locations":[{"start":{"line":169,"column":43},"end":{"line":169,"column":75},"skip":true},{"start":{"line":169,"column":79},"end":{"line":178,"column":9},"skip":true}]},"17":{"line":180,"type":"binary-expr","locations":[{"start":{"line":180,"column":41},"end":{"line":180,"column":71},"skip":true},{"start":{"line":180,"column":75},"end":{"line":189,"column":9},"skip":true}]}},"code":["/* istanbul instrument in package npmtest_ssb_patchwork */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - init-before","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        switch (local.modeJs) {","        // re-init local from window.local","        case 'browser':","            local = local.global.utility2.objectSetDefault(","                local.global.utility2_rollup || local.global.local,","                local.global.utility2","            );","            break;","        // re-init local from example.js","        case 'node':","            local = (local.global.utility2_rollup || require('utility2'))","                .requireReadme();","            break;","        }","        // export local","        local.global.local = local;","    }());","","","","    // run shared js-env code - function","    (function () {","        return;","    }());","    switch (local.modeJs) {","","","","    // run browser js-env code - function","    case 'browser':","        break;","","","","    // run node js-env code - function","    case 'node':","        break;","    }","","","","    // run shared js-env code - init-after","    (function () {","        return;","    }());","    switch (local.modeJs) {","","","","    // run browser js-env code - init-after","    case 'browser':","        local.testCase_browser_nullCase = local.testCase_browser_nullCase || function (","            options,","            onError","        ) {","        /*","         * this function will test browsers's null-case handling-behavior-behavior","         */","            onError(null, options);","        };","","        // run tests","        local.nop(local.modeTest &&","            document.querySelector('#testRunButton1') &&","            document.querySelector('#testRunButton1').click());","        break;","","","","    // run node js-env code - init-after","    /* istanbul ignore next */","    case 'node':","        local.testCase_buildApidoc_default = local.testCase_buildApidoc_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildApidoc's default handling-behavior-behavior","         */","            options = { modulePathList: module.paths };","            local.buildApidoc(options, onError);","        };","","        local.testCase_buildApp_default = local.testCase_buildApp_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildApp's default handling-behavior-behavior","         */","            local.testCase_buildReadme_default(options, local.onErrorThrow);","            local.testCase_buildLib_default(options, local.onErrorThrow);","            local.testCase_buildTest_default(options, local.onErrorThrow);","            local.testCase_buildCustomOrg_default(options, local.onErrorThrow);","            options = [];","            local.buildApp(options, onError);","        };","","        local.testCase_buildCustomOrg_default = local.testCase_buildCustomOrg_default ||","            function (options, onError) {","            /*","             * this function will test buildCustomOrg's default handling-behavior","             */","                options = {};","                local.buildCustomOrg(options, onError);","            };","","        local.testCase_buildLib_default = local.testCase_buildLib_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildLib's default handling-behavior","         */","            options = {};","            local.buildLib(options, onError);","        };","","        local.testCase_buildReadme_default = local.testCase_buildReadme_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildReadme's default handling-behavior-behavior","         */","            options = {};","            local.buildReadme(options, onError);","        };","","        local.testCase_buildTest_default = local.testCase_buildTest_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildTest's default handling-behavior","         */","            options = {};","            local.buildTest(options, onError);","        };","","        local.testCase_webpage_default = local.testCase_webpage_default || function (","            options,","            onError","        ) {","        /*","         * this function will test webpage's default handling-behavior","         */","            options = { modeCoverageMerge: true, url: local.serverLocalHost + '?modeTest=1' };","            local.browserTest(options, onError);","        };","","        // run test-server","        local.testRunServer(local);","        break;","    }","}());",""],"l":{"12":2,"14":2,"19":2,"21":2,"23":2,"24":2,"25":2,"30":1,"37":2,"40":2,"43":1,"47":1,"50":1,"52":1,"55":2,"61":2,"62":2,"64":2,"70":1,"76":1,"82":2,"83":2,"85":2,"91":1,"98":1,"102":1,"105":1,"112":1,"119":1,"120":1,"123":1,"130":1,"131":1,"132":1,"133":1,"134":1,"135":1,"138":1,"143":2,"144":2,"147":1,"154":2,"155":2,"158":1,"165":2,"166":2,"169":1,"176":2,"177":2,"180":1,"187":1,"188":1,"192":1,"193":1}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/lib.npmtest_ssb_patchwork.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/lib.npmtest_ssb_patchwork.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1,"14":1,"15":1,"16":1},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[2,2],"5":[1,1]},"f":{"1":2,"2":2,"3":2},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":1},"end":{"line":12,"column":13}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":5},"end":{"line":19,"column":17}}},"3":{"name":"(anonymous_3)","line":23,"loc":{"start":{"line":23,"column":24},"end":{"line":23,"column":36}}}},"statementMap":{"1":{"start":{"line":12,"column":0},"end":{"line":53,"column":5}},"2":{"start":{"line":14,"column":4},"end":{"line":14,"column":14}},"3":{"start":{"line":19,"column":4},"end":{"line":52,"column":9}},"4":{"start":{"line":21,"column":8},"end":{"line":21,"column":19}},"5":{"start":{"line":23,"column":8},"end":{"line":35,"column":13}},"6":{"start":{"line":24,"column":12},"end":{"line":34,"column":13}},"7":{"start":{"line":25,"column":16},"end":{"line":28,"column":30}},"8":{"start":{"line":30,"column":16},"end":{"line":33,"column":27}},"9":{"start":{"line":37,"column":8},"end":{"line":39,"column":21}},"10":{"start":{"line":41,"column":8},"end":{"line":41,"column":54}},"11":{"start":{"line":43,"column":8},"end":{"line":43,"column":58}},"12":{"start":{"line":45,"column":8},"end":{"line":51,"column":9}},"13":{"start":{"line":46,"column":12},"end":{"line":46,"column":64}},"14":{"start":{"line":48,"column":12},"end":{"line":48,"column":35}},"15":{"start":{"line":49,"column":12},"end":{"line":49,"column":49}},"16":{"start":{"line":50,"column":12},"end":{"line":50,"column":43}}},"branchMap":{"1":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":62}},{"start":{"line":26,"column":20},"end":{"line":26,"column":70}},{"start":{"line":27,"column":20},"end":{"line":27,"column":71}},{"start":{"line":28,"column":20},"end":{"line":28,"column":29}}]},"2":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":23},"end":{"line":30,"column":37}},{"start":{"line":31,"column":20},"end":{"line":31,"column":61}},{"start":{"line":32,"column":20},"end":{"line":32,"column":70}},{"start":{"line":33,"column":20},"end":{"line":33,"column":26}}]},"3":{"line":37,"type":"cond-expr","locations":[{"start":{"line":38,"column":14},"end":{"line":38,"column":20}},{"start":{"line":39,"column":14},"end":{"line":39,"column":20}}]},"4":{"line":41,"type":"binary-expr","locations":[{"start":{"line":41,"column":16},"end":{"line":41,"column":44}},{"start":{"line":41,"column":48},"end":{"line":41,"column":53}}]},"5":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":8},"end":{"line":45,"column":8}},{"start":{"line":45,"column":8},"end":{"line":45,"column":8}}]}},"code":["/* istanbul instrument in package npmtest_ssb_patchwork */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - init-before","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        // init utility2_rollup","        local = local.global.utility2_rollup || local;","        // init lib","        local.local = local.npmtest_ssb_patchwork = local;","        // init exports","        if (local.modeJs === 'browser') {","            local.global.utility2_npmtest_ssb_patchwork = local;","        } else {","            module.exports = local;","            module.exports.__dirname = __dirname;","            module.exports.module = module;","        }","    }());","}());",""],"l":{"12":2,"14":2,"19":2,"21":2,"23":2,"24":2,"25":2,"30":1,"37":2,"41":2,"43":2,"45":2,"46":1,"48":1,"49":1,"50":1}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/example.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/example.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1,"14":2,"15":2,"16":2,"17":2,"18":2,"19":0,"20":2,"21":1,"22":1,"23":1,"24":1,"25":1,"26":0,"27":0,"28":1,"29":1,"30":2,"31":0,"32":0,"33":0,"34":1,"35":2,"36":2,"37":3,"38":3,"39":3,"40":3,"41":0,"42":3,"43":3,"44":3,"45":1,"46":3,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1,"55":1,"56":1,"57":0,"58":1,"59":6,"60":6,"61":1,"62":2,"63":0,"64":2,"65":1,"66":1,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[2,2],"5":[1,1],"6":[1,1],"7":[2,0],"8":[2,1,1,1,1,1],"9":[0,2,0],"10":[1,1],"11":[2,1,1],"12":[1,0],"13":[0,2],"14":[2,0,0,0,0,0,0],"15":[0,3],"16":[3,0],"17":[1,1],"18":[0,1],"19":[1,2,0,2],"20":[1,0],"21":[1,1],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0]},"f":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":3,"8":3,"9":3,"10":1,"11":6,"12":0},"fnMap":{"1":{"name":"(anonymous_1)","line":26,"loc":{"start":{"line":26,"column":1},"end":{"line":26,"column":13}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":5},"end":{"line":33,"column":17}}},"3":{"name":"(anonymous_3)","line":37,"loc":{"start":{"line":37,"column":24},"end":{"line":37,"column":36}}},"4":{"name":"(anonymous_4)","line":69,"loc":{"start":{"line":69,"column":31},"end":{"line":69,"column":48}},"skip":true},"5":{"name":"(anonymous_5)","line":78,"loc":{"start":{"line":78,"column":26},"end":{"line":78,"column":45}},"skip":true},"6":{"name":"(anonymous_6)","line":123,"loc":{"start":{"line":123,"column":33},"end":{"line":123,"column":48}},"skip":true},"7":{"name":"(anonymous_7)","line":125,"loc":{"start":{"line":125,"column":27},"end":{"line":125,"column":39}},"skip":true},"8":{"name":"(anonymous_8)","line":133,"loc":{"start":{"line":133,"column":59},"end":{"line":133,"column":74}},"skip":true},"9":{"name":"(anonymous_9)","line":143,"loc":{"start":{"line":143,"column":45},"end":{"line":143,"column":62}},"skip":true},"10":{"name":"(anonymous_10)","line":144,"loc":{"start":{"line":144,"column":73},"end":{"line":144,"column":92}},"skip":true},"11":{"name":"(anonymous_11)","line":272,"loc":{"start":{"line":272,"column":51},"end":{"line":272,"column":77}},"skip":true},"12":{"name":"(anonymous_12)","line":315,"loc":{"start":{"line":315,"column":32},"end":{"line":315,"column":61}},"skip":true}},"statementMap":{"1":{"start":{"line":26,"column":0},"end":{"line":326,"column":5}},"2":{"start":{"line":28,"column":4},"end":{"line":28,"column":14}},"3":{"start":{"line":33,"column":4},"end":{"line":60,"column":9}},"4":{"start":{"line":35,"column":8},"end":{"line":35,"column":19}},"5":{"start":{"line":37,"column":8},"end":{"line":49,"column":13}},"6":{"start":{"line":38,"column":12},"end":{"line":48,"column":13}},"7":{"start":{"line":39,"column":16},"end":{"line":42,"column":30}},"8":{"start":{"line":44,"column":16},"end":{"line":47,"column":27}},"9":{"start":{"line":51,"column":8},"end":{"line":53,"column":21}},"10":{"start":{"line":55,"column":8},"end":{"line":57,"column":45}},"11":{"start":{"line":59,"column":8},"end":{"line":59,"column":35}},"12":{"start":{"line":61,"column":4},"end":{"line":325,"column":5}},"13":{"start":{"line":69,"column":8},"end":{"line":121,"column":10},"skip":true},"14":{"start":{"line":70,"column":12},"end":{"line":88,"column":13},"skip":true},"15":{"start":{"line":76,"column":16},"end":{"line":87,"column":19},"skip":true},"16":{"start":{"line":79,"column":20},"end":{"line":86,"column":21},"skip":true},"17":{"start":{"line":82,"column":24},"end":{"line":82,"column":43},"skip":true},"18":{"start":{"line":83,"column":24},"end":{"line":83,"column":30},"skip":true},"19":{"start":{"line":85,"column":24},"end":{"line":85,"column":49},"skip":true},"20":{"start":{"line":89,"column":12},"end":{"line":107,"column":13},"skip":true},"21":{"start":{"line":92,"column":16},"end":{"line":102,"column":17},"skip":true},"22":{"start":{"line":93,"column":20},"end":{"line":93,"column":86},"skip":true},"23":{"start":{"line":94,"column":20},"end":{"line":95,"column":45},"skip":true},"24":{"start":{"line":96,"column":20},"end":{"line":96,"column":42},"skip":true},"25":{"start":{"line":97,"column":20},"end":{"line":97,"column":48},"skip":true},"26":{"start":{"line":100,"column":20},"end":{"line":100,"column":85},"skip":true},"27":{"start":{"line":101,"column":20},"end":{"line":101,"column":96},"skip":true},"28":{"start":{"line":103,"column":16},"end":{"line":103,"column":22},"skip":true},"29":{"start":{"line":106,"column":16},"end":{"line":106,"column":22},"skip":true},"30":{"start":{"line":108,"column":12},"end":{"line":120,"column":13},"skip":true},"31":{"start":{"line":114,"column":16},"end":{"line":119,"column":17},"skip":true},"32":{"start":{"line":116,"column":20},"end":{"line":116,"column":78},"skip":true},"33":{"start":{"line":118,"column":20},"end":{"line":118,"column":47},"skip":true},"34":{"start":{"line":123,"column":8},"end":{"line":141,"column":11},"skip":true},"35":{"start":{"line":124,"column":12},"end":{"line":124,"column":54},"skip":true},"36":{"start":{"line":125,"column":12},"end":{"line":140,"column":14},"skip":true},"37":{"start":{"line":126,"column":16},"end":{"line":126,"column":28},"skip":true},"38":{"start":{"line":127,"column":16},"end":{"line":127,"column":69},"skip":true},"39":{"start":{"line":128,"column":16},"end":{"line":128,"column":75},"skip":true},"40":{"start":{"line":129,"column":16},"end":{"line":131,"column":17},"skip":true},"41":{"start":{"line":130,"column":20},"end":{"line":130,"column":27},"skip":true},"42":{"start":{"line":133,"column":16},"end":{"line":137,"column":36},"skip":true},"43":{"start":{"line":134,"column":20},"end":{"line":136,"column":55},"skip":true},"44":{"start":{"line":139,"column":16},"end":{"line":139,"column":57},"skip":true},"45":{"start":{"line":143,"column":8},"end":{"line":147,"column":11},"skip":true},"46":{"start":{"line":144,"column":12},"end":{"line":146,"column":15},"skip":true},"47":{"start":{"line":145,"column":16},"end":{"line":145,"column":70},"skip":true},"48":{"start":{"line":149,"column":8},"end":{"line":149,"column":31},"skip":true},"49":{"start":{"line":150,"column":8},"end":{"line":150,"column":14},"skip":true},"50":{"start":{"line":158,"column":8},"end":{"line":158,"column":31},"skip":true},"51":{"start":{"line":160,"column":8},"end":{"line":160,"column":33},"skip":true},"52":{"start":{"line":161,"column":8},"end":{"line":161,"column":37},"skip":true},"53":{"start":{"line":162,"column":8},"end":{"line":162,"column":35},"skip":true},"54":{"start":{"line":164,"column":8},"end":{"line":164,"column":50},"skip":true},"55":{"start":{"line":166,"column":8},"end":{"line":256,"column":2},"skip":true},"56":{"start":{"line":258,"column":8},"end":{"line":286,"column":9},"skip":true},"57":{"start":{"line":259,"column":12},"end":{"line":269,"column":14},"skip":true},"58":{"start":{"line":271,"column":12},"end":{"line":285,"column":19},"skip":true},"59":{"start":{"line":274,"column":20},"end":{"line":274,"column":35},"skip":true},"60":{"start":{"line":275,"column":20},"end":{"line":284,"column":21},"skip":true},"61":{"start":{"line":277,"column":24},"end":{"line":277,"column":64},"skip":true},"62":{"start":{"line":279,"column":24},"end":{"line":279,"column":40},"skip":true},"63":{"start":{"line":281,"column":24},"end":{"line":281,"column":40},"skip":true},"64":{"start":{"line":283,"column":24},"end":{"line":283,"column":39},"skip":true},"65":{"start":{"line":288,"column":8},"end":{"line":290,"column":9},"skip":true},"66":{"start":{"line":289,"column":12},"end":{"line":289,"column":18},"skip":true},"67":{"start":{"line":291,"column":8},"end":{"line":293,"column":54},"skip":true},"68":{"start":{"line":296,"column":8},"end":{"line":301,"column":37},"skip":true},"69":{"start":{"line":303,"column":8},"end":{"line":303,"column":82},"skip":true},"70":{"start":{"line":306,"column":8},"end":{"line":308,"column":9},"skip":true},"71":{"start":{"line":307,"column":12},"end":{"line":307,"column":82},"skip":true},"72":{"start":{"line":310,"column":8},"end":{"line":312,"column":9},"skip":true},"73":{"start":{"line":311,"column":12},"end":{"line":311,"column":18},"skip":true},"74":{"start":{"line":313,"column":8},"end":{"line":313,"column":54},"skip":true},"75":{"start":{"line":314,"column":8},"end":{"line":314,"column":69},"skip":true},"76":{"start":{"line":315,"column":8},"end":{"line":323,"column":36},"skip":true},"77":{"start":{"line":316,"column":12},"end":{"line":316,"column":61},"skip":true},"78":{"start":{"line":317,"column":12},"end":{"line":320,"column":13},"skip":true},"79":{"start":{"line":318,"column":16},"end":{"line":318,"column":75},"skip":true},"80":{"start":{"line":319,"column":16},"end":{"line":319,"column":23},"skip":true},"81":{"start":{"line":321,"column":12},"end":{"line":321,"column":38},"skip":true},"82":{"start":{"line":322,"column":12},"end":{"line":322,"column":27},"skip":true},"83":{"start":{"line":324,"column":8},"end":{"line":324,"column":14},"skip":true}},"branchMap":{"1":{"line":39,"type":"binary-expr","locations":[{"start":{"line":39,"column":23},"end":{"line":39,"column":62}},{"start":{"line":40,"column":20},"end":{"line":40,"column":70}},{"start":{"line":41,"column":20},"end":{"line":41,"column":71}},{"start":{"line":42,"column":20},"end":{"line":42,"column":29}}]},"2":{"line":44,"type":"binary-expr","locations":[{"start":{"line":44,"column":23},"end":{"line":44,"column":37}},{"start":{"line":45,"column":20},"end":{"line":45,"column":61}},{"start":{"line":46,"column":20},"end":{"line":46,"column":70}},{"start":{"line":47,"column":20},"end":{"line":47,"column":26}}]},"3":{"line":51,"type":"cond-expr","locations":[{"start":{"line":52,"column":14},"end":{"line":52,"column":20}},{"start":{"line":53,"column":14},"end":{"line":53,"column":20}}]},"4":{"line":55,"type":"binary-expr","locations":[{"start":{"line":55,"column":16},"end":{"line":55,"column":44}},{"start":{"line":55,"column":49},"end":{"line":57,"column":43}}]},"5":{"line":55,"type":"cond-expr","locations":[{"start":{"line":56,"column":14},"end":{"line":56,"column":57}},{"start":{"line":57,"column":14},"end":{"line":57,"column":43}}]},"6":{"line":61,"type":"switch","locations":[{"start":{"line":68,"column":4},"end":{"line":150,"column":14},"skip":true},{"start":{"line":156,"column":4},"end":{"line":324,"column":14},"skip":true}]},"7":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":12},"end":{"line":70,"column":12},"skip":true},{"start":{"line":70,"column":12},"end":{"line":70,"column":12},"skip":true}]},"8":{"line":70,"type":"binary-expr","locations":[{"start":{"line":70,"column":16},"end":{"line":70,"column":22},"skip":true},{"start":{"line":70,"column":27},"end":{"line":70,"column":32},"skip":true},{"start":{"line":71,"column":20},"end":{"line":71,"column":39},"skip":true},{"start":{"line":72,"column":20},"end":{"line":72,"column":49},"skip":true},{"start":{"line":73,"column":20},"end":{"line":73,"column":58},"skip":true},{"start":{"line":74,"column":20},"end":{"line":74,"column":69},"skip":true}]},"9":{"line":79,"type":"switch","locations":[{"start":{"line":80,"column":20},"end":{"line":80,"column":33},"skip":true},{"start":{"line":81,"column":20},"end":{"line":83,"column":30},"skip":true},{"start":{"line":84,"column":20},"end":{"line":85,"column":49},"skip":true}]},"10":{"line":89,"type":"switch","locations":[{"start":{"line":90,"column":12},"end":{"line":103,"column":22},"skip":true},{"start":{"line":105,"column":12},"end":{"line":106,"column":22},"skip":true}]},"11":{"line":89,"type":"binary-expr","locations":[{"start":{"line":89,"column":20},"end":{"line":89,"column":25},"skip":true},{"start":{"line":89,"column":29},"end":{"line":89,"column":48},"skip":true},{"start":{"line":89,"column":52},"end":{"line":89,"column":74},"skip":true}]},"12":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":16},"end":{"line":92,"column":16},"skip":true},{"start":{"line":92,"column":16},"end":{"line":92,"column":16},"skip":true}]},"13":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":12},"end":{"line":108,"column":12},"skip":true},{"start":{"line":108,"column":12},"end":{"line":108,"column":12},"skip":true}]},"14":{"line":108,"type":"binary-expr","locations":[{"start":{"line":108,"column":16},"end":{"line":108,"column":61},"skip":true},{"start":{"line":108,"column":66},"end":{"line":108,"column":72},"skip":true},{"start":{"line":108,"column":77},"end":{"line":108,"column":82},"skip":true},{"start":{"line":109,"column":20},"end":{"line":109,"column":39},"skip":true},{"start":{"line":110,"column":20},"end":{"line":110,"column":49},"skip":true},{"start":{"line":111,"column":20},"end":{"line":111,"column":58},"skip":true},{"start":{"line":112,"column":20},"end":{"line":112,"column":68},"skip":true}]},"15":{"line":129,"type":"if","locations":[{"start":{"line":129,"column":16},"end":{"line":129,"column":16},"skip":true},{"start":{"line":129,"column":16},"end":{"line":129,"column":16},"skip":true}]},"16":{"line":134,"type":"cond-expr","locations":[{"start":{"line":135,"column":26},"end":{"line":135,"column":29},"skip":true},{"start":{"line":136,"column":26},"end":{"line":136,"column":54},"skip":true}]},"17":{"line":164,"type":"binary-expr","locations":[{"start":{"line":164,"column":27},"end":{"line":164,"column":43},"skip":true},{"start":{"line":164,"column":47},"end":{"line":164,"column":49},"skip":true}]},"18":{"line":258,"type":"if","locations":[{"start":{"line":258,"column":8},"end":{"line":258,"column":8},"skip":true},{"start":{"line":258,"column":8},"end":{"line":258,"column":8},"skip":true}]},"19":{"line":275,"type":"switch","locations":[{"start":{"line":276,"column":20},"end":{"line":277,"column":64},"skip":true},{"start":{"line":278,"column":20},"end":{"line":279,"column":40},"skip":true},{"start":{"line":280,"column":20},"end":{"line":281,"column":40},"skip":true},{"start":{"line":282,"column":20},"end":{"line":283,"column":39},"skip":true}]},"20":{"line":288,"type":"if","locations":[{"start":{"line":288,"column":8},"end":{"line":288,"column":8},"skip":true},{"start":{"line":288,"column":8},"end":{"line":288,"column":8},"skip":true}]},"21":{"line":288,"type":"binary-expr","locations":[{"start":{"line":288,"column":12},"end":{"line":288,"column":40},"skip":true},{"start":{"line":288,"column":44},"end":{"line":288,"column":67},"skip":true}]},"22":{"line":292,"type":"binary-expr","locations":[{"start":{"line":292,"column":12},"end":{"line":292,"column":50},"skip":true},{"start":{"line":293,"column":12},"end":{"line":293,"column":53},"skip":true}]},"23":{"line":297,"type":"binary-expr","locations":[{"start":{"line":297,"column":12},"end":{"line":297,"column":71},"skip":true},{"start":{"line":298,"column":12},"end":{"line":301,"column":36},"skip":true}]},"24":{"line":303,"type":"binary-expr","locations":[{"start":{"line":303,"column":43},"end":{"line":303,"column":75},"skip":true},{"start":{"line":303,"column":79},"end":{"line":303,"column":81},"skip":true}]},"25":{"line":306,"type":"if","locations":[{"start":{"line":306,"column":8},"end":{"line":306,"column":8},"skip":true},{"start":{"line":306,"column":8},"end":{"line":306,"column":8},"skip":true}]},"26":{"line":310,"type":"if","locations":[{"start":{"line":310,"column":8},"end":{"line":310,"column":8},"skip":true},{"start":{"line":310,"column":8},"end":{"line":310,"column":8},"skip":true}]},"27":{"line":313,"type":"binary-expr","locations":[{"start":{"line":313,"column":27},"end":{"line":313,"column":43},"skip":true},{"start":{"line":313,"column":47},"end":{"line":313,"column":53},"skip":true}]},"28":{"line":317,"type":"if","locations":[{"start":{"line":317,"column":12},"end":{"line":317,"column":12},"skip":true},{"start":{"line":317,"column":12},"end":{"line":317,"column":12},"skip":true}]}},"code":["/*","example.js","","quickstart example","","instruction","    1. save this script as example.js","    2. run the shell command:","        $ npm install npmtest-ssb-patchwork && PORT=8081 node example.js","    3. play with the browser-demo on http://127.0.0.1:8081","*/","","","","/* istanbul instrument in package npmtest_ssb_patchwork */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - init-before","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        // init utility2_rollup","        local = local.global.utility2_rollup || (local.modeJs === 'browser'","            ? local.global.utility2_npmtest_ssb_patchwork","            : global.utility2_moduleExports);","        // export local","        local.global.local = local;","    }());","    switch (local.modeJs) {","","","","    // init-after","    // run browser js-env code - init-after","    /* istanbul ignore next */","    case 'browser':","        local.testRunBrowser = function (event) {","            if (!event || (event &&","                    event.currentTarget &&","                    event.currentTarget.className &&","                    event.currentTarget.className.includes &&","                    event.currentTarget.className.includes('onreset'))) {","                // reset output","                Array.from(","                    document.querySelectorAll('body > .resettable')","                ).forEach(function (element) {","                    switch (element.tagName) {","                    case 'INPUT':","                    case 'TEXTAREA':","                        element.value = '';","                        break;","                    default:","                        element.textContent = '';","                    }","                });","            }","            switch (event && event.currentTarget && event.currentTarget.id) {","            case 'testRunButton1':","                // show tests","                if (document.querySelector('#testReportDiv1').style.display === 'none') {","                    document.querySelector('#testReportDiv1').style.display = 'block';","                    document.querySelector('#testRunButton1').textContent =","                        'hide internal test';","                    local.modeTest = true;","                    local.testRunDefault(local);","                // hide tests","                } else {","                    document.querySelector('#testReportDiv1').style.display = 'none';","                    document.querySelector('#testRunButton1').textContent = 'run internal test';","                }","                break;","            // custom-case","            default:","                break;","            }","            if (document.querySelector('#inputTextareaEval1') && (!event || (event &&","                    event.currentTarget &&","                    event.currentTarget.className &&","                    event.currentTarget.className.includes &&","                    event.currentTarget.className.includes('oneval')))) {","                // try to eval input-code","                try {","                    /*jslint evil: true*/","                    eval(document.querySelector('#inputTextareaEval1').value);","                } catch (errorCaught) {","                    console.error(errorCaught);","                }","            }","        };","        // log stderr and stdout to #outputTextareaStdout1","        ['error', 'log'].forEach(function (key) {","            console[key + '_original'] = console[key];","            console[key] = function () {","                var element;","                console[key + '_original'].apply(console, arguments);","                element = document.querySelector('#outputTextareaStdout1');","                if (!element) {","                    return;","                }","                // append text to #outputTextareaStdout1","                element.value += Array.from(arguments).map(function (arg) {","                    return typeof arg === 'string'","                        ? arg","                        : JSON.stringify(arg, null, 4);","                }).join(' ') + '\\n';","                // scroll textarea to bottom","                element.scrollTop = element.scrollHeight;","            };","        });","        // init event-handling","        ['change', 'click', 'keyup'].forEach(function (event) {","            Array.from(document.querySelectorAll('.on' + event)).forEach(function (element) {","                element.addEventListener(event, local.testRunBrowser);","            });","        });","        // run tests","        local.testRunBrowser();","        break;","","","","    // run node js-env code - init-after","    /* istanbul ignore next */","    case 'node':","        // export local","        module.exports = local;","        // require modules","        local.fs = require('fs');","        local.http = require('http');","        local.url = require('url');","        // init assets","        local.assetsDict = local.assetsDict || {};","        /* jslint-ignore-begin */","        local.assetsDict['/assets.index.template.html'] = '\\","<!doctype html>\\n\\","<html lang=\"en\">\\n\\","<head>\\n\\","<meta charset=\"UTF-8\">\\n\\","<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\\n\\","<title>{{env.npm_package_name}} (v{{env.npm_package_version}})</title>\\n\\","<style>\\n\\","/*csslint\\n\\","    box-sizing: false,\\n\\","    universal-selector: false\\n\\","*/\\n\\","* {\\n\\","    box-sizing: border-box;\\n\\","}\\n\\","body {\\n\\","    background: #dde;\\n\\","    font-family: Arial, Helvetica, sans-serif;\\n\\","    margin: 2rem;\\n\\","}\\n\\","body > * {\\n\\","    margin-bottom: 1rem;\\n\\","}\\n\\",".utility2FooterDiv {\\n\\","    margin-top: 20px;\\n\\","    text-align: center;\\n\\","}\\n\\","</style>\\n\\","<style>\\n\\","/*csslint\\n\\","*/\\n\\","textarea {\\n\\","    font-family: monospace;\\n\\","    height: 10rem;\\n\\","    width: 100%;\\n\\","}\\n\\","textarea[readonly] {\\n\\","    background: #ddd;\\n\\","}\\n\\","</style>\\n\\","</head>\\n\\","<body>\\n\\","<!-- utility2-comment\\n\\","<div id=\"ajaxProgressDiv1\" style=\"background: #d00; height: 2px; left: 0; margin: 0; padding: 0; position: fixed; top: 0; transition: background 0.5s, width 1.5s; width: 25%;\"></div>\\n\\","utility2-comment -->\\n\\","<h1>\\n\\","<!-- utility2-comment\\n\\","    <a\\n\\","        {{#if env.npm_package_homepage}}\\n\\","        href=\"{{env.npm_package_homepage}}\"\\n\\","        {{/if env.npm_package_homepage}}\\n\\","        target=\"_blank\"\\n\\","    >\\n\\","utility2-comment -->\\n\\","        {{env.npm_package_name}} (v{{env.npm_package_version}})\\n\\","<!-- utility2-comment\\n\\","    </a>\\n\\","utility2-comment -->\\n\\","</h1>\\n\\","<h3>{{env.npm_package_description}}</h3>\\n\\","<!-- utility2-comment\\n\\","<h4><a download href=\"assets.app.js\">download standalone app</a></h4>\\n\\","<button class=\"onclick onreset\" id=\"testRunButton1\">run internal test</button><br>\\n\\","<div id=\"testReportDiv1\" style=\"display: none;\"></div>\\n\\","utility2-comment -->\\n\\","\\n\\","\\n\\","\\n\\","<label>stderr and stdout</label>\\n\\","<textarea class=\"resettable\" id=\"outputTextareaStdout1\" readonly></textarea>\\n\\","<!-- utility2-comment\\n\\","{{#if isRollup}}\\n\\","<script src=\"assets.app.js\"></script>\\n\\","{{#unless isRollup}}\\n\\","utility2-comment -->\\n\\","<script src=\"assets.utility2.rollup.js\"></script>\\n\\","<script src=\"jsonp.utility2._stateInit?callback=window.utility2._stateInit\"></script>\\n\\","<script src=\"assets.npmtest_ssb_patchwork.rollup.js\"></script>\\n\\","<script src=\"assets.example.js\"></script>\\n\\","<script src=\"assets.test.js\"></script>\\n\\","<!-- utility2-comment\\n\\","{{/if isRollup}}\\n\\","utility2-comment -->\\n\\","<div class=\"utility2FooterDiv\">\\n\\","    [ this app was created with\\n\\","    <a href=\"https://github.com/kaizhu256/node-utility2\" target=\"_blank\">utility2</a>\\n\\","    ]\\n\\","</div>\\n\\","</body>\\n\\","</html>\\n\\","';","        /* jslint-ignore-end */","        if (local.templateRender) {","            local.assetsDict['/'] = local.templateRender(","                local.assetsDict['/assets.index.template.html'],","                {","                    env: local.objectSetDefault(local.env, {","                        npm_package_description: 'the greatest app in the world!',","                        npm_package_name: 'my-app',","                        npm_package_nameAlias: 'my_app',","                        npm_package_version: '0.0.1'","                    })","                }","            );","        } else {","            local.assetsDict['/'] = local.assetsDict['/assets.index.template.html']","                .replace((/\\{\\{env\\.(\\w+?)\\}\\}/g), function (match0, match1) {","                    // jslint-hack","                    String(match0);","                    switch (match1) {","                    case 'npm_package_description':","                        return 'the greatest app in the world!';","                    case 'npm_package_name':","                        return 'my-app';","                    case 'npm_package_nameAlias':","                        return 'my_app';","                    case 'npm_package_version':","                        return '0.0.1';","                    }","                });","        }","        // run the cli","        if (local.global.utility2_rollup || module !== require.main) {","            break;","        }","        local.assetsDict['/assets.example.js'] =","            local.assetsDict['/assets.example.js'] ||","            local.fs.readFileSync(__filename, 'utf8');","        // bug-workaround - long $npm_package_buildCustomOrg","        /* jslint-ignore-begin */","        local.assetsDict['/assets.npmtest_ssb_patchwork.rollup.js'] =","            local.assetsDict['/assets.npmtest_ssb_patchwork.rollup.js'] ||","            local.fs.readFileSync(","                local.npmtest_ssb_patchwork.__dirname + '/lib.npmtest_ssb_patchwork.js',","                'utf8'","            ).replace((/^#!/), '//');","        /* jslint-ignore-end */","        local.assetsDict['/favicon.ico'] = local.assetsDict['/favicon.ico'] || '';","        // if $npm_config_timeout_exit exists,","        // then exit this process after $npm_config_timeout_exit ms","        if (Number(process.env.npm_config_timeout_exit)) {","            setTimeout(process.exit, Number(process.env.npm_config_timeout_exit));","        }","        // start server","        if (local.global.utility2_serverHttp1) {","            break;","        }","        process.env.PORT = process.env.PORT || '8081';","        console.error('server starting on port ' + process.env.PORT);","        local.http.createServer(function (request, response) {","            request.urlParsed = local.url.parse(request.url);","            if (local.assetsDict[request.urlParsed.pathname] !== undefined) {","                response.end(local.assetsDict[request.urlParsed.pathname]);","                return;","            }","            response.statusCode = 404;","            response.end();","        }).listen(process.env.PORT);","        break;","    }","}());",""],"l":{"26":2,"28":2,"33":2,"35":2,"37":2,"38":2,"39":2,"44":1,"51":2,"55":2,"59":2,"61":2,"69":1,"70":2,"76":2,"79":2,"82":2,"83":2,"85":1,"89":2,"92":1,"93":1,"94":1,"96":1,"97":1,"100":1,"101":1,"103":1,"106":1,"108":2,"114":1,"116":1,"118":1,"123":1,"124":2,"125":2,"126":3,"127":3,"128":3,"129":3,"130":1,"133":3,"134":3,"139":3,"143":1,"144":3,"145":1,"149":1,"150":1,"158":1,"160":1,"161":1,"162":1,"164":1,"166":1,"258":1,"259":1,"271":1,"274":6,"275":6,"277":1,"279":2,"281":1,"283":2,"288":1,"289":1,"291":1,"296":1,"303":1,"306":1,"307":1,"310":1,"311":1,"313":1,"314":1,"315":1,"316":1,"317":1,"318":1,"319":1,"321":1,"322":1,"324":1}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/index.js","s":{"1":6,"2":6,"3":6,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"b":{"1":[0,0],"2":[0,0]},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":29}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":33}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":67}},"4":{"start":{"line":7,"column":0},"end":{"line":7,"column":72}},"5":{"start":{"line":8,"column":0},"end":{"line":10,"column":69}},"6":{"start":{"line":9,"column":2},"end":{"line":10,"column":69}},"7":{"start":{"line":14,"column":0},"end":{"line":18,"column":1}},"8":{"start":{"line":15,"column":2},"end":{"line":15,"column":31}},"9":{"start":{"line":17,"column":2},"end":{"line":17,"column":37}}},"branchMap":{"1":{"line":8,"type":"if","locations":[{"start":{"line":8,"column":0},"end":{"line":8,"column":0}},{"start":{"line":8,"column":0},"end":{"line":8,"column":0}}]},"2":{"line":14,"type":"if","locations":[{"start":{"line":14,"column":0},"end":{"line":14,"column":0}},{"start":{"line":14,"column":0},"end":{"line":14,"column":0}}]}},"code":["//#! /usr/bin/env node","","// load config","var path    = require('path')","var ssbKeys = require('ssb-keys')","var config  = require('ssb-config/inject')(process.env.ssb_appname)","config.keys = ssbKeys.loadOrCreateSync(path.join(config.path, 'secret'))","if(config.keys.curve === 'k256')","  throw new Error('k256 curves are no longer supported,'+","                  'please delete' + path.join(config.path, 'secret'))","","","// run electron-specific code, if appropriate","if (process.versions['electron']) {","  require('./electron')(config)","} else {","  require('./server-process')(config)","}",""],"l":{"4":6,"5":6,"6":6,"7":0,"8":0,"9":0,"14":0,"15":0,"17":0}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/config.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/config.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":1,"54":0,"55":1,"56":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"fnMap":{"1":{"name":"(anonymous_1)","line":2,"loc":{"start":{"line":2,"column":17},"end":{"line":2,"column":33}}},"2":{"name":"(anonymous_2)","line":5,"loc":{"start":{"line":5,"column":17},"end":{"line":5,"column":29}}},"3":{"name":"(anonymous_3)","line":8,"loc":{"start":{"line":8,"column":13},"end":{"line":8,"column":25}}},"4":{"name":"(anonymous_4)","line":11,"loc":{"start":{"line":11,"column":17},"end":{"line":11,"column":29}}},"5":{"name":"(anonymous_5)","line":15,"loc":{"start":{"line":15,"column":23},"end":{"line":15,"column":35}}},"6":{"name":"(anonymous_6)","line":19,"loc":{"start":{"line":19,"column":22},"end":{"line":19,"column":34}}},"7":{"name":"(anonymous_7)","line":22,"loc":{"start":{"line":22,"column":19},"end":{"line":22,"column":34}}},"8":{"name":"(anonymous_8)","line":26,"loc":{"start":{"line":26,"column":12},"end":{"line":26,"column":24}}},"9":{"name":"(anonymous_9)","line":29,"loc":{"start":{"line":29,"column":17},"end":{"line":29,"column":29}}},"10":{"name":"(anonymous_10)","line":60,"loc":{"start":{"line":60,"column":12},"end":{"line":60,"column":24}}},"11":{"name":"(anonymous_11)","line":68,"loc":{"start":{"line":68,"column":14},"end":{"line":68,"column":26}}},"12":{"name":"(anonymous_12)","line":76,"loc":{"start":{"line":76,"column":17},"end":{"line":76,"column":29}}},"13":{"name":"isString","line":108,"loc":{"start":{"line":108,"column":0},"end":{"line":108,"column":22}}},"14":{"name":"isObject","line":111,"loc":{"start":{"line":111,"column":0},"end":{"line":111,"column":22}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":22}},"2":{"start":{"line":2,"column":0},"end":{"line":106,"column":1}},"3":{"start":{"line":4,"column":2},"end":{"line":79,"column":3}},"4":{"start":{"line":6,"column":6},"end":{"line":6,"column":37}},"5":{"start":{"line":9,"column":6},"end":{"line":9,"column":17}},"6":{"start":{"line":12,"column":6},"end":{"line":12,"column":93}},"7":{"start":{"line":16,"column":6},"end":{"line":16,"column":35}},"8":{"start":{"line":20,"column":6},"end":{"line":20,"column":46}},"9":{"start":{"line":23,"column":6},"end":{"line":23,"column":44}},"10":{"start":{"line":27,"column":6},"end":{"line":27,"column":23}},"11":{"start":{"line":30,"column":6},"end":{"line":33,"column":7}},"12":{"start":{"line":31,"column":8},"end":{"line":31,"column":115}},"13":{"start":{"line":32,"column":8},"end":{"line":32,"column":20}},"14":{"start":{"line":34,"column":6},"end":{"line":37,"column":7}},"15":{"start":{"line":35,"column":8},"end":{"line":35,"column":91}},"16":{"start":{"line":36,"column":8},"end":{"line":36,"column":20}},"17":{"start":{"line":38,"column":6},"end":{"line":41,"column":7}},"18":{"start":{"line":39,"column":8},"end":{"line":39,"column":93}},"19":{"start":{"line":40,"column":8},"end":{"line":40,"column":20}},"20":{"start":{"line":42,"column":6},"end":{"line":49,"column":7}},"21":{"start":{"line":43,"column":8},"end":{"line":43,"column":47}},"22":{"start":{"line":44,"column":8},"end":{"line":45,"column":21}},"23":{"start":{"line":45,"column":10},"end":{"line":45,"column":21}},"24":{"start":{"line":47,"column":8},"end":{"line":47,"column":83}},"25":{"start":{"line":48,"column":8},"end":{"line":48,"column":20}},"26":{"start":{"line":50,"column":6},"end":{"line":57,"column":7}},"27":{"start":{"line":51,"column":8},"end":{"line":51,"column":49}},"28":{"start":{"line":52,"column":8},"end":{"line":53,"column":21}},"29":{"start":{"line":53,"column":10},"end":{"line":53,"column":21}},"30":{"start":{"line":55,"column":8},"end":{"line":55,"column":84}},"31":{"start":{"line":56,"column":8},"end":{"line":56,"column":20}},"32":{"start":{"line":58,"column":6},"end":{"line":58,"column":17}},"33":{"start":{"line":61,"column":6},"end":{"line":64,"column":7}},"34":{"start":{"line":70,"column":6},"end":{"line":71,"column":19}},"35":{"start":{"line":71,"column":8},"end":{"line":71,"column":19}},"36":{"start":{"line":73,"column":6},"end":{"line":74,"column":19}},"37":{"start":{"line":74,"column":8},"end":{"line":74,"column":19}},"38":{"start":{"line":77,"column":6},"end":{"line":77,"column":24}},"39":{"start":{"line":84,"column":2},"end":{"line":87,"column":38}},"40":{"start":{"line":85,"column":4},"end":{"line":85,"column":39}},"41":{"start":{"line":87,"column":4},"end":{"line":87,"column":38}},"42":{"start":{"line":90,"column":2},"end":{"line":93,"column":33}},"43":{"start":{"line":91,"column":4},"end":{"line":91,"column":34}},"44":{"start":{"line":93,"column":4},"end":{"line":93,"column":33}},"45":{"start":{"line":96,"column":2},"end":{"line":103,"column":43}},"46":{"start":{"line":97,"column":4},"end":{"line":97,"column":44}},"47":{"start":{"line":98,"column":4},"end":{"line":99,"column":104}},"48":{"start":{"line":99,"column":6},"end":{"line":99,"column":104}},"49":{"start":{"line":100,"column":4},"end":{"line":101,"column":156}},"50":{"start":{"line":101,"column":6},"end":{"line":101,"column":156}},"51":{"start":{"line":103,"column":4},"end":{"line":103,"column":43}},"52":{"start":{"line":105,"column":2},"end":{"line":105,"column":15}},"53":{"start":{"line":108,"column":0},"end":{"line":110,"column":1}},"54":{"start":{"line":109,"column":2},"end":{"line":109,"column":34}},"55":{"start":{"line":111,"column":0},"end":{"line":113,"column":1}},"56":{"start":{"line":112,"column":2},"end":{"line":112,"column":34}}},"branchMap":{"1":{"line":6,"type":"binary-expr","locations":[{"start":{"line":6,"column":13},"end":{"line":6,"column":22}},{"start":{"line":6,"column":26},"end":{"line":6,"column":37}}]},"2":{"line":12,"type":"cond-expr","locations":[{"start":{"line":12,"column":30},"end":{"line":12,"column":37}},{"start":{"line":12,"column":38},"end":{"line":12,"column":44}}]},"3":{"line":30,"type":"if","locations":[{"start":{"line":30,"column":6},"end":{"line":30,"column":6}},{"start":{"line":30,"column":6},"end":{"line":30,"column":6}}]},"4":{"line":34,"type":"if","locations":[{"start":{"line":34,"column":6},"end":{"line":34,"column":6}},{"start":{"line":34,"column":6},"end":{"line":34,"column":6}}]},"5":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":6},"end":{"line":38,"column":6}},{"start":{"line":38,"column":6},"end":{"line":38,"column":6}}]},"6":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":8},"end":{"line":44,"column":8}},{"start":{"line":44,"column":8},"end":{"line":44,"column":8}}]},"7":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":8},"end":{"line":52,"column":8}},{"start":{"line":52,"column":8},"end":{"line":52,"column":8}}]},"8":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":6},"end":{"line":70,"column":6}},{"start":{"line":70,"column":6},"end":{"line":70,"column":6}}]},"9":{"line":70,"type":"binary-expr","locations":[{"start":{"line":70,"column":10},"end":{"line":70,"column":34}},{"start":{"line":70,"column":38},"end":{"line":70,"column":52}}]},"10":{"line":73,"type":"if","locations":[{"start":{"line":73,"column":6},"end":{"line":73,"column":6}},{"start":{"line":73,"column":6},"end":{"line":73,"column":6}}]},"11":{"line":73,"type":"binary-expr","locations":[{"start":{"line":73,"column":10},"end":{"line":73,"column":23}},{"start":{"line":73,"column":27},"end":{"line":73,"column":46}}]},"12":{"line":84,"type":"if","locations":[{"start":{"line":84,"column":2},"end":{"line":84,"column":2}},{"start":{"line":84,"column":2},"end":{"line":84,"column":2}}]},"13":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":2},"end":{"line":90,"column":2}},{"start":{"line":90,"column":2},"end":{"line":90,"column":2}}]},"14":{"line":96,"type":"if","locations":[{"start":{"line":96,"column":2},"end":{"line":96,"column":2}},{"start":{"line":96,"column":2},"end":{"line":96,"column":2}}]},"15":{"line":98,"type":"if","locations":[{"start":{"line":98,"column":4},"end":{"line":98,"column":4}},{"start":{"line":98,"column":4},"end":{"line":98,"column":4}}]},"16":{"line":100,"type":"if","locations":[{"start":{"line":100,"column":4},"end":{"line":100,"column":4}},{"start":{"line":100,"column":4},"end":{"line":100,"column":4}}]},"17":{"line":109,"type":"binary-expr","locations":[{"start":{"line":109,"column":9},"end":{"line":109,"column":10}},{"start":{"line":109,"column":14},"end":{"line":109,"column":34}}]},"18":{"line":112,"type":"binary-expr","locations":[{"start":{"line":112,"column":9},"end":{"line":112,"column":10}},{"start":{"line":112,"column":14},"end":{"line":112,"column":34}}]}},"code":["var fs = require('fs')","module.exports = function (conf) {","  // ask the oracle thy question","  var oracle = {","    getHostname: function () {","      return conf.host || 'localhost'","    },","    getPort: function () {","      return 7777","    },","    getLocalUrl: function () {","      return (oracle.useTLS()?'https':'http')+'://'+oracle.getHostname()+':'+oracle.getPort()","    },","","    allowRemoteAccess: function () {","      return conf.allowRemoteAccess","    },","","    requiresPassword: function () {","      return isString(conf.singleUserPassword)","    },","    checkPassword: function (str) {","      return str === conf.singleUserPassword","    },","","    useTLS: function () {","      return !!conf.tls","    },","    validateTLS: function () {","      if (!isObject(conf.tls)) {","        console.log('ERROR! tls config requires tls.key (path to the keyfile) and tls.cert (path to the certfile)')","        return false","      }","      if (!isString(conf.tls.key)) {","        console.log('ERROR! tls.key, a path to your TLS key, is required for TLS to work.')","        return false","      }","      if (!isString(conf.tls.cert)) {","        console.log('ERROR! tls.cert, a path to your TLS cert, is required for TLS to work.')","        return false","      }","      try {","        var keyStat = fs.statSync(conf.tls.key)","        if (!keyStat.isFile())","          throw \"err\"","      } catch (e) {","        console.log('ERROR! the file specified by the tls.key path was not valid.')","        return false","      }","      try {","        var certStat = fs.statSync(conf.tls.cert)","        if (!certStat.isFile())","          throw \"err\"","      } catch (e) {","        console.log('ERROR! the file specified by the tls.cert path was not valid.')","        return false","      }","      return true","    },","    getTLS: function () {","      return {","        key: fs.readFileSync(conf.tls.key),","        cert: fs.readFileSync(conf.tls.cert)","      }","    },","","    // function to validate the config choices made","    hasError: function () {","      // error: allowing remote access but without a TLS cert","      if (this.allowRemoteAccess() && !this.useTLS())","        return true","      // error: bad TLS config","      if (this.useTLS() && !this.validateTLS())","        return true","    },","    allowUnsafe: function () {","      return conf.unsafe","    }","  }","","  // give the user some feedback about the config state","","  // password config","  if (oracle.requiresPassword())","    console.log('[CFG] Password: YES.')","  else","    console.log('[CFG] Password: NO.')","","  // TLS","  if (oracle.useTLS())","    console.log('[CFG] TLS: YES.')","  else","    console.log('[CFG] TLS: NO.')","","  // allowRemoteAccess variations","  if (oracle.allowRemoteAccess()) {","    console.log('[CFG] Remote Access: YES.')","    if (!oracle.requiresPassword())","      console.log('WARNING! Remote access is allowed, but no password is configured. This is not safe!')","    if (!oracle.useTLS())","      console.log('ERROR! Remote access is allowed, but no TLS security is configured. Other devices will be able to steal the password or inject attacks.')","  } else","    console.log('[CFG] Remote Access: NO.')","","  return oracle","}","","function isString (v) {","  return v && typeof v == 'string'","}","function isObject (v) {","  return v && typeof v == 'object'","}",""],"l":{"1":1,"2":1,"4":0,"6":0,"9":0,"12":0,"16":0,"20":0,"23":0,"27":0,"30":0,"31":0,"32":0,"34":0,"35":0,"36":0,"38":0,"39":0,"40":0,"42":0,"43":0,"44":0,"45":0,"47":0,"48":0,"50":0,"51":0,"52":0,"53":0,"55":0,"56":0,"58":0,"61":0,"70":0,"71":0,"73":0,"74":0,"77":0,"84":0,"85":0,"87":0,"90":0,"91":0,"93":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"103":0,"105":0,"108":1,"109":0,"111":1,"112":0}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/http-server.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/http-server.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":1,"22":0,"23":1,"24":0,"25":0,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":1,"34":0,"35":0,"36":0,"37":1,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":1,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":1,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":1,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":1,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":1,"98":0,"99":1,"100":0,"101":1,"102":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":13},"end":{"line":13,"column":36}}},"2":{"name":"(anonymous_2)","line":39,"loc":{"start":{"line":39,"column":14},"end":{"line":39,"column":26}}},"3":{"name":"respond","line":41,"loc":{"start":{"line":41,"column":0},"end":{"line":41,"column":40}}},"4":{"name":"respondSource","line":46,"loc":{"start":{"line":46,"column":0},"end":{"line":46,"column":43}}},"5":{"name":"(anonymous_5)","line":61,"loc":{"start":{"line":61,"column":12},"end":{"line":61,"column":28}}},"6":{"name":"(anonymous_6)","line":69,"loc":{"start":{"line":69,"column":24},"end":{"line":69,"column":40}}},"7":{"name":"(anonymous_7)","line":70,"loc":{"start":{"line":70,"column":9},"end":{"line":70,"column":35}}},"8":{"name":"(anonymous_8)","line":76,"loc":{"start":{"line":76,"column":56},"end":{"line":76,"column":74}}},"9":{"name":"(anonymous_9)","line":77,"loc":{"start":{"line":77,"column":9},"end":{"line":77,"column":35}}},"10":{"name":"(anonymous_10)","line":86,"loc":{"start":{"line":86,"column":58},"end":{"line":86,"column":76}}},"11":{"name":"(anonymous_11)","line":87,"loc":{"start":{"line":87,"column":9},"end":{"line":87,"column":35}}},"12":{"name":"(anonymous_12)","line":105,"loc":{"start":{"line":105,"column":34},"end":{"line":105,"column":64}}},"13":{"name":"(anonymous_13)","line":108,"loc":{"start":{"line":108,"column":9},"end":{"line":108,"column":35}}},"14":{"name":"(anonymous_14)","line":122,"loc":{"start":{"line":122,"column":22},"end":{"line":122,"column":43}}},"15":{"name":"(anonymous_15)","line":137,"loc":{"start":{"line":137,"column":38},"end":{"line":137,"column":54}}},"16":{"name":"(anonymous_16)","line":138,"loc":{"start":{"line":138,"column":9},"end":{"line":138,"column":35}}},"17":{"name":"(anonymous_17)","line":141,"loc":{"start":{"line":141,"column":26},"end":{"line":141,"column":45}}},"18":{"name":"(anonymous_18)","line":155,"loc":{"start":{"line":155,"column":38},"end":{"line":155,"column":50}}},"19":{"name":"(anonymous_19)","line":156,"loc":{"start":{"line":156,"column":9},"end":{"line":156,"column":35}}},"20":{"name":"(anonymous_20)","line":158,"loc":{"start":{"line":158,"column":29},"end":{"line":158,"column":50}}},"21":{"name":"(anonymous_21)","line":171,"loc":{"start":{"line":171,"column":20},"end":{"line":171,"column":42}}},"22":{"name":"(anonymous_22)","line":179,"loc":{"start":{"line":179,"column":20},"end":{"line":179,"column":36}}},"23":{"name":"(anonymous_23)","line":187,"loc":{"start":{"line":187,"column":19},"end":{"line":187,"column":49}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":35}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":45}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":32}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":46}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":34}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":27}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":28}},"8":{"start":{"line":8,"column":0},"end":{"line":8,"column":26}},"9":{"start":{"line":9,"column":0},"end":{"line":9,"column":31}},"10":{"start":{"line":10,"column":0},"end":{"line":10,"column":29}},"11":{"start":{"line":11,"column":0},"end":{"line":11,"column":26}},"12":{"start":{"line":13,"column":0},"end":{"line":38,"column":1}},"13":{"start":{"line":17,"column":2},"end":{"line":17,"column":10}},"14":{"start":{"line":18,"column":2},"end":{"line":29,"column":3}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":31}},"16":{"start":{"line":21,"column":4},"end":{"line":21,"column":56}},"17":{"start":{"line":22,"column":4},"end":{"line":24,"column":45}},"18":{"start":{"line":27,"column":4},"end":{"line":28,"column":24}},"19":{"start":{"line":28,"column":6},"end":{"line":28,"column":24}},"20":{"start":{"line":31,"column":2},"end":{"line":37,"column":92}},"21":{"start":{"line":39,"column":0},"end":{"line":39,"column":64}},"22":{"start":{"line":39,"column":28},"end":{"line":39,"column":63}},"23":{"start":{"line":41,"column":0},"end":{"line":44,"column":1}},"24":{"start":{"line":42,"column":2},"end":{"line":42,"column":23}},"25":{"start":{"line":43,"column":2},"end":{"line":43,"column":18}},"26":{"start":{"line":46,"column":0},"end":{"line":67,"column":1}},"27":{"start":{"line":47,"column":2},"end":{"line":66,"column":3}},"28":{"start":{"line":48,"column":4},"end":{"line":48,"column":53}},"29":{"start":{"line":49,"column":4},"end":{"line":56,"column":5}},"30":{"start":{"line":59,"column":4},"end":{"line":65,"column":5}},"31":{"start":{"line":62,"column":8},"end":{"line":62,"column":73}},"32":{"start":{"line":62,"column":18},"end":{"line":62,"column":73}},"33":{"start":{"line":69,"column":0},"end":{"line":74,"column":1}},"34":{"start":{"line":70,"column":2},"end":{"line":73,"column":3}},"35":{"start":{"line":71,"column":4},"end":{"line":71,"column":69}},"36":{"start":{"line":72,"column":4},"end":{"line":72,"column":10}},"37":{"start":{"line":76,"column":0},"end":{"line":84,"column":1}},"38":{"start":{"line":77,"column":2},"end":{"line":83,"column":3}},"39":{"start":{"line":78,"column":4},"end":{"line":79,"column":19}},"40":{"start":{"line":79,"column":6},"end":{"line":79,"column":19}},"41":{"start":{"line":80,"column":4},"end":{"line":81,"column":19}},"42":{"start":{"line":81,"column":6},"end":{"line":81,"column":19}},"43":{"start":{"line":82,"column":4},"end":{"line":82,"column":48}},"44":{"start":{"line":86,"column":0},"end":{"line":103,"column":1}},"45":{"start":{"line":87,"column":2},"end":{"line":102,"column":3}},"46":{"start":{"line":88,"column":4},"end":{"line":89,"column":19}},"47":{"start":{"line":89,"column":6},"end":{"line":89,"column":19}},"48":{"start":{"line":92,"column":4},"end":{"line":92,"column":67}},"49":{"start":{"line":93,"column":4},"end":{"line":97,"column":5}},"50":{"start":{"line":94,"column":6},"end":{"line":94,"column":82}},"51":{"start":{"line":95,"column":6},"end":{"line":96,"column":21}},"52":{"start":{"line":96,"column":8},"end":{"line":96,"column":21}},"53":{"start":{"line":100,"column":4},"end":{"line":100,"column":75}},"54":{"start":{"line":101,"column":4},"end":{"line":101,"column":37}},"55":{"start":{"line":105,"column":0},"end":{"line":135,"column":1}},"56":{"start":{"line":106,"column":2},"end":{"line":107,"column":35}},"57":{"start":{"line":107,"column":4},"end":{"line":107,"column":35}},"58":{"start":{"line":108,"column":2},"end":{"line":134,"column":3}},"59":{"start":{"line":109,"column":4},"end":{"line":109,"column":41}},"60":{"start":{"line":110,"column":4},"end":{"line":110,"column":34}},"61":{"start":{"line":111,"column":4},"end":{"line":112,"column":29}},"62":{"start":{"line":112,"column":6},"end":{"line":112,"column":29}},"63":{"start":{"line":115,"column":4},"end":{"line":118,"column":5}},"64":{"start":{"line":116,"column":6},"end":{"line":116,"column":57}},"65":{"start":{"line":117,"column":6},"end":{"line":117,"column":98}},"66":{"start":{"line":121,"column":4},"end":{"line":121,"column":51}},"67":{"start":{"line":122,"column":4},"end":{"line":133,"column":6}},"68":{"start":{"line":123,"column":6},"end":{"line":123,"column":27}},"69":{"start":{"line":123,"column":14},"end":{"line":123,"column":27}},"70":{"start":{"line":124,"column":6},"end":{"line":124,"column":72}},"71":{"start":{"line":124,"column":25},"end":{"line":124,"column":72}},"72":{"start":{"line":127,"column":6},"end":{"line":130,"column":59}},"73":{"start":{"line":128,"column":8},"end":{"line":128,"column":69}},"74":{"start":{"line":130,"column":8},"end":{"line":130,"column":59}},"75":{"start":{"line":132,"column":6},"end":{"line":132,"column":70}},"76":{"start":{"line":137,"column":0},"end":{"line":153,"column":1}},"77":{"start":{"line":138,"column":2},"end":{"line":152,"column":3}},"78":{"start":{"line":139,"column":4},"end":{"line":139,"column":41}},"79":{"start":{"line":140,"column":4},"end":{"line":140,"column":59}},"80":{"start":{"line":141,"column":4},"end":{"line":151,"column":6}},"81":{"start":{"line":142,"column":6},"end":{"line":142,"column":58}},"82":{"start":{"line":142,"column":16},"end":{"line":142,"column":58}},"83":{"start":{"line":145,"column":6},"end":{"line":146,"column":103}},"84":{"start":{"line":146,"column":8},"end":{"line":146,"column":103}},"85":{"start":{"line":149,"column":6},"end":{"line":149,"column":57}},"86":{"start":{"line":150,"column":6},"end":{"line":150,"column":53}},"87":{"start":{"line":155,"column":0},"end":{"line":169,"column":1}},"88":{"start":{"line":156,"column":2},"end":{"line":168,"column":3}},"89":{"start":{"line":157,"column":4},"end":{"line":157,"column":41}},"90":{"start":{"line":158,"column":4},"end":{"line":167,"column":6}},"91":{"start":{"line":159,"column":6},"end":{"line":159,"column":56}},"92":{"start":{"line":159,"column":14},"end":{"line":159,"column":56}},"93":{"start":{"line":160,"column":6},"end":{"line":160,"column":72}},"94":{"start":{"line":160,"column":25},"end":{"line":160,"column":72}},"95":{"start":{"line":161,"column":6},"end":{"line":161,"column":57}},"96":{"start":{"line":162,"column":6},"end":{"line":166,"column":7}},"97":{"start":{"line":171,"column":0},"end":{"line":177,"column":1}},"98":{"start":{"line":172,"column":2},"end":{"line":176,"column":3}},"99":{"start":{"line":179,"column":0},"end":{"line":185,"column":1}},"100":{"start":{"line":180,"column":2},"end":{"line":184,"column":3}},"101":{"start":{"line":187,"column":0},"end":{"line":195,"column":1}},"102":{"start":{"line":188,"column":2},"end":{"line":194,"column":3}}},"branchMap":{"1":{"line":18,"type":"if","locations":[{"start":{"line":18,"column":2},"end":{"line":18,"column":2}},{"start":{"line":18,"column":2},"end":{"line":18,"column":2}}]},"2":{"line":22,"type":"cond-expr","locations":[{"start":{"line":23,"column":8},"end":{"line":23,"column":23}},{"start":{"line":24,"column":9},"end":{"line":24,"column":44}}]},"3":{"line":22,"type":"binary-expr","locations":[{"start":{"line":22,"column":12},"end":{"line":22,"column":42}},{"start":{"line":22,"column":46},"end":{"line":22,"column":85}}]},"4":{"line":24,"type":"binary-expr","locations":[{"start":{"line":24,"column":9},"end":{"line":24,"column":29}},{"start":{"line":24,"column":33},"end":{"line":24,"column":44}}]},"5":{"line":27,"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":27,"column":4}},{"start":{"line":27,"column":4},"end":{"line":27,"column":4}}]},"6":{"line":27,"type":"binary-expr","locations":[{"start":{"line":27,"column":8},"end":{"line":27,"column":38}},{"start":{"line":27,"column":42},"end":{"line":27,"column":61}}]},"7":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":2},"end":{"line":47,"column":2}},{"start":{"line":47,"column":2},"end":{"line":47,"column":2}}]},"8":{"line":62,"type":"if","locations":[{"start":{"line":62,"column":8},"end":{"line":62,"column":8}},{"start":{"line":62,"column":8},"end":{"line":62,"column":8}}]},"9":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":4},"end":{"line":78,"column":4}},{"start":{"line":78,"column":4},"end":{"line":78,"column":4}}]},"10":{"line":80,"type":"if","locations":[{"start":{"line":80,"column":4},"end":{"line":80,"column":4}},{"start":{"line":80,"column":4},"end":{"line":80,"column":4}}]},"11":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":4},"end":{"line":88,"column":4}},{"start":{"line":88,"column":4},"end":{"line":88,"column":4}}]},"12":{"line":93,"type":"if","locations":[{"start":{"line":93,"column":4},"end":{"line":93,"column":4}},{"start":{"line":93,"column":4},"end":{"line":93,"column":4}}]},"13":{"line":95,"type":"if","locations":[{"start":{"line":95,"column":6},"end":{"line":95,"column":6}},{"start":{"line":95,"column":6},"end":{"line":95,"column":6}}]},"14":{"line":95,"type":"binary-expr","locations":[{"start":{"line":95,"column":10},"end":{"line":95,"column":18}},{"start":{"line":95,"column":22},"end":{"line":95,"column":52}}]},"15":{"line":106,"type":"if","locations":[{"start":{"line":106,"column":2},"end":{"line":106,"column":2}},{"start":{"line":106,"column":2},"end":{"line":106,"column":2}}]},"16":{"line":106,"type":"binary-expr","locations":[{"start":{"line":106,"column":6},"end":{"line":106,"column":11}},{"start":{"line":106,"column":15},"end":{"line":106,"column":27}}]},"17":{"line":111,"type":"if","locations":[{"start":{"line":111,"column":4},"end":{"line":111,"column":4}},{"start":{"line":111,"column":4},"end":{"line":111,"column":4}}]},"18":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":4},"end":{"line":115,"column":4}},{"start":{"line":115,"column":4},"end":{"line":115,"column":4}}]},"19":{"line":123,"type":"if","locations":[{"start":{"line":123,"column":6},"end":{"line":123,"column":6}},{"start":{"line":123,"column":6},"end":{"line":123,"column":6}}]},"20":{"line":124,"type":"if","locations":[{"start":{"line":124,"column":6},"end":{"line":124,"column":6}},{"start":{"line":124,"column":6},"end":{"line":124,"column":6}}]},"21":{"line":127,"type":"if","locations":[{"start":{"line":127,"column":6},"end":{"line":127,"column":6}},{"start":{"line":127,"column":6},"end":{"line":127,"column":6}}]},"22":{"line":142,"type":"if","locations":[{"start":{"line":142,"column":6},"end":{"line":142,"column":6}},{"start":{"line":142,"column":6},"end":{"line":142,"column":6}}]},"23":{"line":145,"type":"if","locations":[{"start":{"line":145,"column":6},"end":{"line":145,"column":6}},{"start":{"line":145,"column":6},"end":{"line":145,"column":6}}]},"24":{"line":159,"type":"if","locations":[{"start":{"line":159,"column":6},"end":{"line":159,"column":6}},{"start":{"line":159,"column":6},"end":{"line":159,"column":6}}]},"25":{"line":160,"type":"if","locations":[{"start":{"line":160,"column":6},"end":{"line":160,"column":6}},{"start":{"line":160,"column":6},"end":{"line":160,"column":6}}]}},"code":["var pull   = require('pull-stream')","var toPull = require('stream-to-pull-stream')","var cat    = require('pull-cat')","var ident  = require('pull-identify-filetype')","var mime   = require('mime-types')","var URL    = require('url')","var path   = require('path')","var fs     = require('fs')","var refs   = require('ssb-ref')","var Stack  = require('stack')","var ip     = require('ip')","","var AppCSP = function (req, config) {","  // hostname for the websocket connection:","  // if it's a remote request, always use the configured hostname","  // if it's local, choose from localhost or the configured hostname, based on which the client is using (as revealed by the host header)","  var host","  if (!ip.isLoopback(req.socket.remoteAddress))","    host = config.getHostname()","  else {","    var requestHostname = req.headers.host.split(':')[0] // extract hostname (remove ':port')","    host = (requestHostname == 'localhost' || requestHostname == config.getHostname())","      ? requestHostname","      : (config.getHostname() || 'localhost')","","    // final glorious hack: if they're using 127.0.0.1, we should too","    if (requestHostname == '127.0.0.1' && host == 'localhost')","      host = '127.0.0.1'","  }","","  return \"default-src 'self'; \"+","    \"connect-src 'self' ws://\"+host+\":7777 wss://\"+host+\":7777; \"+","    \"img-src 'self' data:; \"+","    \"object-src 'none'; \"+","    \"frame-src 'none'; \"+","    \"style-src 'self' 'unsafe-inline'; \"+","    \"sandbox allow-modals allow-same-origin allow-scripts allow-top-navigation allow-popups\"","}","var BlobCSP = function () { return \"default-src none; sandbox\" }","","function respond (res, status, message) {","  res.writeHead(status)","  res.end(message)","}","","function respondSource (res, source, wrap) {","  if(wrap) {","    res.writeHead(200, {'Content-Type': 'text/html'})","    pull(","      cat([","        pull.once('<html><body><script>'),","        source,","        pull.once('</script></body></html>')","      ]),","      toPull.sink(res)","    )","  }","  else {","    pull(","      source,","      ident(function (type) {","        if (type) res.writeHead(200, {'Content-Type': mime.lookup(type)})","      }),","      toPull.sink(res)","    )","  }","}","","var Log = exports.Log = function (sbot) {","  return function (req, res, next) {","    sbot.emit('log:info', ['HTTP', null, req.method + ' ' + req.url])","    next()","  }","}","","var DeviceAccessControl = exports.DeviceAccessControl = function (config) {","  return function (req, res, next) {","    if (config.allowRemoteAccess())","      return next() // remote & local access allowed","    if (ip.isLoopback(req.socket.remoteAddress))","      return next() // local access allowed","    respond(res, 403, 'Remote access forbidden') // remote access disallowed","  }","}","","var PasswordAccessControl = exports.DeviceAccessControl = function (config) {","  return function (req, res, next) {","    if (!config.requiresPassword(config))","      return next() // no password required","","    // check the password","    var authMatch = /^Basic (.*)$/i.exec(req.headers.authorization)","    if (authMatch) {","      var password = (new Buffer(authMatch[1], 'base64').toString()).split(':')[1]","      if (password && config.checkPassword(password))","        return next() // password checks out","    }","","    // deny","    res.setHeader('WWW-Authenticate', 'Basic realm=Authorization Required')","    respond(res, 401, 'Unauthorized')","  }","}","","var ServeApp = exports.ServeApp = function (sbot, opts, config) {","  if (!opts || !opts.uiPath)","    throw \"opts.uiPath is required\"","  return function (req, res, next) {","    var parsed = URL.parse(req.url, true)","    var pathname = parsed.pathname","    if (pathname == '/')","      pathname = '/main.html'","","    // dynamic route: manifest.js","    if (pathname == '/manifest.js') {","      res.setHeader('Content-Security-Policy', BlobCSP())","      return respondSource(res, pull.once('window.MANIFEST='+JSON.stringify(sbot.manifest())+';'))","    } ","","    // static files","    var filepath = path.join(opts.uiPath, pathname)","    fs.stat(filepath, function (err, stat) {","      if(err) return next()","      if(!stat.isFile()) return respond(res, 403, 'May only load files')","","      // set a special CSP for the main HTML file","      if (pathname == '/main.html')","        res.setHeader('Content-Security-Policy', AppCSP(req, config)) // only give the open perms to main.html","      else","        res.setHeader('Content-Security-Policy', BlobCSP())","","      respondSource(res, toPull.source(fs.createReadStream(filepath)))","    })","  }","}","","var ServeBlobs = exports.ServeBlobs = function (sbot) {","  return function (req, res, next) {","    var parsed = URL.parse(req.url, true)","    var hash = decodeURIComponent(parsed.pathname.slice(1))","    sbot.blobs.want(hash, function(err, has) {","      if (!has) return respond(res, 404, 'File not found')","","      // optional name override","      if (parsed.query.name)","        res.setHeader('Content-Disposition', 'inline; filename='+encodeURIComponent(parsed.query.name))","","      // serve","      res.setHeader('Content-Security-Policy', BlobCSP())","      respondSource(res, sbot.blobs.get(hash), false)","    })","  }","}","","var ServeFiles = exports.ServeFiles = function () {","  return function (req, res, next) {","    var parsed = URL.parse(req.url, true)","    fs.stat(parsed.pathname, function (err, stat) {","      if(err) return respond(res, 404, 'File not found')","      if(!stat.isFile()) return respond(res, 403, 'May only load files')","      res.setHeader('Content-Security-Policy', BlobCSP())","      respondSource(","        res,","        toPull.source(fs.createReadStream(parsed.pathname)),","        false","      )","    })","  }","}","","exports.BlobStack = function (sbot, opts) {","  return Stack(","    Log(sbot),","    DeviceAccessControl(),","    ServeBlobs(sbot)","  )","}","","exports.FileStack = function (opts) {","  return Stack(","    Log(sbot),","    DeviceAccessControl(),","    ServeFiles()","  )","}","","exports.AppStack = function (sbot, opts, config) {","  return Stack(","    Log(sbot),","    PasswordAccessControl(config),","    DeviceAccessControl(config),","    ServeApp(sbot, opts, config),","    ServeBlobs(sbot)","  )","}",""],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"13":1,"17":0,"18":0,"19":0,"21":0,"22":0,"27":0,"28":0,"31":0,"39":1,"41":1,"42":0,"43":0,"46":1,"47":0,"48":0,"49":0,"59":0,"62":0,"69":1,"70":0,"71":0,"72":0,"76":1,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"86":1,"87":0,"88":0,"89":0,"92":0,"93":0,"94":0,"95":0,"96":0,"100":0,"101":0,"105":1,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"115":0,"116":0,"117":0,"121":0,"122":0,"123":0,"124":0,"127":0,"128":0,"130":0,"132":0,"137":1,"138":0,"139":0,"140":0,"141":0,"142":0,"145":0,"146":0,"149":0,"150":0,"155":1,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"171":1,"172":0,"179":1,"180":0,"187":1,"188":0}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/server-process.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/server-process.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":0,"36":0,"37":0,"38":0,"39":0,"40":1,"41":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":4,"loc":{"start":{"line":4,"column":17},"end":{"line":4,"column":39}}},"2":{"name":"fatalError","line":71,"loc":{"start":{"line":71,"column":2},"end":{"line":71,"column":26}}},"3":{"name":"logLicense","line":80,"loc":{"start":{"line":80,"column":2},"end":{"line":80,"column":25}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":29}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":33}},"3":{"start":{"line":4,"column":0},"end":{"line":83,"column":1}},"4":{"start":{"line":8,"column":2},"end":{"line":8,"column":43}},"5":{"start":{"line":9,"column":2},"end":{"line":9,"column":42}},"6":{"start":{"line":12,"column":2},"end":{"line":12,"column":48}},"7":{"start":{"line":13,"column":2},"end":{"line":20,"column":3}},"8":{"start":{"line":14,"column":4},"end":{"line":19,"column":5}},"9":{"start":{"line":15,"column":6},"end":{"line":15,"column":49}},"10":{"start":{"line":17,"column":6},"end":{"line":17,"column":48}},"11":{"start":{"line":18,"column":6},"end":{"line":18,"column":12}},"12":{"start":{"line":22,"column":2},"end":{"line":22,"column":14}},"13":{"start":{"line":24,"column":2},"end":{"line":24,"column":28}},"14":{"start":{"line":27,"column":2},"end":{"line":39,"column":26}},"15":{"start":{"line":41,"column":2},"end":{"line":41,"column":31}},"16":{"start":{"line":44,"column":2},"end":{"line":44,"column":24}},"17":{"start":{"line":45,"column":2},"end":{"line":48,"column":3}},"18":{"start":{"line":51,"column":2},"end":{"line":51,"column":28}},"19":{"start":{"line":52,"column":2},"end":{"line":52,"column":30}},"20":{"start":{"line":53,"column":2},"end":{"line":53,"column":36}},"21":{"start":{"line":54,"column":2},"end":{"line":54,"column":42}},"22":{"start":{"line":55,"column":2},"end":{"line":55,"column":99}},"23":{"start":{"line":56,"column":2},"end":{"line":56,"column":47}},"24":{"start":{"line":58,"column":2},"end":{"line":58,"column":69}},"25":{"start":{"line":59,"column":2},"end":{"line":59,"column":77}},"26":{"start":{"line":60,"column":2},"end":{"line":60,"column":42}},"27":{"start":{"line":61,"column":2},"end":{"line":61,"column":32}},"28":{"start":{"line":62,"column":2},"end":{"line":62,"column":37}},"29":{"start":{"line":63,"column":2},"end":{"line":63,"column":36}},"30":{"start":{"line":64,"column":2},"end":{"line":64,"column":39}},"31":{"start":{"line":65,"column":2},"end":{"line":67,"column":3}},"32":{"start":{"line":66,"column":4},"end":{"line":66,"column":32}},"33":{"start":{"line":68,"column":2},"end":{"line":68,"column":64}},"34":{"start":{"line":71,"column":2},"end":{"line":77,"column":3}},"35":{"start":{"line":72,"column":4},"end":{"line":75,"column":44}},"36":{"start":{"line":73,"column":6},"end":{"line":73,"column":65}},"37":{"start":{"line":75,"column":6},"end":{"line":75,"column":44}},"38":{"start":{"line":76,"column":4},"end":{"line":76,"column":19}},"39":{"start":{"line":78,"column":2},"end":{"line":78,"column":45}},"40":{"start":{"line":80,"column":2},"end":{"line":82,"column":3}},"41":{"start":{"line":81,"column":4},"end":{"line":81,"column":65}}},"branchMap":{"1":{"line":13,"type":"if","locations":[{"start":{"line":13,"column":2},"end":{"line":13,"column":2}},{"start":{"line":13,"column":2},"end":{"line":13,"column":2}}]},"2":{"line":14,"type":"if","locations":[{"start":{"line":14,"column":4},"end":{"line":14,"column":4}},{"start":{"line":14,"column":4},"end":{"line":14,"column":4}}]},"3":{"line":58,"type":"cond-expr","locations":[{"start":{"line":58,"column":43},"end":{"line":58,"column":64}},{"start":{"line":58,"column":67},"end":{"line":58,"column":69}}]},"4":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":2},"end":{"line":65,"column":2}},{"start":{"line":65,"column":2},"end":{"line":65,"column":2}}]},"5":{"line":72,"type":"if","locations":[{"start":{"line":72,"column":4},"end":{"line":72,"column":4}},{"start":{"line":72,"column":4},"end":{"line":72,"column":4}}]},"6":{"line":75,"type":"binary-expr","locations":[{"start":{"line":75,"column":20},"end":{"line":75,"column":27}},{"start":{"line":75,"column":31},"end":{"line":75,"column":43}}]}},"code":["var path    = require('path')","var ssbKeys = require('ssb-keys')","","module.exports = function (config, cb) {","  // load config","","  // load languages","  var t = require('patchwork-translations')","  t.setLocale(require('os-locale').sync())","","  // validate the config","  var configOracle = require('./config')(config)","  if (configOracle.hasError()) {","    if (configOracle.allowUnsafe())","      console.log('\\n' + t('unsafeConfigIgnore'))","    else {","      console.log('\\n' + t('unsafeConfigAbort'))","      return","    }","  }","","  logLicense() // per the GPL's recommendation, let ppl know the license","","  console.log(t('Starting'))","","  // start sbot","  var createSbot = require('scuttlebot')","    .use(require('scuttlebot/plugins/master'))","    .use(require('./lib/persistent-gossip')) // override","    .use(require('./lib/friends-with-gossip-priority'))","    .use(require('scuttlebot/plugins/replicate'))","    .use(require('ssb-blobs'))","    .use(require('scuttlebot/plugins/invite'))","    .use(require('scuttlebot/plugins/block'))","    .use(require('scuttlebot/plugins/logging'))","    .use(require('scuttlebot/plugins/private'))","    .use(require('scuttlebot/plugins/local'))","    .use(require('ssb-notifier'))","    .use(require('./api'))","","  var sbot = createSbot(config)","","  // write manifest file","  var fs = require('fs')","  fs.writeFileSync(","    path.join(config.path, 'manifest.json'),","    JSON.stringify(sbot.getManifest(), null, 2)","  )","","  // setup server","  var http = require('http')","  var https = require('https')","  var ws = require('pull-ws-server')","  var httpStack = require('./http-server')","  var httpServerFn = httpStack.AppStack(sbot, { uiPath: path.join(__dirname, 'ui') }, configOracle)","  var wsServerFn = require('./ws-server')(sbot)","","  var serverOpts = configOracle.useTLS() ? configOracle.getTLS() : {}","  serverOpts.verifyClient = require('./ws-server').verifyClient(configOracle)","  var server = ws.createServer(serverOpts)","  server.on('error', fatalError)","  server.on('connection', wsServerFn)","  server.on('request', httpServerFn)","  server.listen(configOracle.getPort())","  if (cb) {","    server.once('listening', cb)","  }","  console.log(t('ServingAt', {url: configOracle.getLocalUrl()}))","","  // basic error handling","  function fatalError (e) {","    if (e.code === 'EADDRINUSE')","      console.error('\\n' + t('PortInUse', {port: e.port}) + '\\n')","    else","      console.error(e.stack || e.toString())","    process.exit(1)","  }","  process.on('uncaughtException', fatalError)","","  function logLicense () {","    console.log(t('LicenseConsole', {years: '2015-2016'}) + '\\n')","  }","}",""],"l":{"1":1,"2":1,"4":1,"8":0,"9":0,"12":0,"13":0,"14":0,"15":0,"17":0,"18":0,"22":0,"24":0,"27":0,"41":0,"44":0,"45":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"68":0,"71":1,"72":0,"73":0,"75":0,"76":0,"78":0,"80":1,"81":0}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/ws-server.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/ws-server.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":1,"10":0,"11":1,"12":0,"13":0},"b":{},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":5,"loc":{"start":{"line":5,"column":17},"end":{"line":5,"column":39}}},"2":{"name":"(anonymous_2)","line":6,"loc":{"start":{"line":6,"column":9},"end":{"line":6,"column":27}}},"3":{"name":"serialize","line":16,"loc":{"start":{"line":16,"column":0},"end":{"line":16,"column":28}}},"4":{"name":"(anonymous_4)","line":20,"loc":{"start":{"line":20,"column":30},"end":{"line":20,"column":48}}},"5":{"name":"(anonymous_5)","line":21,"loc":{"start":{"line":21,"column":9},"end":{"line":21,"column":25}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":30}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":33}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":43}},"4":{"start":{"line":5,"column":0},"end":{"line":14,"column":1}},"5":{"start":{"line":6,"column":2},"end":{"line":13,"column":3}},"6":{"start":{"line":8,"column":4},"end":{"line":8,"column":58}},"7":{"start":{"line":9,"column":4},"end":{"line":9,"column":52}},"8":{"start":{"line":12,"column":4},"end":{"line":12,"column":44}},"9":{"start":{"line":16,"column":0},"end":{"line":18,"column":1}},"10":{"start":{"line":17,"column":2},"end":{"line":17,"column":50}},"11":{"start":{"line":20,"column":0},"end":{"line":24,"column":1}},"12":{"start":{"line":21,"column":2},"end":{"line":23,"column":3}},"13":{"start":{"line":22,"column":4},"end":{"line":22,"column":47}}},"branchMap":{},"code":["var muxrpc = require('muxrpc')","var pull = require('pull-stream')","var Serializer = require('pull-serializer')","","module.exports = function (sbot, opts) {","  return function (stream) {","    // create rpc object","    var rpc = muxrpc({}, sbot.manifest(), serialize)(sbot)","    rpc.authorized = { id: sbot.id, role: 'master' }","","    // start the stream","    pull(stream, rpc.createStream(), stream)","  }","}","","function serialize (stream) {","  return Serializer(stream, JSON, {split: '\\n\\n'})","}","","module.exports.verifyClient = function (config) {","  return function (info) {","    return info.origin === config.getLocalUrl()","  }","}"],"l":{"1":1,"2":1,"3":1,"5":1,"6":0,"8":0,"9":0,"12":0,"16":1,"17":0,"20":1,"21":0,"22":0}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/api/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/api/index.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":1,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":1,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":1,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":1,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":1,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"216":0,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"223":0,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"230":0,"231":0,"232":0,"233":0,"234":0,"235":0,"236":0,"237":1,"238":0,"239":0,"240":0,"241":0,"242":0,"243":0,"244":0,"245":0,"246":0,"247":0,"248":0,"249":0,"250":0,"251":0,"252":0,"253":0,"254":0,"255":0,"256":0,"257":0,"258":0,"259":0,"260":0,"261":0,"262":0,"263":0,"264":0,"265":0,"266":0,"267":0,"268":0,"269":0,"270":0,"271":0,"272":0,"273":0,"274":0,"275":0,"276":0,"277":0,"278":0,"279":0,"280":0,"281":0,"282":0,"283":0,"284":0,"285":0,"286":0,"287":0,"288":0,"289":0,"290":0,"291":0,"292":0,"293":0,"294":0,"295":0,"296":0,"297":0,"298":0,"299":0,"300":0,"301":0,"302":0,"303":0,"304":0,"305":0,"306":0,"307":0,"308":0,"309":0,"310":1,"311":0,"312":0,"313":0,"314":0,"315":0,"316":0,"317":0,"318":0,"319":0,"320":0,"321":0,"322":0,"323":0,"324":1,"325":0,"326":0,"327":0,"328":0,"329":0,"330":0,"331":0,"332":0,"333":0,"334":0,"335":0,"336":0,"337":0,"338":0,"339":0,"340":0,"341":0,"342":0,"343":0,"344":0,"345":0,"346":0,"347":0,"348":0,"349":1,"350":0,"351":1,"352":0,"353":0,"354":0,"355":0,"356":0,"357":0,"358":0,"359":0,"360":0,"361":0,"362":1,"363":0,"364":0,"365":0,"366":0,"367":0,"368":0,"369":0,"370":0,"371":0,"372":1,"373":0,"374":0,"375":0,"376":0,"377":0,"378":0,"379":0,"380":0,"381":0,"382":0,"383":0,"384":0,"385":0,"386":0,"387":0,"388":0,"389":0,"390":0,"391":0,"392":0,"393":0,"394":0,"395":0,"396":0,"397":0,"398":0,"399":0,"400":0,"401":0,"402":1,"403":0,"404":0,"405":0,"406":0,"407":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0],"52":[0,0],"53":[0,0],"54":[0,0],"55":[0,0],"56":[0,0],"57":[0,0,0,0,0,0,0,0,0,0],"58":[0,0],"59":[0,0],"60":[0,0],"61":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0},"fnMap":{"1":{"name":"(anonymous_1)","line":21,"loc":{"start":{"line":21,"column":15},"end":{"line":21,"column":37}}},"2":{"name":"awaitSync","line":55,"loc":{"start":{"line":55,"column":2},"end":{"line":55,"column":26}}},"3":{"name":"(anonymous_3)","line":60,"loc":{"start":{"line":60,"column":15},"end":{"line":60,"column":27}}},"4":{"name":"(anonymous_4)","line":61,"loc":{"start":{"line":61,"column":15},"end":{"line":61,"column":27}}},"5":{"name":"(anonymous_5)","line":64,"loc":{"start":{"line":64,"column":22},"end":{"line":64,"column":36}}},"6":{"name":"(anonymous_6)","line":72,"loc":{"start":{"line":72,"column":18},"end":{"line":72,"column":37}}},"7":{"name":"(anonymous_7)","line":75,"loc":{"start":{"line":75,"column":25},"end":{"line":75,"column":48}}},"8":{"name":"(anonymous_8)","line":76,"loc":{"start":{"line":76,"column":20},"end":{"line":76,"column":42}}},"9":{"name":"done","line":78,"loc":{"start":{"line":78,"column":6},"end":{"line":78,"column":22}}},"10":{"name":"(anonymous_10)","line":83,"loc":{"start":{"line":83,"column":6},"end":{"line":83,"column":21}}},"11":{"name":"(anonymous_11)","line":102,"loc":{"start":{"line":102,"column":15},"end":{"line":102,"column":30}}},"12":{"name":"(anonymous_12)","line":114,"loc":{"start":{"line":114,"column":15},"end":{"line":114,"column":32}}},"13":{"name":"(anonymous_13)","line":120,"loc":{"start":{"line":120,"column":4},"end":{"line":120,"column":16}}},"14":{"name":"(anonymous_14)","line":126,"loc":{"start":{"line":126,"column":12},"end":{"line":126,"column":24}}},"15":{"name":"onHistorySync","line":130,"loc":{"start":{"line":130,"column":4},"end":{"line":130,"column":30}}},"16":{"name":"(anonymous_16)","line":133,"loc":{"start":{"line":133,"column":16},"end":{"line":133,"column":28}}},"17":{"name":"emit","line":143,"loc":{"start":{"line":143,"column":2},"end":{"line":143,"column":29}}},"18":{"name":"(anonymous_18)","line":149,"loc":{"start":{"line":149,"column":25},"end":{"line":149,"column":48}}},"19":{"name":"(anonymous_19)","line":161,"loc":{"start":{"line":161,"column":26},"end":{"line":161,"column":38}}},"20":{"name":"(anonymous_20)","line":165,"loc":{"start":{"line":165,"column":21},"end":{"line":165,"column":35}}},"21":{"name":"(anonymous_21)","line":166,"loc":{"start":{"line":166,"column":14},"end":{"line":166,"column":26}}},"22":{"name":"(anonymous_22)","line":171,"loc":{"start":{"line":171,"column":23},"end":{"line":171,"column":37}}},"23":{"name":"(anonymous_23)","line":172,"loc":{"start":{"line":172,"column":14},"end":{"line":172,"column":26}}},"24":{"name":"(anonymous_24)","line":174,"loc":{"start":{"line":174,"column":40},"end":{"line":174,"column":55}}},"25":{"name":"(anonymous_25)","line":175,"loc":{"start":{"line":175,"column":47},"end":{"line":175,"column":62}}},"26":{"name":"(anonymous_26)","line":176,"loc":{"start":{"line":176,"column":45},"end":{"line":176,"column":60}}},"27":{"name":"(anonymous_27)","line":177,"loc":{"start":{"line":177,"column":49},"end":{"line":177,"column":64}}},"28":{"name":"(anonymous_28)","line":190,"loc":{"start":{"line":190,"column":28},"end":{"line":190,"column":53}}},"29":{"name":"(anonymous_29)","line":196,"loc":{"start":{"line":196,"column":27},"end":{"line":196,"column":43}}},"30":{"name":"(anonymous_30)","line":206,"loc":{"start":{"line":206,"column":20},"end":{"line":206,"column":39}}},"31":{"name":"(anonymous_31)","line":210,"loc":{"start":{"line":210,"column":18},"end":{"line":210,"column":33}}},"32":{"name":"indexMarkRead","line":218,"loc":{"start":{"line":218,"column":2},"end":{"line":218,"column":51}}},"33":{"name":"(anonymous_33)","line":220,"loc":{"start":{"line":220,"column":18},"end":{"line":220,"column":31}}},"34":{"name":"indexMarkUnread","line":237,"loc":{"start":{"line":237,"column":2},"end":{"line":237,"column":53}}},"35":{"name":"(anonymous_35)","line":239,"loc":{"start":{"line":239,"column":18},"end":{"line":239,"column":31}}},"36":{"name":"(anonymous_36)","line":256,"loc":{"start":{"line":256,"column":17},"end":{"line":256,"column":36}}},"37":{"name":"(anonymous_37)","line":257,"loc":{"start":{"line":257,"column":14},"end":{"line":257,"column":26}}},"38":{"name":"(anonymous_38)","line":263,"loc":{"start":{"line":263,"column":32},"end":{"line":263,"column":45}}},"39":{"name":"(anonymous_39)","line":264,"loc":{"start":{"line":264,"column":20},"end":{"line":264,"column":35}}},"40":{"name":"(anonymous_40)","line":271,"loc":{"start":{"line":271,"column":19},"end":{"line":271,"column":38}}},"41":{"name":"(anonymous_41)","line":272,"loc":{"start":{"line":272,"column":14},"end":{"line":272,"column":26}}},"42":{"name":"(anonymous_42)","line":278,"loc":{"start":{"line":278,"column":32},"end":{"line":278,"column":45}}},"43":{"name":"(anonymous_43)","line":279,"loc":{"start":{"line":279,"column":20},"end":{"line":279,"column":35}}},"44":{"name":"(anonymous_44)","line":286,"loc":{"start":{"line":286,"column":20},"end":{"line":286,"column":45}}},"45":{"name":"(anonymous_45)","line":287,"loc":{"start":{"line":287,"column":14},"end":{"line":287,"column":26}}},"46":{"name":"(anonymous_46)","line":294,"loc":{"start":{"line":294,"column":16},"end":{"line":294,"column":31}}},"47":{"name":"(anonymous_47)","line":295,"loc":{"start":{"line":295,"column":17},"end":{"line":295,"column":32}}},"48":{"name":"(anonymous_48)","line":297,"loc":{"start":{"line":297,"column":67},"end":{"line":297,"column":90}}},"49":{"name":"(anonymous_49)","line":306,"loc":{"start":{"line":306,"column":19},"end":{"line":306,"column":38}}},"50":{"name":"(anonymous_50)","line":307,"loc":{"start":{"line":307,"column":20},"end":{"line":307,"column":38}}},"51":{"name":"(anonymous_51)","line":309,"loc":{"start":{"line":309,"column":26},"end":{"line":309,"column":41}}},"52":{"name":"(anonymous_52)","line":313,"loc":{"start":{"line":313,"column":28},"end":{"line":313,"column":43}}},"53":{"name":"(anonymous_53)","line":319,"loc":{"start":{"line":319,"column":15},"end":{"line":319,"column":34}}},"54":{"name":"(anonymous_54)","line":322,"loc":{"start":{"line":322,"column":18},"end":{"line":322,"column":34}}},"55":{"name":"(anonymous_55)","line":324,"loc":{"start":{"line":324,"column":25},"end":{"line":324,"column":43}}},"56":{"name":"(anonymous_56)","line":328,"loc":{"start":{"line":328,"column":25},"end":{"line":328,"column":43}}},"57":{"name":"(anonymous_57)","line":334,"loc":{"start":{"line":334,"column":17},"end":{"line":334,"column":36}}},"58":{"name":"(anonymous_58)","line":335,"loc":{"start":{"line":335,"column":18},"end":{"line":335,"column":40}}},"59":{"name":"(anonymous_59)","line":340,"loc":{"start":{"line":340,"column":11},"end":{"line":340,"column":45}}},"60":{"name":"(anonymous_60)","line":352,"loc":{"start":{"line":352,"column":19},"end":{"line":352,"column":38}}},"61":{"name":"(anonymous_61)","line":353,"loc":{"start":{"line":353,"column":18},"end":{"line":353,"column":40}}},"62":{"name":"(anonymous_62)","line":360,"loc":{"start":{"line":360,"column":23},"end":{"line":360,"column":42}}},"63":{"name":"(anonymous_63)","line":361,"loc":{"start":{"line":361,"column":26},"end":{"line":361,"column":44}}},"64":{"name":"(anonymous_64)","line":363,"loc":{"start":{"line":363,"column":26},"end":{"line":363,"column":41}}},"65":{"name":"(anonymous_65)","line":367,"loc":{"start":{"line":367,"column":28},"end":{"line":367,"column":43}}},"66":{"name":"(anonymous_66)","line":373,"loc":{"start":{"line":373,"column":21},"end":{"line":373,"column":40}}},"67":{"name":"(anonymous_67)","line":374,"loc":{"start":{"line":374,"column":27},"end":{"line":374,"column":45}}},"68":{"name":"getChannelIndex","line":379,"loc":{"start":{"line":379,"column":2},"end":{"line":379,"column":37}}},"69":{"name":"(anonymous_69)","line":386,"loc":{"start":{"line":386,"column":20},"end":{"line":386,"column":34}}},"70":{"name":"(anonymous_70)","line":387,"loc":{"start":{"line":387,"column":14},"end":{"line":387,"column":26}}},"71":{"name":"(anonymous_71)","line":403,"loc":{"start":{"line":403,"column":19},"end":{"line":403,"column":42}}},"72":{"name":"(anonymous_72)","line":409,"loc":{"start":{"line":409,"column":21},"end":{"line":409,"column":44}}},"73":{"name":"(anonymous_73)","line":415,"loc":{"start":{"line":415,"column":28},"end":{"line":415,"column":51}}},"74":{"name":"(anonymous_74)","line":418,"loc":{"start":{"line":418,"column":32},"end":{"line":418,"column":47}}},"75":{"name":"(anonymous_75)","line":422,"loc":{"start":{"line":422,"column":30},"end":{"line":422,"column":45}}},"76":{"name":"(anonymous_76)","line":427,"loc":{"start":{"line":427,"column":21},"end":{"line":427,"column":44}}},"77":{"name":"(anonymous_77)","line":433,"loc":{"start":{"line":433,"column":23},"end":{"line":433,"column":46}}},"78":{"name":"(anonymous_78)","line":439,"loc":{"start":{"line":439,"column":29},"end":{"line":439,"column":52}}},"79":{"name":"(anonymous_79)","line":442,"loc":{"start":{"line":442,"column":34},"end":{"line":442,"column":49}}},"80":{"name":"(anonymous_80)","line":446,"loc":{"start":{"line":446,"column":32},"end":{"line":446,"column":47}}},"81":{"name":"(anonymous_81)","line":452,"loc":{"start":{"line":452,"column":23},"end":{"line":452,"column":49}}},"82":{"name":"(anonymous_82)","line":458,"loc":{"start":{"line":458,"column":23},"end":{"line":458,"column":49}}},"83":{"name":"(anonymous_83)","line":466,"loc":{"start":{"line":466,"column":22},"end":{"line":466,"column":38}}},"84":{"name":"(anonymous_84)","line":483,"loc":{"start":{"line":483,"column":13},"end":{"line":483,"column":29}}},"85":{"name":"search","line":500,"loc":{"start":{"line":500,"column":4},"end":{"line":500,"column":28}}},"86":{"name":"(anonymous_86)","line":507,"loc":{"start":{"line":507,"column":25},"end":{"line":507,"column":45}}},"87":{"name":"(anonymous_87)","line":513,"loc":{"start":{"line":513,"column":18},"end":{"line":513,"column":38}}},"88":{"name":"sync","line":524,"loc":{"start":{"line":524,"column":4},"end":{"line":524,"column":28}}},"89":{"name":"(anonymous_89)","line":530,"loc":{"start":{"line":530,"column":21},"end":{"line":530,"column":36}}},"90":{"name":"(anonymous_90)","line":533,"loc":{"start":{"line":533,"column":31},"end":{"line":533,"column":46}}},"91":{"name":"(anonymous_91)","line":542,"loc":{"start":{"line":542,"column":19},"end":{"line":542,"column":37}}},"92":{"name":"(anonymous_92)","line":543,"loc":{"start":{"line":543,"column":14},"end":{"line":543,"column":26}}},"93":{"name":"(anonymous_93)","line":545,"loc":{"start":{"line":545,"column":23},"end":{"line":545,"column":37}}},"94":{"name":"(anonymous_94)","line":546,"loc":{"start":{"line":546,"column":14},"end":{"line":546,"column":26}}},"95":{"name":"(anonymous_95)","line":548,"loc":{"start":{"line":548,"column":21},"end":{"line":548,"column":35}}},"96":{"name":"(anonymous_96)","line":549,"loc":{"start":{"line":549,"column":14},"end":{"line":549,"column":26}}},"97":{"name":"(anonymous_97)","line":551,"loc":{"start":{"line":551,"column":21},"end":{"line":551,"column":35}}},"98":{"name":"(anonymous_98)","line":552,"loc":{"start":{"line":552,"column":14},"end":{"line":552,"column":26}}},"99":{"name":"(anonymous_99)","line":554,"loc":{"start":{"line":554,"column":16},"end":{"line":554,"column":34}}},"100":{"name":"(anonymous_100)","line":555,"loc":{"start":{"line":555,"column":14},"end":{"line":555,"column":26}}},"101":{"name":"(anonymous_101)","line":557,"loc":{"start":{"line":557,"column":23},"end":{"line":557,"column":37}}},"102":{"name":"(anonymous_102)","line":558,"loc":{"start":{"line":558,"column":14},"end":{"line":558,"column":26}}},"103":{"name":"o","line":562,"loc":{"start":{"line":562,"column":2},"end":{"line":562,"column":28}}},"104":{"name":"indexStreamFn","line":567,"loc":{"start":{"line":567,"column":2},"end":{"line":567,"column":41}}},"105":{"name":"(anonymous_105)","line":568,"loc":{"start":{"line":568,"column":11},"end":{"line":568,"column":27}}},"106":{"name":"lookup","line":585,"loc":{"start":{"line":585,"column":6},"end":{"line":585,"column":28}}},"107":{"name":"fetch","line":598,"loc":{"start":{"line":598,"column":6},"end":{"line":598,"column":31}}},"108":{"name":"(anonymous_108)","line":600,"loc":{"start":{"line":600,"column":120},"end":{"line":600,"column":143}}},"109":{"name":"(anonymous_109)","line":606,"loc":{"start":{"line":606,"column":28},"end":{"line":606,"column":50}}},"110":{"name":"(anonymous_110)","line":624,"loc":{"start":{"line":624,"column":16},"end":{"line":624,"column":28}}},"111":{"name":"(anonymous_111)","line":656,"loc":{"start":{"line":656,"column":32},"end":{"line":656,"column":44}}},"112":{"name":"onadd","line":657,"loc":{"start":{"line":657,"column":8},"end":{"line":657,"column":29}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":31}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":40}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":36}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":39}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":42}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":41}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":37}},"8":{"start":{"line":8,"column":0},"end":{"line":8,"column":40}},"9":{"start":{"line":9,"column":0},"end":{"line":9,"column":50}},"10":{"start":{"line":10,"column":0},"end":{"line":10,"column":36}},"11":{"start":{"line":11,"column":0},"end":{"line":11,"column":33}},"12":{"start":{"line":12,"column":0},"end":{"line":12,"column":37}},"13":{"start":{"line":13,"column":0},"end":{"line":13,"column":46}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":35}},"15":{"start":{"line":16,"column":0},"end":{"line":16,"column":33}},"16":{"start":{"line":17,"column":0},"end":{"line":17,"column":29}},"17":{"start":{"line":18,"column":0},"end":{"line":18,"column":43}},"18":{"start":{"line":19,"column":0},"end":{"line":19,"column":46}},"19":{"start":{"line":21,"column":0},"end":{"line":666,"column":1}},"20":{"start":{"line":23,"column":2},"end":{"line":23,"column":14}},"21":{"start":{"line":24,"column":2},"end":{"line":24,"column":46}},"22":{"start":{"line":25,"column":2},"end":{"line":30,"column":3}},"23":{"start":{"line":31,"column":2},"end":{"line":47,"column":3}},"24":{"start":{"line":54,"column":2},"end":{"line":54,"column":26}},"25":{"start":{"line":55,"column":2},"end":{"line":59,"column":3}},"26":{"start":{"line":56,"column":4},"end":{"line":58,"column":13}},"27":{"start":{"line":57,"column":6},"end":{"line":57,"column":22}},"28":{"start":{"line":58,"column":9},"end":{"line":58,"column":13}},"29":{"start":{"line":60,"column":2},"end":{"line":60,"column":35}},"30":{"start":{"line":60,"column":29},"end":{"line":60,"column":34}},"31":{"start":{"line":61,"column":2},"end":{"line":67,"column":3}},"32":{"start":{"line":62,"column":4},"end":{"line":62,"column":8}},"33":{"start":{"line":63,"column":4},"end":{"line":66,"column":5}},"34":{"start":{"line":64,"column":6},"end":{"line":64,"column":45}},"35":{"start":{"line":64,"column":38},"end":{"line":64,"column":43}},"36":{"start":{"line":65,"column":6},"end":{"line":65,"column":24}},"37":{"start":{"line":70,"column":2},"end":{"line":97,"column":3}},"38":{"start":{"line":74,"column":6},"end":{"line":74,"column":56}},"39":{"start":{"line":75,"column":6},"end":{"line":75,"column":80}},"40":{"start":{"line":75,"column":50},"end":{"line":75,"column":70}},"41":{"start":{"line":75,"column":71},"end":{"line":75,"column":78}},"42":{"start":{"line":76,"column":6},"end":{"line":76,"column":72}},"43":{"start":{"line":76,"column":44},"end":{"line":76,"column":62}},"44":{"start":{"line":76,"column":63},"end":{"line":76,"column":70}},"45":{"start":{"line":77,"column":6},"end":{"line":77,"column":14}},"46":{"start":{"line":78,"column":6},"end":{"line":80,"column":7}},"47":{"start":{"line":79,"column":8},"end":{"line":79,"column":35}},"48":{"start":{"line":79,"column":22},"end":{"line":79,"column":35}},"49":{"start":{"line":84,"column":8},"end":{"line":94,"column":9}},"50":{"start":{"line":86,"column":10},"end":{"line":86,"column":70}},"51":{"start":{"line":87,"column":10},"end":{"line":87,"column":33}},"52":{"start":{"line":90,"column":10},"end":{"line":93,"column":11}},"53":{"start":{"line":91,"column":12},"end":{"line":91,"column":80}},"54":{"start":{"line":92,"column":12},"end":{"line":92,"column":35}},"55":{"start":{"line":100,"column":2},"end":{"line":108,"column":3}},"56":{"start":{"line":103,"column":6},"end":{"line":106,"column":7}},"57":{"start":{"line":104,"column":8},"end":{"line":104,"column":44}},"58":{"start":{"line":105,"column":8},"end":{"line":105,"column":32}},"59":{"start":{"line":111,"column":2},"end":{"line":111,"column":14}},"60":{"start":{"line":112,"column":2},"end":{"line":121,"column":3}},"61":{"start":{"line":115,"column":6},"end":{"line":118,"column":7}},"62":{"start":{"line":116,"column":8},"end":{"line":116,"column":46}},"63":{"start":{"line":117,"column":8},"end":{"line":117,"column":35}},"64":{"start":{"line":120,"column":18},"end":{"line":120,"column":31}},"65":{"start":{"line":124,"column":2},"end":{"line":124,"column":29}},"66":{"start":{"line":125,"column":2},"end":{"line":125,"column":63}},"67":{"start":{"line":126,"column":2},"end":{"line":139,"column":4}},"68":{"start":{"line":128,"column":4},"end":{"line":128,"column":101}},"69":{"start":{"line":129,"column":4},"end":{"line":129,"column":16}},"70":{"start":{"line":130,"column":4},"end":{"line":138,"column":5}},"71":{"start":{"line":131,"column":6},"end":{"line":131,"column":40}},"72":{"start":{"line":133,"column":6},"end":{"line":136,"column":8}},"73":{"start":{"line":134,"column":8},"end":{"line":134,"column":40}},"74":{"start":{"line":135,"column":8},"end":{"line":135,"column":30}},"75":{"start":{"line":137,"column":6},"end":{"line":137,"column":18}},"76":{"start":{"line":142,"column":2},"end":{"line":142,"column":23}},"77":{"start":{"line":143,"column":2},"end":{"line":157,"column":3}},"78":{"start":{"line":144,"column":4},"end":{"line":145,"column":12}},"79":{"start":{"line":145,"column":6},"end":{"line":145,"column":12}},"80":{"start":{"line":146,"column":4},"end":{"line":146,"column":22}},"81":{"start":{"line":147,"column":4},"end":{"line":147,"column":17}},"82":{"start":{"line":148,"column":4},"end":{"line":156,"column":15}},"83":{"start":{"line":149,"column":6},"end":{"line":154,"column":8}},"84":{"start":{"line":150,"column":8},"end":{"line":150,"column":25}},"85":{"start":{"line":151,"column":8},"end":{"line":151,"column":33}},"86":{"start":{"line":152,"column":8},"end":{"line":152,"column":43}},"87":{"start":{"line":153,"column":8},"end":{"line":153,"column":17}},"88":{"start":{"line":156,"column":6},"end":{"line":156,"column":15}},"89":{"start":{"line":161,"column":2},"end":{"line":163,"column":3}},"90":{"start":{"line":162,"column":4},"end":{"line":162,"column":26}},"91":{"start":{"line":165,"column":2},"end":{"line":169,"column":3}},"92":{"start":{"line":166,"column":4},"end":{"line":168,"column":6}},"93":{"start":{"line":167,"column":6},"end":{"line":167,"column":33}},"94":{"start":{"line":171,"column":2},"end":{"line":182,"column":3}},"95":{"start":{"line":172,"column":4},"end":{"line":181,"column":6}},"96":{"start":{"line":173,"column":6},"end":{"line":179,"column":7}},"97":{"start":{"line":174,"column":57},"end":{"line":174,"column":76}},"98":{"start":{"line":175,"column":64},"end":{"line":175,"column":83}},"99":{"start":{"line":176,"column":62},"end":{"line":176,"column":81}},"100":{"start":{"line":177,"column":66},"end":{"line":177,"column":85}},"101":{"start":{"line":180,"column":6},"end":{"line":180,"column":22}},"102":{"start":{"line":184,"column":2},"end":{"line":184,"column":52}},"103":{"start":{"line":185,"column":2},"end":{"line":185,"column":59}},"104":{"start":{"line":186,"column":2},"end":{"line":186,"column":57}},"105":{"start":{"line":187,"column":2},"end":{"line":187,"column":55}},"106":{"start":{"line":188,"column":2},"end":{"line":188,"column":65}},"107":{"start":{"line":189,"column":2},"end":{"line":189,"column":63}},"108":{"start":{"line":190,"column":2},"end":{"line":195,"column":3}},"109":{"start":{"line":191,"column":4},"end":{"line":192,"column":45}},"110":{"start":{"line":192,"column":6},"end":{"line":192,"column":45}},"111":{"start":{"line":193,"column":4},"end":{"line":193,"column":40}},"112":{"start":{"line":194,"column":4},"end":{"line":194,"column":37}},"113":{"start":{"line":196,"column":2},"end":{"line":216,"column":3}},"114":{"start":{"line":197,"column":4},"end":{"line":197,"column":21}},"115":{"start":{"line":198,"column":4},"end":{"line":198,"column":53}},"116":{"start":{"line":200,"column":4},"end":{"line":200,"column":26}},"117":{"start":{"line":201,"column":4},"end":{"line":201,"column":21}},"118":{"start":{"line":203,"column":4},"end":{"line":203,"column":22}},"119":{"start":{"line":204,"column":4},"end":{"line":215,"column":5}},"120":{"start":{"line":208,"column":8},"end":{"line":208,"column":46}},"121":{"start":{"line":212,"column":8},"end":{"line":212,"column":58}},"122":{"start":{"line":218,"column":2},"end":{"line":235,"column":3}},"123":{"start":{"line":219,"column":4},"end":{"line":224,"column":5}},"124":{"start":{"line":220,"column":6},"end":{"line":222,"column":8}},"125":{"start":{"line":221,"column":8},"end":{"line":221,"column":44}},"126":{"start":{"line":223,"column":6},"end":{"line":223,"column":12}},"127":{"start":{"line":226,"column":4},"end":{"line":226,"column":32}},"128":{"start":{"line":227,"column":4},"end":{"line":227,"column":38}},"129":{"start":{"line":228,"column":4},"end":{"line":234,"column":5}},"130":{"start":{"line":229,"column":6},"end":{"line":229,"column":30}},"131":{"start":{"line":230,"column":6},"end":{"line":230,"column":23}},"132":{"start":{"line":231,"column":6},"end":{"line":232,"column":50}},"133":{"start":{"line":232,"column":8},"end":{"line":232,"column":50}},"134":{"start":{"line":233,"column":6},"end":{"line":233,"column":17}},"135":{"start":{"line":237,"column":2},"end":{"line":254,"column":3}},"136":{"start":{"line":238,"column":4},"end":{"line":243,"column":5}},"137":{"start":{"line":239,"column":6},"end":{"line":241,"column":8}},"138":{"start":{"line":240,"column":8},"end":{"line":240,"column":46}},"139":{"start":{"line":242,"column":6},"end":{"line":242,"column":12}},"140":{"start":{"line":245,"column":4},"end":{"line":245,"column":32}},"141":{"start":{"line":246,"column":4},"end":{"line":246,"column":38}},"142":{"start":{"line":247,"column":4},"end":{"line":253,"column":5}},"143":{"start":{"line":248,"column":6},"end":{"line":248,"column":30}},"144":{"start":{"line":249,"column":6},"end":{"line":249,"column":24}},"145":{"start":{"line":250,"column":6},"end":{"line":251,"column":50}},"146":{"start":{"line":251,"column":8},"end":{"line":251,"column":50}},"147":{"start":{"line":252,"column":6},"end":{"line":252,"column":17}},"148":{"start":{"line":256,"column":2},"end":{"line":270,"column":3}},"149":{"start":{"line":257,"column":4},"end":{"line":269,"column":6}},"150":{"start":{"line":258,"column":6},"end":{"line":258,"column":33}},"151":{"start":{"line":259,"column":6},"end":{"line":259,"column":37}},"152":{"start":{"line":260,"column":6},"end":{"line":260,"column":36}},"153":{"start":{"line":261,"column":6},"end":{"line":261,"column":40}},"154":{"start":{"line":262,"column":6},"end":{"line":268,"column":7}},"155":{"start":{"line":263,"column":8},"end":{"line":263,"column":94}},"156":{"start":{"line":263,"column":47},"end":{"line":263,"column":87}},"157":{"start":{"line":264,"column":8},"end":{"line":264,"column":81}},"158":{"start":{"line":264,"column":37},"end":{"line":264,"column":79}},"159":{"start":{"line":266,"column":8},"end":{"line":266,"column":33}},"160":{"start":{"line":267,"column":8},"end":{"line":267,"column":49}},"161":{"start":{"line":271,"column":2},"end":{"line":285,"column":3}},"162":{"start":{"line":272,"column":4},"end":{"line":284,"column":6}},"163":{"start":{"line":273,"column":6},"end":{"line":273,"column":35}},"164":{"start":{"line":274,"column":6},"end":{"line":274,"column":39}},"165":{"start":{"line":275,"column":6},"end":{"line":275,"column":38}},"166":{"start":{"line":276,"column":6},"end":{"line":276,"column":42}},"167":{"start":{"line":277,"column":6},"end":{"line":283,"column":7}},"168":{"start":{"line":278,"column":8},"end":{"line":278,"column":84}},"169":{"start":{"line":278,"column":47},"end":{"line":278,"column":77}},"170":{"start":{"line":279,"column":8},"end":{"line":279,"column":82}},"171":{"start":{"line":279,"column":37},"end":{"line":279,"column":80}},"172":{"start":{"line":281,"column":8},"end":{"line":281,"column":30}},"173":{"start":{"line":282,"column":8},"end":{"line":282,"column":50}},"174":{"start":{"line":286,"column":2},"end":{"line":305,"column":3}},"175":{"start":{"line":287,"column":4},"end":{"line":304,"column":6}},"176":{"start":{"line":288,"column":6},"end":{"line":288,"column":34}},"177":{"start":{"line":289,"column":6},"end":{"line":290,"column":45}},"178":{"start":{"line":290,"column":8},"end":{"line":290,"column":45}},"179":{"start":{"line":292,"column":6},"end":{"line":292,"column":26}},"180":{"start":{"line":293,"column":6},"end":{"line":302,"column":10}},"181":{"start":{"line":294,"column":33},"end":{"line":294,"column":52}},"182":{"start":{"line":296,"column":10},"end":{"line":296,"column":25}},"183":{"start":{"line":297,"column":10},"end":{"line":301,"column":12}},"184":{"start":{"line":298,"column":12},"end":{"line":299,"column":25}},"185":{"start":{"line":299,"column":14},"end":{"line":299,"column":25}},"186":{"start":{"line":300,"column":12},"end":{"line":300,"column":54}},"187":{"start":{"line":303,"column":6},"end":{"line":303,"column":14}},"188":{"start":{"line":306,"column":2},"end":{"line":318,"column":3}},"189":{"start":{"line":307,"column":4},"end":{"line":317,"column":6}},"190":{"start":{"line":308,"column":6},"end":{"line":316,"column":7}},"191":{"start":{"line":309,"column":8},"end":{"line":311,"column":10}},"192":{"start":{"line":310,"column":10},"end":{"line":310,"column":23}},"193":{"start":{"line":313,"column":8},"end":{"line":315,"column":10}},"194":{"start":{"line":314,"column":10},"end":{"line":314,"column":24}},"195":{"start":{"line":319,"column":2},"end":{"line":332,"column":3}},"196":{"start":{"line":320,"column":4},"end":{"line":331,"column":5}},"197":{"start":{"line":321,"column":6},"end":{"line":321,"column":38}},"198":{"start":{"line":322,"column":6},"end":{"line":325,"column":8}},"199":{"start":{"line":323,"column":8},"end":{"line":323,"column":23}},"200":{"start":{"line":324,"column":8},"end":{"line":324,"column":61}},"201":{"start":{"line":324,"column":45},"end":{"line":324,"column":59}},"202":{"start":{"line":326,"column":6},"end":{"line":326,"column":14}},"203":{"start":{"line":328,"column":6},"end":{"line":330,"column":8}},"204":{"start":{"line":329,"column":8},"end":{"line":329,"column":27}},"205":{"start":{"line":334,"column":2},"end":{"line":351,"column":3}},"206":{"start":{"line":335,"column":4},"end":{"line":350,"column":6}},"207":{"start":{"line":336,"column":6},"end":{"line":336,"column":29}},"208":{"start":{"line":336,"column":15},"end":{"line":336,"column":29}},"209":{"start":{"line":337,"column":6},"end":{"line":337,"column":52}},"210":{"start":{"line":338,"column":6},"end":{"line":338,"column":39}},"211":{"start":{"line":339,"column":6},"end":{"line":339,"column":45}},"212":{"start":{"line":340,"column":6},"end":{"line":349,"column":8}},"213":{"start":{"line":342,"column":8},"end":{"line":342,"column":77}},"214":{"start":{"line":343,"column":8},"end":{"line":343,"column":40}},"215":{"start":{"line":344,"column":8},"end":{"line":344,"column":52}},"216":{"start":{"line":345,"column":8},"end":{"line":345,"column":69}},"217":{"start":{"line":346,"column":8},"end":{"line":346,"column":36}},"218":{"start":{"line":347,"column":8},"end":{"line":347,"column":48}},"219":{"start":{"line":348,"column":8},"end":{"line":348,"column":23}},"220":{"start":{"line":352,"column":2},"end":{"line":359,"column":3}},"221":{"start":{"line":353,"column":4},"end":{"line":358,"column":6}},"222":{"start":{"line":354,"column":6},"end":{"line":354,"column":29}},"223":{"start":{"line":354,"column":15},"end":{"line":354,"column":29}},"224":{"start":{"line":355,"column":6},"end":{"line":355,"column":33}},"225":{"start":{"line":356,"column":6},"end":{"line":356,"column":29}},"226":{"start":{"line":357,"column":6},"end":{"line":357,"column":32}},"227":{"start":{"line":360,"column":2},"end":{"line":372,"column":3}},"228":{"start":{"line":361,"column":4},"end":{"line":371,"column":6}},"229":{"start":{"line":362,"column":6},"end":{"line":370,"column":7}},"230":{"start":{"line":363,"column":8},"end":{"line":365,"column":10}},"231":{"start":{"line":364,"column":10},"end":{"line":364,"column":23}},"232":{"start":{"line":367,"column":8},"end":{"line":369,"column":10}},"233":{"start":{"line":368,"column":10},"end":{"line":368,"column":24}},"234":{"start":{"line":373,"column":2},"end":{"line":377,"column":3}},"235":{"start":{"line":374,"column":4},"end":{"line":376,"column":6}},"236":{"start":{"line":375,"column":6},"end":{"line":375,"column":25}},"237":{"start":{"line":379,"column":2},"end":{"line":385,"column":3}},"238":{"start":{"line":380,"column":4},"end":{"line":380,"column":30}},"239":{"start":{"line":381,"column":4},"end":{"line":381,"column":24}},"240":{"start":{"line":382,"column":4},"end":{"line":383,"column":35}},"241":{"start":{"line":383,"column":6},"end":{"line":383,"column":35}},"242":{"start":{"line":384,"column":4},"end":{"line":384,"column":16}},"243":{"start":{"line":386,"column":2},"end":{"line":402,"column":3}},"244":{"start":{"line":387,"column":4},"end":{"line":401,"column":6}},"245":{"start":{"line":388,"column":6},"end":{"line":388,"column":23}},"246":{"start":{"line":389,"column":6},"end":{"line":399,"column":7}},"247":{"start":{"line":390,"column":8},"end":{"line":398,"column":9}},"248":{"start":{"line":391,"column":10},"end":{"line":391,"column":72}},"249":{"start":{"line":392,"column":10},"end":{"line":397,"column":12}},"250":{"start":{"line":400,"column":6},"end":{"line":400,"column":24}},"251":{"start":{"line":403,"column":2},"end":{"line":408,"column":3}},"252":{"start":{"line":404,"column":4},"end":{"line":404,"column":40}},"253":{"start":{"line":405,"column":4},"end":{"line":405,"column":23}},"254":{"start":{"line":406,"column":4},"end":{"line":406,"column":40}},"255":{"start":{"line":407,"column":4},"end":{"line":407,"column":60}},"256":{"start":{"line":409,"column":2},"end":{"line":414,"column":3}},"257":{"start":{"line":410,"column":4},"end":{"line":410,"column":40}},"258":{"start":{"line":411,"column":4},"end":{"line":411,"column":24}},"259":{"start":{"line":412,"column":4},"end":{"line":412,"column":37}},"260":{"start":{"line":413,"column":4},"end":{"line":413,"column":61}},"261":{"start":{"line":415,"column":2},"end":{"line":426,"column":3}},"262":{"start":{"line":416,"column":4},"end":{"line":416,"column":40}},"263":{"start":{"line":417,"column":4},"end":{"line":425,"column":5}},"264":{"start":{"line":418,"column":6},"end":{"line":420,"column":8}},"265":{"start":{"line":419,"column":8},"end":{"line":419,"column":21}},"266":{"start":{"line":422,"column":6},"end":{"line":424,"column":8}},"267":{"start":{"line":423,"column":8},"end":{"line":423,"column":22}},"268":{"start":{"line":427,"column":2},"end":{"line":432,"column":3}},"269":{"start":{"line":428,"column":4},"end":{"line":428,"column":40}},"270":{"start":{"line":429,"column":4},"end":{"line":429,"column":24}},"271":{"start":{"line":430,"column":4},"end":{"line":430,"column":41}},"272":{"start":{"line":431,"column":4},"end":{"line":431,"column":61}},"273":{"start":{"line":433,"column":2},"end":{"line":438,"column":3}},"274":{"start":{"line":434,"column":4},"end":{"line":434,"column":40}},"275":{"start":{"line":435,"column":4},"end":{"line":435,"column":25}},"276":{"start":{"line":436,"column":4},"end":{"line":436,"column":38}},"277":{"start":{"line":437,"column":4},"end":{"line":437,"column":62}},"278":{"start":{"line":439,"column":2},"end":{"line":450,"column":3}},"279":{"start":{"line":440,"column":4},"end":{"line":440,"column":40}},"280":{"start":{"line":441,"column":4},"end":{"line":449,"column":5}},"281":{"start":{"line":442,"column":6},"end":{"line":444,"column":8}},"282":{"start":{"line":443,"column":8},"end":{"line":443,"column":21}},"283":{"start":{"line":446,"column":6},"end":{"line":448,"column":8}},"284":{"start":{"line":447,"column":8},"end":{"line":447,"column":22}},"285":{"start":{"line":452,"column":2},"end":{"line":457,"column":3}},"286":{"start":{"line":453,"column":4},"end":{"line":456,"column":5}},"287":{"start":{"line":458,"column":2},"end":{"line":463,"column":3}},"288":{"start":{"line":459,"column":4},"end":{"line":462,"column":5}},"289":{"start":{"line":465,"column":2},"end":{"line":465,"column":73}},"290":{"start":{"line":466,"column":2},"end":{"line":540,"column":3}},"291":{"start":{"line":467,"column":4},"end":{"line":467,"column":30}},"292":{"start":{"line":470,"column":4},"end":{"line":470,"column":17}},"293":{"start":{"line":471,"column":4},"end":{"line":471,"column":42}},"294":{"start":{"line":472,"column":4},"end":{"line":472,"column":20}},"295":{"start":{"line":473,"column":4},"end":{"line":490,"column":19}},"296":{"start":{"line":474,"column":6},"end":{"line":474,"column":20}},"297":{"start":{"line":475,"column":6},"end":{"line":475,"column":51}},"298":{"start":{"line":478,"column":6},"end":{"line":479,"column":21}},"299":{"start":{"line":479,"column":8},"end":{"line":479,"column":21}},"300":{"start":{"line":482,"column":6},"end":{"line":488,"column":24}},"301":{"start":{"line":484,"column":10},"end":{"line":484,"column":32}},"302":{"start":{"line":485,"column":10},"end":{"line":486,"column":66}},"303":{"start":{"line":486,"column":12},"end":{"line":486,"column":66}},"304":{"start":{"line":490,"column":6},"end":{"line":490,"column":19}},"305":{"start":{"line":492,"column":4},"end":{"line":496,"column":5}},"306":{"start":{"line":493,"column":6},"end":{"line":493,"column":71}},"307":{"start":{"line":494,"column":6},"end":{"line":494,"column":21}},"308":{"start":{"line":495,"column":6},"end":{"line":495,"column":22}},"309":{"start":{"line":499,"column":4},"end":{"line":499,"column":45}},"310":{"start":{"line":500,"column":4},"end":{"line":522,"column":5}},"311":{"start":{"line":501,"column":6},"end":{"line":501,"column":28}},"312":{"start":{"line":502,"column":6},"end":{"line":503,"column":30}},"313":{"start":{"line":503,"column":8},"end":{"line":503,"column":30}},"314":{"start":{"line":506,"column":6},"end":{"line":506,"column":56}},"315":{"start":{"line":507,"column":6},"end":{"line":521,"column":8}},"316":{"start":{"line":508,"column":8},"end":{"line":511,"column":9}},"317":{"start":{"line":509,"column":10},"end":{"line":509,"column":83}},"318":{"start":{"line":510,"column":10},"end":{"line":510,"column":30}},"319":{"start":{"line":513,"column":8},"end":{"line":520,"column":10}},"320":{"start":{"line":514,"column":10},"end":{"line":519,"column":25}},"321":{"start":{"line":516,"column":12},"end":{"line":516,"column":58}},"322":{"start":{"line":517,"column":12},"end":{"line":517,"column":27}},"323":{"start":{"line":519,"column":12},"end":{"line":519,"column":25}},"324":{"start":{"line":524,"column":4},"end":{"line":537,"column":5}},"325":{"start":{"line":526,"column":6},"end":{"line":526,"column":13}},"326":{"start":{"line":527,"column":6},"end":{"line":527,"column":49}},"327":{"start":{"line":528,"column":6},"end":{"line":536,"column":7}},"328":{"start":{"line":531,"column":10},"end":{"line":531,"column":28}},"329":{"start":{"line":534,"column":10},"end":{"line":534,"column":22}},"330":{"start":{"line":539,"column":4},"end":{"line":539,"column":20}},"331":{"start":{"line":542,"column":2},"end":{"line":544,"column":3}},"332":{"start":{"line":543,"column":4},"end":{"line":543,"column":59}},"333":{"start":{"line":543,"column":28},"end":{"line":543,"column":57}},"334":{"start":{"line":545,"column":2},"end":{"line":547,"column":3}},"335":{"start":{"line":546,"column":4},"end":{"line":546,"column":55}},"336":{"start":{"line":546,"column":28},"end":{"line":546,"column":53}},"337":{"start":{"line":548,"column":2},"end":{"line":550,"column":3}},"338":{"start":{"line":549,"column":4},"end":{"line":549,"column":52}},"339":{"start":{"line":549,"column":28},"end":{"line":549,"column":50}},"340":{"start":{"line":551,"column":2},"end":{"line":553,"column":3}},"341":{"start":{"line":552,"column":4},"end":{"line":552,"column":50}},"342":{"start":{"line":552,"column":28},"end":{"line":552,"column":48}},"343":{"start":{"line":554,"column":2},"end":{"line":556,"column":3}},"344":{"start":{"line":555,"column":4},"end":{"line":555,"column":56}},"345":{"start":{"line":555,"column":28},"end":{"line":555,"column":54}},"346":{"start":{"line":557,"column":2},"end":{"line":559,"column":3}},"347":{"start":{"line":558,"column":4},"end":{"line":558,"column":58}},"348":{"start":{"line":558,"column":28},"end":{"line":558,"column":56}},"349":{"start":{"line":562,"column":2},"end":{"line":564,"column":3}},"350":{"start":{"line":563,"column":4},"end":{"line":563,"column":53}},"351":{"start":{"line":567,"column":2},"end":{"line":663,"column":3}},"352":{"start":{"line":568,"column":4},"end":{"line":662,"column":5}},"353":{"start":{"line":569,"column":6},"end":{"line":569,"column":43}},"354":{"start":{"line":570,"column":6},"end":{"line":570,"column":19}},"355":{"start":{"line":573,"column":6},"end":{"line":573,"column":33}},"356":{"start":{"line":574,"column":6},"end":{"line":574,"column":34}},"357":{"start":{"line":575,"column":6},"end":{"line":575,"column":33}},"358":{"start":{"line":576,"column":6},"end":{"line":576,"column":34}},"359":{"start":{"line":577,"column":6},"end":{"line":577,"column":36}},"360":{"start":{"line":578,"column":6},"end":{"line":578,"column":38}},"361":{"start":{"line":579,"column":6},"end":{"line":579,"column":37}},"362":{"start":{"line":585,"column":6},"end":{"line":595,"column":7}},"363":{"start":{"line":586,"column":8},"end":{"line":586,"column":24}},"364":{"start":{"line":586,"column":18},"end":{"line":586,"column":24}},"365":{"start":{"line":587,"column":8},"end":{"line":587,"column":50}},"366":{"start":{"line":588,"column":8},"end":{"line":594,"column":9}},"367":{"start":{"line":589,"column":10},"end":{"line":589,"column":36}},"368":{"start":{"line":590,"column":10},"end":{"line":592,"column":11}},"369":{"start":{"line":591,"column":12},"end":{"line":591,"column":48}},"370":{"start":{"line":591,"column":29},"end":{"line":591,"column":48}},"371":{"start":{"line":593,"column":10},"end":{"line":593,"column":24}},"372":{"start":{"line":598,"column":6},"end":{"line":617,"column":7}},"373":{"start":{"line":599,"column":8},"end":{"line":616,"column":9}},"374":{"start":{"line":600,"column":10},"end":{"line":604,"column":12}},"375":{"start":{"line":601,"column":12},"end":{"line":602,"column":32}},"376":{"start":{"line":602,"column":14},"end":{"line":602,"column":32}},"377":{"start":{"line":603,"column":12},"end":{"line":603,"column":25}},"378":{"start":{"line":606,"column":10},"end":{"line":615,"column":12}},"379":{"start":{"line":613,"column":12},"end":{"line":613,"column":29}},"380":{"start":{"line":614,"column":12},"end":{"line":614,"column":25}},"381":{"start":{"line":620,"column":6},"end":{"line":620,"column":31}},"382":{"start":{"line":621,"column":6},"end":{"line":621,"column":47}},"383":{"start":{"line":624,"column":6},"end":{"line":651,"column":8}},"384":{"start":{"line":625,"column":8},"end":{"line":625,"column":21}},"385":{"start":{"line":626,"column":8},"end":{"line":649,"column":9}},"386":{"start":{"line":627,"column":10},"end":{"line":627,"column":33}},"387":{"start":{"line":629,"column":10},"end":{"line":630,"column":17}},"388":{"start":{"line":630,"column":12},"end":{"line":630,"column":17}},"389":{"start":{"line":633,"column":10},"end":{"line":639,"column":11}},"390":{"start":{"line":640,"column":10},"end":{"line":641,"column":20}},"391":{"start":{"line":641,"column":12},"end":{"line":641,"column":20}},"392":{"start":{"line":643,"column":10},"end":{"line":643,"column":29}},"393":{"start":{"line":644,"column":10},"end":{"line":648,"column":11}},"394":{"start":{"line":645,"column":12},"end":{"line":645,"column":41}},"395":{"start":{"line":646,"column":12},"end":{"line":646,"column":28}},"396":{"start":{"line":647,"column":12},"end":{"line":647,"column":19}},"397":{"start":{"line":650,"column":8},"end":{"line":650,"column":22}},"398":{"start":{"line":653,"column":6},"end":{"line":660,"column":7}},"399":{"start":{"line":655,"column":8},"end":{"line":655,"column":30}},"400":{"start":{"line":656,"column":8},"end":{"line":656,"column":83}},"401":{"start":{"line":656,"column":46},"end":{"line":656,"column":81}},"402":{"start":{"line":657,"column":8},"end":{"line":657,"column":59}},"403":{"start":{"line":657,"column":31},"end":{"line":657,"column":58}},"404":{"start":{"line":658,"column":8},"end":{"line":658,"column":49}},"405":{"start":{"line":659,"column":8},"end":{"line":659,"column":32}},"406":{"start":{"line":661,"column":6},"end":{"line":661,"column":17}},"407":{"start":{"line":665,"column":2},"end":{"line":665,"column":12}}},"branchMap":{"1":{"line":56,"type":"if","locations":[{"start":{"line":56,"column":4},"end":{"line":56,"column":4}},{"start":{"line":56,"column":4},"end":{"line":56,"column":4}}]},"2":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":4},"end":{"line":63,"column":4}},{"start":{"line":63,"column":4},"end":{"line":63,"column":4}}]},"3":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":8},"end":{"line":79,"column":8}},{"start":{"line":79,"column":8},"end":{"line":79,"column":8}}]},"4":{"line":84,"type":"if","locations":[{"start":{"line":84,"column":8},"end":{"line":84,"column":8}},{"start":{"line":84,"column":8},"end":{"line":84,"column":8}}]},"5":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":10},"end":{"line":90,"column":10}},{"start":{"line":90,"column":10},"end":{"line":90,"column":10}}]},"6":{"line":90,"type":"binary-expr","locations":[{"start":{"line":90,"column":14},"end":{"line":90,"column":23}},{"start":{"line":90,"column":27},"end":{"line":90,"column":63}}]},"7":{"line":103,"type":"if","locations":[{"start":{"line":103,"column":6},"end":{"line":103,"column":6}},{"start":{"line":103,"column":6},"end":{"line":103,"column":6}}]},"8":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":6},"end":{"line":115,"column":6}},{"start":{"line":115,"column":6},"end":{"line":115,"column":6}}]},"9":{"line":144,"type":"if","locations":[{"start":{"line":144,"column":4},"end":{"line":144,"column":4}},{"start":{"line":144,"column":4},"end":{"line":144,"column":4}}]},"10":{"line":146,"type":"binary-expr","locations":[{"start":{"line":146,"column":12},"end":{"line":146,"column":16}},{"start":{"line":146,"column":20},"end":{"line":146,"column":22}}]},"11":{"line":148,"type":"if","locations":[{"start":{"line":148,"column":4},"end":{"line":148,"column":4}},{"start":{"line":148,"column":4},"end":{"line":148,"column":4}}]},"12":{"line":191,"type":"if","locations":[{"start":{"line":191,"column":4},"end":{"line":191,"column":4}},{"start":{"line":191,"column":4},"end":{"line":191,"column":4}}]},"13":{"line":191,"type":"binary-expr","locations":[{"start":{"line":191,"column":8},"end":{"line":191,"column":35}},{"start":{"line":191,"column":39},"end":{"line":191,"column":54}}]},"14":{"line":197,"type":"binary-expr","locations":[{"start":{"line":197,"column":11},"end":{"line":197,"column":15}},{"start":{"line":197,"column":19},"end":{"line":197,"column":21}}]},"15":{"line":198,"type":"binary-expr","locations":[{"start":{"line":198,"column":33},"end":{"line":198,"column":43}},{"start":{"line":198,"column":45},"end":{"line":198,"column":47}}]},"16":{"line":214,"type":"cond-expr","locations":[{"start":{"line":214,"column":14},"end":{"line":214,"column":30}},{"start":{"line":214,"column":33},"end":{"line":214,"column":42}}]},"17":{"line":219,"type":"if","locations":[{"start":{"line":219,"column":4},"end":{"line":219,"column":4}},{"start":{"line":219,"column":4},"end":{"line":219,"column":4}}]},"18":{"line":228,"type":"if","locations":[{"start":{"line":228,"column":4},"end":{"line":228,"column":4}},{"start":{"line":228,"column":4},"end":{"line":228,"column":4}}]},"19":{"line":231,"type":"if","locations":[{"start":{"line":231,"column":6},"end":{"line":231,"column":6}},{"start":{"line":231,"column":6},"end":{"line":231,"column":6}}]},"20":{"line":238,"type":"if","locations":[{"start":{"line":238,"column":4},"end":{"line":238,"column":4}},{"start":{"line":238,"column":4},"end":{"line":238,"column":4}}]},"21":{"line":247,"type":"if","locations":[{"start":{"line":247,"column":4},"end":{"line":247,"column":4}},{"start":{"line":247,"column":4},"end":{"line":247,"column":4}}]},"22":{"line":250,"type":"if","locations":[{"start":{"line":250,"column":6},"end":{"line":250,"column":6}},{"start":{"line":250,"column":6},"end":{"line":250,"column":6}}]},"23":{"line":262,"type":"if","locations":[{"start":{"line":262,"column":6},"end":{"line":262,"column":6}},{"start":{"line":262,"column":6},"end":{"line":262,"column":6}}]},"24":{"line":277,"type":"if","locations":[{"start":{"line":277,"column":6},"end":{"line":277,"column":6}},{"start":{"line":277,"column":6},"end":{"line":277,"column":6}}]},"25":{"line":289,"type":"if","locations":[{"start":{"line":289,"column":6},"end":{"line":289,"column":6}},{"start":{"line":289,"column":6},"end":{"line":289,"column":6}}]},"26":{"line":289,"type":"binary-expr","locations":[{"start":{"line":289,"column":10},"end":{"line":289,"column":16}},{"start":{"line":289,"column":20},"end":{"line":289,"column":44}}]},"27":{"line":298,"type":"if","locations":[{"start":{"line":298,"column":12},"end":{"line":298,"column":12}},{"start":{"line":298,"column":12},"end":{"line":298,"column":12}}]},"28":{"line":308,"type":"if","locations":[{"start":{"line":308,"column":6},"end":{"line":308,"column":6}},{"start":{"line":308,"column":6},"end":{"line":308,"column":6}}]},"29":{"line":320,"type":"if","locations":[{"start":{"line":320,"column":4},"end":{"line":320,"column":4}},{"start":{"line":320,"column":4},"end":{"line":320,"column":4}}]},"30":{"line":329,"type":"binary-expr","locations":[{"start":{"line":329,"column":8},"end":{"line":329,"column":10}},{"start":{"line":329,"column":14},"end":{"line":329,"column":27}}]},"31":{"line":336,"type":"if","locations":[{"start":{"line":336,"column":6},"end":{"line":336,"column":6}},{"start":{"line":336,"column":6},"end":{"line":336,"column":6}}]},"32":{"line":354,"type":"if","locations":[{"start":{"line":354,"column":6},"end":{"line":354,"column":6}},{"start":{"line":354,"column":6},"end":{"line":354,"column":6}}]},"33":{"line":362,"type":"if","locations":[{"start":{"line":362,"column":6},"end":{"line":362,"column":6}},{"start":{"line":362,"column":6},"end":{"line":362,"column":6}}]},"34":{"line":375,"type":"binary-expr","locations":[{"start":{"line":375,"column":6},"end":{"line":375,"column":8}},{"start":{"line":375,"column":12},"end":{"line":375,"column":25}}]},"35":{"line":382,"type":"if","locations":[{"start":{"line":382,"column":4},"end":{"line":382,"column":4}},{"start":{"line":382,"column":4},"end":{"line":382,"column":4}}]},"36":{"line":390,"type":"if","locations":[{"start":{"line":390,"column":8},"end":{"line":390,"column":8}},{"start":{"line":390,"column":8},"end":{"line":390,"column":8}}]},"37":{"line":391,"type":"cond-expr","locations":[{"start":{"line":391,"column":49},"end":{"line":391,"column":68}},{"start":{"line":391,"column":71},"end":{"line":391,"column":72}}]},"38":{"line":417,"type":"if","locations":[{"start":{"line":417,"column":4},"end":{"line":417,"column":4}},{"start":{"line":417,"column":4},"end":{"line":417,"column":4}}]},"39":{"line":441,"type":"if","locations":[{"start":{"line":441,"column":4},"end":{"line":441,"column":4}},{"start":{"line":441,"column":4},"end":{"line":441,"column":4}}]},"40":{"line":473,"type":"if","locations":[{"start":{"line":473,"column":4},"end":{"line":473,"column":4}},{"start":{"line":473,"column":4},"end":{"line":473,"column":4}}]},"41":{"line":475,"type":"cond-expr","locations":[{"start":{"line":475,"column":27},"end":{"line":475,"column":46}},{"start":{"line":475,"column":49},"end":{"line":475,"column":51}}]},"42":{"line":478,"type":"if","locations":[{"start":{"line":478,"column":6},"end":{"line":478,"column":6}},{"start":{"line":478,"column":6},"end":{"line":478,"column":6}}]},"43":{"line":485,"type":"if","locations":[{"start":{"line":485,"column":10},"end":{"line":485,"column":10}},{"start":{"line":485,"column":10},"end":{"line":485,"column":10}}]},"44":{"line":492,"type":"if","locations":[{"start":{"line":492,"column":4},"end":{"line":492,"column":4}},{"start":{"line":492,"column":4},"end":{"line":492,"column":4}}]},"45":{"line":502,"type":"if","locations":[{"start":{"line":502,"column":6},"end":{"line":502,"column":6}},{"start":{"line":502,"column":6},"end":{"line":502,"column":6}}]},"46":{"line":508,"type":"if","locations":[{"start":{"line":508,"column":8},"end":{"line":508,"column":8}},{"start":{"line":508,"column":8},"end":{"line":508,"column":8}}]},"47":{"line":514,"type":"if","locations":[{"start":{"line":514,"column":10},"end":{"line":514,"column":10}},{"start":{"line":514,"column":10},"end":{"line":514,"column":10}}]},"48":{"line":563,"type":"cond-expr","locations":[{"start":{"line":563,"column":40},"end":{"line":563,"column":47}},{"start":{"line":563,"column":50},"end":{"line":563,"column":53}}]},"49":{"line":563,"type":"binary-expr","locations":[{"start":{"line":563,"column":11},"end":{"line":563,"column":15}},{"start":{"line":563,"column":19},"end":{"line":563,"column":37}}]},"50":{"line":586,"type":"if","locations":[{"start":{"line":586,"column":8},"end":{"line":586,"column":8}},{"start":{"line":586,"column":8},"end":{"line":586,"column":8}}]},"51":{"line":587,"type":"cond-expr","locations":[{"start":{"line":587,"column":29},"end":{"line":587,"column":40}},{"start":{"line":587,"column":43},"end":{"line":587,"column":50}}]},"52":{"line":588,"type":"if","locations":[{"start":{"line":588,"column":8},"end":{"line":588,"column":8}},{"start":{"line":588,"column":8},"end":{"line":588,"column":8}}]},"53":{"line":591,"type":"if","locations":[{"start":{"line":591,"column":12},"end":{"line":591,"column":12}},{"start":{"line":591,"column":12},"end":{"line":591,"column":12}}]},"54":{"line":599,"type":"if","locations":[{"start":{"line":599,"column":8},"end":{"line":599,"column":8}},{"start":{"line":599,"column":8},"end":{"line":599,"column":8}}]},"55":{"line":629,"type":"if","locations":[{"start":{"line":629,"column":10},"end":{"line":629,"column":10}},{"start":{"line":629,"column":10},"end":{"line":629,"column":10}}]},"56":{"line":629,"type":"binary-expr","locations":[{"start":{"line":629,"column":14},"end":{"line":629,"column":19}},{"start":{"line":629,"column":23},"end":{"line":629,"column":37}}]},"57":{"line":634,"type":"binary-expr","locations":[{"start":{"line":634,"column":13},"end":{"line":634,"column":15}},{"start":{"line":634,"column":20},"end":{"line":634,"column":35}},{"start":{"line":635,"column":13},"end":{"line":635,"column":16}},{"start":{"line":635,"column":20},"end":{"line":635,"column":35}},{"start":{"line":636,"column":13},"end":{"line":636,"column":15}},{"start":{"line":636,"column":20},"end":{"line":636,"column":35}},{"start":{"line":637,"column":13},"end":{"line":637,"column":16}},{"start":{"line":637,"column":20},"end":{"line":637,"column":35}},{"start":{"line":638,"column":13},"end":{"line":638,"column":19}},{"start":{"line":638,"column":23},"end":{"line":638,"column":33}}]},"58":{"line":640,"type":"if","locations":[{"start":{"line":640,"column":10},"end":{"line":640,"column":10}},{"start":{"line":640,"column":10},"end":{"line":640,"column":10}}]},"59":{"line":644,"type":"if","locations":[{"start":{"line":644,"column":10},"end":{"line":644,"column":10}},{"start":{"line":644,"column":10},"end":{"line":644,"column":10}}]},"60":{"line":653,"type":"if","locations":[{"start":{"line":653,"column":6},"end":{"line":653,"column":6}},{"start":{"line":653,"column":6},"end":{"line":653,"column":6}}]},"61":{"line":653,"type":"binary-expr","locations":[{"start":{"line":653,"column":10},"end":{"line":653,"column":14}},{"start":{"line":653,"column":18},"end":{"line":653,"column":27}}]}},"code":["var fs          = require('fs')","var pull        = require('pull-stream')","var multicb     = require('multicb')","var pl          = require('pull-level')","var pushable    = require('pull-pushable')","var paramap     = require('pull-paramap')","var cat         = require('pull-cat')","var Notify      = require('pull-notify')","var toPull      = require('stream-to-pull-stream')","var ref         = require('ssb-ref')","var pathlib     = require('path')","var mlib        = require('ssb-msgs')","var threadlib   = require('patchwork-threads')","var u           = require('./util')","","exports.name        = 'patchwork'","exports.version     = '1.0.0'","exports.manifest    = require('./manifest')","exports.permissions = require('./permissions')","","exports.init = function (sbot, opts) {","","  var api = {}","  var patchworkdb = sbot.sublevel('patchwork')","  var db = {","    isread: patchworkdb.sublevel('isread'),","    bookmarked: patchworkdb.sublevel('bookmarked'),","    channelpinned: patchworkdb.sublevel('channelpinned'),","    channelwatched: patchworkdb.sublevel('channelwatched')","  }","  var state = {","    // indexes (lists of {key:, ts:})","    mymsgs: [],","    inbox: u.index('inbox'),","    bookmarks: u.index('bookmarks'),","    mentions: u.index('mentions'),","    notices: u.index('notices'),","    privatePosts: u.index('privatePosts'),","    publicPosts: u.index('publicPosts'),","    // other indexes: channel-* are created as needed","","    // views","    profiles: {},","    names: {}, // ids -> names","    ids: {}, // names -> ids","    actionItems: {}","  }","","  // track sync state","  // - processor does async processing for each message that comes in","  // - awaitSync() waits for that processing to finish","  // - pinc() on message arrival, pdec() on message processed","  // - nP === 0 => all messages processed","  var nP = 0, syncCbs = []","  function awaitSync (cb) {","    if (nP > 0)","      syncCbs.push(cb)","    else cb()","  }","  state.pinc = function () { nP++ }","  state.pdec = function () {","    nP--","    if (nP === 0) {","      syncCbs.forEach(function (cb) { cb() })","      syncCbs.length = 0","    }","  }","","  // load bookmarks into indexes","  pull(","    pl.read(db.bookmarked, { keys: true, values: false }),","    pull.asyncMap(function (key, cb) {","      // fetch the message and isread data","      var obj = { key: key, value: null, isread: false }","      db.isread.get(key, function (err, isread) { obj.isread = isread; done() })","      sbot.get(key, function (err, value) { obj.value = value; done() })","      var n=0;","      function done() {","        if (++n == 2) cb(null, obj)","      }","    }),","    pull.drain(","      function (msg) {","        if (msg.value) {","          // add to the inbox index","          row = state.inbox.sortedUpsert(msg.value.timestamp, msg.key)","          row.isread = msg.isread","","          // add to the bookmarks index, only if the wont already be in the private msgs index","          if (msg.value && typeof msg.value.content != 'string') {","            var row = state.bookmarks.sortedUpsert(msg.value.timestamp, msg.key)","            row.isread = msg.isread","          }","        }","      }","    )","  )","","  // load channelpins into indexes","  pull(","    pl.read(db.channelpinned, { keys: true, values: true }),","    pull.drain(function (pin) {","      if (typeof pin.key === 'string') {","        var index = getChannelIndex(pin.key)","        index.pinned = pin.value","      }","    })","  )","","  // load channelwatches into indexes","  state.pinc()","  pull(","    pl.read(db.channelwatched, { keys: true, values: true }),","    pull.drain(function (watch) {","      if (typeof watch.key === 'string') {","        var index = getChannelIndex(watch.key)","        index.watched = watch.value","      }","    },","    function () { state.pdec() })","  )","","  // setup sbot log processor","  var isHistorySynced = false // track so we dont emit events for old messages","  var processor = require('./processor')(sbot, db, state, emit)","  awaitSync(function () { // wait for channelwatches to load up","    // create log stream","    pull(pl.read(sbot.sublevel('log'), { live: true, onSync: onHistorySync }), pull.drain(processor))","    state.pinc()","    function onHistorySync () {","      console.log('Log history read...')","      // when all current items finish, consider prehistory synced (and start emitting)","      awaitSync(function () { ","        console.log('Indexes generated')","        isHistorySynced = true","      })","      state.pdec()","    }","  })","","  // events stream","  var notify = Notify()","  function emit (type, data) {","    if (!isHistorySynced)","      return","    var e = data || {}","    e.type = type","    if (e.type == 'index-change') {","      api.getIndexCounts(function (err, counts) {","        e.counts = counts","        e.total = counts[e.index]","        e.unread = counts[e.index+'Unread']","        notify(e)","      })","    } else","      notify(e)","  }","","  // getters","","  api.createEventStream = function () {","    return notify.listen()","  }","","  api.getMyProfile = function (cb) {","    awaitSync(function () {","      api.getProfile(sbot.id, cb)","    })","  }","","  api.getIndexCounts = function (cb) {","    awaitSync(function () {","      var counts = {","        inboxUnread: state.inbox.filter(function (row) { return !row.isread }).length,","        bookmarkUnread: state.bookmarks.filter(function (row) { return !row.isread }).length,","        mentionUnread: state.mentions.filter(function (row) { return !row.isread }).length,","        privateUnread: state.privatePosts.filter(function (row) { return !row.isread }).length,","        noticesUnread: state.notices.countUntouched()","      }","      cb(null, counts)","    })","  }","","  api.createInboxStream = indexStreamFn(state.inbox)","  api.createBookmarkStream = indexStreamFn(state.bookmarks)","  api.createMentionStream = indexStreamFn(state.mentions)","  api.createNoticeStream = indexStreamFn(state.notices)","  api.createPrivatePostStream = indexStreamFn(state.privatePosts)","  api.createPublicPostStream = indexStreamFn(state.publicPosts)","  api.createChannelStream = function (channel, opts) {","    if (typeof channel !== 'string' || !channel.trim())","      return cb(new Error('Invalid channel'))","    var index = getChannelIndex(channel)","    return indexStreamFn(index)(opts)","  }","  api.createSearchStream = function (opts) {","    opts = opts || {}","    var searchRegex = new RegExp(opts.query||'', 'i')","    ","    var limit = opts.limit","    delete opts.limit","","    opts.type = 'post'","    return pull(","      sbot.messagesByType(opts),","      pull.asyncMap(function (msg, cb) {","        // decrypt the message, if needed","        threadlib.decryptThread(sbot, msg, cb)","      }),","      pull.filter(function (msg) {","        // run search filter","        return searchRegex.test(''+msg.value.content.text)","      }),","      limit ? pull.take(limit) : undefined","    )","  }","","  function indexMarkRead (indexname, key, keyname) {","    if (Array.isArray(key)) {","      key.forEach(function (k) {","        indexMarkRead(indexname, k, keyname)","      })","      return","    }","","    var index = state[indexname]","    var row = index.find(key, keyname)","    if (row) {","      var wasread = row.isread","      row.isread = true","      if (!wasread)","        emit('index-change', { index: indexname })","      return true","    }","  }","","  function indexMarkUnread (indexname, key, keyname) {","    if (Array.isArray(key)) {","      key.forEach(function (k) {","        indexMarkUnread(indexname, k, keyname)","      })","      return","    }","","    var index = state[indexname]","    var row = index.find(key, keyname)","    if (row) {","      var wasread = row.isread","      row.isread = false","      if (wasread)","        emit('index-change', { index: indexname })","      return true","    }","  }","","  api.markRead = function (key, cb) {","    awaitSync(function () {","      indexMarkRead('inbox', key)","      indexMarkRead('bookmarks', key)","      indexMarkRead('mentions', key)","      indexMarkRead('privatePosts', key)","      if (Array.isArray(key)) {","        db.isread.batch(key.map(function (k) { return { type: 'put', key: k, value: 1 }}), cb)","        key.forEach(function (key) { emit('isread', { key: key, value: true }) })","      } else {","        db.isread.put(key, 1, cb)","        emit('isread', { key: key, value: true })","      }","    })","  }","  api.markUnread = function (key, cb) {","    awaitSync(function () {","      indexMarkUnread('inbox', key)","      indexMarkUnread('bookmarks', key)","      indexMarkUnread('mentions', key)","      indexMarkUnread('privatePosts', key)","      if (Array.isArray(key)) {","        db.isread.batch(key.map(function (k) { return { type: 'del', key: k }}), cb)","        key.forEach(function (key) { emit('isread', { key: key, value: false }) })","      } else {","        db.isread.del(key, cb) ","        emit('isread', { key: key, value: false })","      }","    })","  }","  api.markAllRead = function (indexName, cb) {","    awaitSync(function () {","      var index = state[indexName]","      if (!index || index.name !== indexName)","        return cb(new Error('Invalid index'))","","      var done = multicb()","      index","        .filter(function (row) { return !row.isread })","        .forEach(function (row) { ","          var cb = done()","          threadlib.getPostThread(sbot, row.key, { isRead: true }, function (err, thread) {","            if (err)","              return cb()","            threadlib.markThreadRead(sbot, thread, cb)","          })","        })","      done(cb)","    })","  }","  api.toggleRead = function (key, cb) {","    api.isRead(key, function (err, v) {","      if (!v) {","        api.markRead(key, function (err) {","          cb(err, true)","        })","      } else {","        api.markUnread(key, function (err) {","          cb(err, false)","        })","      }","    })","  }","  api.isRead = function (key, cb) {","    if (Array.isArray(key)) {","      var done = multicb({ pluck: 1 })","      key.forEach(function (k, i) {","        var cb = done()","        db.isread.get(k, function (err, v) { cb(null, !!v) })","      })","      done(cb)","    } else {","      db.isread.get(key, function (err, v) {","        cb && cb(null, !!v)","      })","    }","  }"," ","  api.bookmark = function (key, cb) {","    sbot.get(key, function (err, value) {","      if (err) return cb(err)","      var done = multicb({ pluck: 1, spread: true })","      db.bookmarked.put(key, 1, done()) // update bookmarks index","      u.getThreadHasUnread(sbot, key, done()) // get the target thread's read/unread state","      done(function (err, putRes, hasUnread) {","        // insert into the bookmarks and inbox indexes","        var bookmarksRow = state.bookmarks.sortedUpsert(value.timestamp, key)","        bookmarksRow.isread = !hasUnread // set isread state","        emit('index-change', { index: 'bookmarks' })","        var inboxRow = state.inbox.sortedUpsert(value.timestamp, key)","        inboxRow.isread = !hasUnread // set isread state","        emit('index-change', { index: 'inbox' })","        cb(err, putRes)","      })","    })","  }","  api.unbookmark = function (key, cb) {","    sbot.get(key, function (err, value) {","      if (err) return cb(err)","      state.bookmarks.remove(key)","      state.inbox.remove(key)","      db.bookmarked.del(key, cb) ","    })","  }","  api.toggleBookmark = function (key, cb) {","    api.isBookmarked(key, function (err, v) {","      if (!v) {","        api.bookmark(key, function (err) {","          cb(err, true)","        })","      } else {","        api.unbookmark(key, function (err) {","          cb(err, false)","        })","      }","    })","  }","  api.isBookmarked = function (key, cb) {","    db.bookmarked.get(key, function (err, v) {","      cb && cb(null, !!v)","    })","  }","","  function getChannelIndex (channel) {","    var k = 'channel-'+channel","    var index = state[k]","    if (!index)","      index = state[k] = u.index(k)","    return index","  }","  api.getChannels = function (cb) {","    awaitSync(function () {","      var channels = []","      for (var k in state) {","        if (k.indexOf('channel-') === 0) {","          var lastUpdated = (state[k].rows[0]) ? state[k].rows[0].ts : 0","          channels.push({","            name: k.slice('channel-'.length),","            lastUpdated: lastUpdated,","            pinned: state[k].pinned,","            watched: state[k].watched","          })","        }","      }","      cb(null, channels)","    })","  }","  api.pinChannel = function (channel, cb) {","    var index = getChannelIndex(channel)","    index.pinned = true","    db.channelpinned.put(channel, 1, cb)","    emit('channelpinned', { channel: channel, value: true })","  }","  api.unpinChannel = function (channel, cb) {","    var index = getChannelIndex(channel)","    index.pinned = false","    db.channelpinned.del(channel, cb) ","    emit('channelpinned', { channel: channel, value: false })","  }","  api.toggleChannelPinned = function (channel, cb) {","    var index = getChannelIndex(channel)","    if (index.pinned) {","      api.unpinChannel(channel, function (err) {","        cb(err, true)","      })","    } else {","      api.pinChannel(channel, function (err) {","        cb(err, false)","      })","    }","  }","  api.watchChannel = function (channel, cb) {","    var index = getChannelIndex(channel)","    index.watched = true","    db.channelwatched.put(channel, 1, cb)","    emit('channelwatched', { channel: channel, value: true })","  }","  api.unwatchChannel = function (channel, cb) {","    var index = getChannelIndex(channel)","    index.watched = false","    db.channelwatched.del(channel, cb) ","    emit('channelwatched', { channel: channel, value: false })","  }","  api.toggleChannelWatched = function (channel, cb) {","    var index = getChannelIndex(channel)","    if (index.watched) {","      api.unwatchChannel(channel, function (err) {","        cb(err, true)","      })","    } else {","      api.watchChannel(channel, function (err) {","        cb(err, false)","      })","    }","  }","","  api.addFileToBlobs = function (base64Buff, cb) {","    return pull(","      pull.values([new Buffer(base64Buff, 'base64')]),","      sbot.blobs.add(cb)","    )","  }","  api.saveBlobToFile = function (hash, path, cb) {","    pull(","      sbot.blobs.get(hash),","      toPull.sink(fs.createWriteStream(path), cb)","    )","  }","","  var lookupcodeRegex = /(@[a-z0-9\\/\\+\\=]+\\.[a-z0-9]+)(?:\\[via\\])?(.+)?/i","  api.useLookupCode = function (code) {","    var eventPush = pushable()","","    // parse and validate the code","    var id, addrs","    var parts = lookupcodeRegex.exec(code)","    var valid = true","    if (parts) {","      id  = parts[1]","      addrs = (parts[2]) ? parts[2].split(',') : []","","      // validate id","      if (!ref.isFeedId(id))","        valid = false","","      // parse addresses","      addrs = addrs","        .map(function (addr) {","          addr = addr.split(':')","          if (addr.length === 3)","            return { host: addr[0], port: +addr[1], key: addr[2] }","        })","        .filter(Boolean)","    } else","      valid = false","","    if (!valid) {","      eventPush.push({ type: 'error', message: 'Invalid lookup code' })","      eventPush.end()","      return eventPush","    }","","    // begin the search!","    search(addrs.concat(sbot.gossip.peers()))","    function search (peers) {","      var peer = peers.pop()","      if (!peer)","        return eventPush.end()","","      // connect to the peer","      eventPush.push({ type: 'connecting', addr: peer })      ","      sbot.connect(peer, function (err, rpc) {","        if (err) {","          eventPush.push({ type: 'error', message: 'Failed to connect', err: err })","          return search(peers)","        }","        // try a sync","        sync(rpc, function (err, seq) { ","          if (seq > 0) {","            // success!","            eventPush.push({ type: 'finished', seq: seq })","            eventPush.end()","          } else","            search(peers) // try next","        })","      })","    }","","    function sync (rpc, cb) {","      // fetch the feed","      var seq","      eventPush.push({ type: 'syncing', id: id })","      pull(","        rpc.createHistoryStream({ id: id, keys: false }),","        pull.through(function (msg) {","          seq = msg.sequence","        }),","        sbot.createWriteStream(function (err) {","          cb(err, seq)","        })","      )","    }","","    return eventPush","  }","","  api.getProfile = function (id, cb) {","    awaitSync(function () { cb(null, state.profiles[id]) })","  }","  api.getAllProfiles = function (cb) {","    awaitSync(function () { cb(null, state.profiles) })","  }","  api.getNamesById = function (cb) {","    awaitSync(function () { cb(null, state.names) })","  }","  api.getIdsByName = function (cb) {","    awaitSync(function () { cb(null, state.ids) })","  }","  api.getName = function (id, cb) {","    awaitSync(function () { cb(null, state.names[id]) })","  }","  api.getActionItems = function (cb) {","    awaitSync(function () { cb(null, state.actionItems) })","  }","","  // helper to get an option off an opt function (avoids the `opt || {}` pattern)","  function o (opts, k, def) {","    return opts && opts[k] !== void 0 ? opts[k] : def","  }","","  // helper to get messages from an index","  function indexStreamFn (index, getkey) {","    return function (opts) {","      var lastAccessed = index.lastAccessed","      index.touch()","","      // emulate the `ssb.createFeedStream` interface","      var lt      = o(opts, 'lt')","      var lte     = o(opts, 'lte')","      var gt      = o(opts, 'gt')","      var gte     = o(opts, 'gte')","      var limit   = o(opts, 'limit')","      var threads = o(opts, 'threads')","      var unread  = o(opts, 'unread')","","      // lt, lte, gt, gte should look like:","      // [msg.value.timestamp, msg.value.author]","","      // helper to create emittable rows","      function lookup (row) {","        if (!row) return","        var key = (getkey) ? getkey(row) : row.key","        if (key) {","          var rowcopy = { key: key }","          for (var k in row) { // copy index attrs into rowcopy","            if (!rowcopy[k]) rowcopy[k] = row[k]","          }","          return rowcopy","        }","      }","","      // helper to fetch rows","      function fetch (row, cb) {","        if (threads) {","          threadlib.getPostSummary(sbot, row.key, { isBookmarked: true, isRead: true, votes: true, mentions: sbot.id }, function (err, thread) {","            for (var k in thread)","              row[k] = thread[k]","            cb(null, row)","          })","        } else {","          sbot.get(row.key, function (err, value) {","            // if (err) {","              // suppress this error","              // the message isnt in the local cache (yet)","              // but it got into the index, likely due to a link","              // instead of an error, we'll put a null there to indicate the gap","            // }","            row.value = value","            cb(null, row)","          })","        }","      }","","      // readstream","      var readPush = pushable()","      var read = pull(readPush, paramap(fetch))","","      // await sync, then emit the reads","      awaitSync(function () {","        var added = 0","        for (var i=0; i < index.rows.length; i++) {","          var row = index.rows[i]","","          if (limit && added >= limit)","            break","","          // we're going to only look at timestamp, because that's all that the index tracks","          var invalid = !!(","            (lt  && row.ts >= lt[0]) ||","            (lte && row.ts > lte[0]) ||","            (gt  && row.ts <= gt[0]) ||","            (gte && row.ts < gte[0]) ||","            (unread && row.isread)","          )","          if (invalid)","            continue","","          var r = lookup(row)","          if (r) {","            r.isNew = r.ts > lastAccessed","            readPush.push(r)","            added++","          }","        }","        readPush.end()","      })","","      if (opts && opts.live) {","        // live stream, concat the live-emitter on the end","        index.on('add', onadd)","        var livePush = pushable(function () { index.removeListener('add', onadd) })","        function onadd (row) { livePush.push(lookup(row)) }","        var live = pull(livePush, paramap(fetch))","        return cat([read, live])","      }","      return read","    }","  }","","  return api","}"],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"16":1,"17":1,"18":1,"19":1,"21":1,"23":0,"24":0,"25":0,"31":0,"54":0,"55":1,"56":0,"57":0,"58":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"70":0,"74":0,"75":0,"76":0,"77":0,"78":1,"79":0,"84":0,"86":0,"87":0,"90":0,"91":0,"92":0,"100":0,"103":0,"104":0,"105":0,"111":0,"112":0,"115":0,"116":0,"117":0,"120":0,"124":0,"125":0,"126":0,"128":0,"129":0,"130":1,"131":0,"133":0,"134":0,"135":0,"137":0,"142":0,"143":1,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"156":0,"161":0,"162":0,"165":0,"166":0,"167":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"180":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"196":0,"197":0,"198":0,"200":0,"201":0,"203":0,"204":0,"208":0,"212":0,"218":1,"219":0,"220":0,"221":0,"223":0,"226":0,"227":0,"228":0,"229":0,"230":0,"231":0,"232":0,"233":0,"237":1,"238":0,"239":0,"240":0,"242":0,"245":0,"246":0,"247":0,"248":0,"249":0,"250":0,"251":0,"252":0,"256":0,"257":0,"258":0,"259":0,"260":0,"261":0,"262":0,"263":0,"264":0,"266":0,"267":0,"271":0,"272":0,"273":0,"274":0,"275":0,"276":0,"277":0,"278":0,"279":0,"281":0,"282":0,"286":0,"287":0,"288":0,"289":0,"290":0,"292":0,"293":0,"294":0,"296":0,"297":0,"298":0,"299":0,"300":0,"303":0,"306":0,"307":0,"308":0,"309":0,"310":0,"313":0,"314":0,"319":0,"320":0,"321":0,"322":0,"323":0,"324":0,"326":0,"328":0,"329":0,"334":0,"335":0,"336":0,"337":0,"338":0,"339":0,"340":0,"342":0,"343":0,"344":0,"345":0,"346":0,"347":0,"348":0,"352":0,"353":0,"354":0,"355":0,"356":0,"357":0,"360":0,"361":0,"362":0,"363":0,"364":0,"367":0,"368":0,"373":0,"374":0,"375":0,"379":1,"380":0,"381":0,"382":0,"383":0,"384":0,"386":0,"387":0,"388":0,"389":0,"390":0,"391":0,"392":0,"400":0,"403":0,"404":0,"405":0,"406":0,"407":0,"409":0,"410":0,"411":0,"412":0,"413":0,"415":0,"416":0,"417":0,"418":0,"419":0,"422":0,"423":0,"427":0,"428":0,"429":0,"430":0,"431":0,"433":0,"434":0,"435":0,"436":0,"437":0,"439":0,"440":0,"441":0,"442":0,"443":0,"446":0,"447":0,"452":0,"453":0,"458":0,"459":0,"465":0,"466":0,"467":0,"470":0,"471":0,"472":0,"473":0,"474":0,"475":0,"478":0,"479":0,"482":0,"484":0,"485":0,"486":0,"490":0,"492":0,"493":0,"494":0,"495":0,"499":0,"500":1,"501":0,"502":0,"503":0,"506":0,"507":0,"508":0,"509":0,"510":0,"513":0,"514":0,"516":0,"517":0,"519":0,"524":1,"526":0,"527":0,"528":0,"531":0,"534":0,"539":0,"542":0,"543":0,"545":0,"546":0,"548":0,"549":0,"551":0,"552":0,"554":0,"555":0,"557":0,"558":0,"562":1,"563":0,"567":1,"568":0,"569":0,"570":0,"573":0,"574":0,"575":0,"576":0,"577":0,"578":0,"579":0,"585":1,"586":0,"587":0,"588":0,"589":0,"590":0,"591":0,"593":0,"598":1,"599":0,"600":0,"601":0,"602":0,"603":0,"606":0,"613":0,"614":0,"620":0,"621":0,"624":0,"625":0,"626":0,"627":0,"629":0,"630":0,"633":0,"640":0,"641":0,"643":0,"644":0,"645":0,"646":0,"647":0,"650":0,"653":0,"655":0,"656":0,"657":1,"658":0,"659":0,"661":0,"665":0}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/api/util.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/api/util.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":1,"64":0,"65":0,"66":0,"67":0,"68":1,"69":0,"70":0,"71":0,"72":0,"73":1,"74":0,"75":0,"76":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"fnMap":{"1":{"name":"(anonymous_1)","line":9,"loc":{"start":{"line":9,"column":23},"end":{"line":9,"column":39}}},"2":{"name":"(anonymous_2)","line":15,"loc":{"start":{"line":15,"column":16},"end":{"line":15,"column":28}}},"3":{"name":"(anonymous_3)","line":19,"loc":{"start":{"line":19,"column":23},"end":{"line":19,"column":42}}},"4":{"name":"(anonymous_4)","line":35,"loc":{"start":{"line":35,"column":23},"end":{"line":35,"column":42}}},"5":{"name":"(anonymous_5)","line":53,"loc":{"start":{"line":53,"column":23},"end":{"line":53,"column":42}}},"6":{"name":"(anonymous_6)","line":62,"loc":{"start":{"line":62,"column":17},"end":{"line":62,"column":41}}},"7":{"name":"(anonymous_7)","line":68,"loc":{"start":{"line":68,"column":18},"end":{"line":68,"column":42}}},"8":{"name":"(anonymous_8)","line":77,"loc":{"start":{"line":77,"column":15},"end":{"line":77,"column":39}}},"9":{"name":"(anonymous_9)","line":84,"loc":{"start":{"line":84,"column":19},"end":{"line":84,"column":34}}},"10":{"name":"(anonymous_10)","line":91,"loc":{"start":{"line":91,"column":25},"end":{"line":91,"column":37}}},"11":{"name":"timestampIsRecent","line":100,"loc":{"start":{"line":100,"column":2},"end":{"line":100,"column":34}}},"12":{"name":"(anonymous_12)","line":109,"loc":{"start":{"line":109,"column":36},"end":{"line":109,"column":61}}},"13":{"name":"(anonymous_13)","line":110,"loc":{"start":{"line":110,"column":62},"end":{"line":110,"column":85}}},"14":{"name":"(anonymous_14)","line":116,"loc":{"start":{"line":116,"column":26},"end":{"line":116,"column":47}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":30}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":32}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":49}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":44}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":38}},"6":{"start":{"line":9,"column":0},"end":{"line":107,"column":1}},"7":{"start":{"line":10,"column":2},"end":{"line":10,"column":32}},"8":{"start":{"line":11,"column":2},"end":{"line":11,"column":19}},"9":{"start":{"line":12,"column":2},"end":{"line":12,"column":17}},"10":{"start":{"line":13,"column":2},"end":{"line":13,"column":33}},"11":{"start":{"line":15,"column":2},"end":{"line":17,"column":3}},"12":{"start":{"line":16,"column":4},"end":{"line":16,"column":35}},"13":{"start":{"line":19,"column":2},"end":{"line":33,"column":3}},"14":{"start":{"line":20,"column":4},"end":{"line":20,"column":65}},"15":{"start":{"line":21,"column":4},"end":{"line":28,"column":5}},"16":{"start":{"line":22,"column":6},"end":{"line":27,"column":7}},"17":{"start":{"line":23,"column":8},"end":{"line":23,"column":36}},"18":{"start":{"line":24,"column":8},"end":{"line":25,"column":32}},"19":{"start":{"line":25,"column":10},"end":{"line":25,"column":32}},"20":{"start":{"line":26,"column":8},"end":{"line":26,"column":18}},"21":{"start":{"line":29,"column":4},"end":{"line":29,"column":24}},"22":{"start":{"line":30,"column":4},"end":{"line":31,"column":28}},"23":{"start":{"line":31,"column":6},"end":{"line":31,"column":28}},"24":{"start":{"line":32,"column":4},"end":{"line":32,"column":14}},"25":{"start":{"line":35,"column":2},"end":{"line":51,"column":3}},"26":{"start":{"line":36,"column":4},"end":{"line":36,"column":30}},"27":{"start":{"line":37,"column":4},"end":{"line":50,"column":5}},"28":{"start":{"line":39,"column":6},"end":{"line":49,"column":28}},"29":{"start":{"line":40,"column":8},"end":{"line":40,"column":31}},"30":{"start":{"line":42,"column":8},"end":{"line":42,"column":31}},"31":{"start":{"line":44,"column":8},"end":{"line":44,"column":19}},"32":{"start":{"line":46,"column":8},"end":{"line":46,"column":31}},"33":{"start":{"line":47,"column":8},"end":{"line":47,"column":18}},"34":{"start":{"line":49,"column":8},"end":{"line":49,"column":28}},"35":{"start":{"line":53,"column":2},"end":{"line":60,"column":3}},"36":{"start":{"line":54,"column":4},"end":{"line":54,"column":41}},"37":{"start":{"line":55,"column":4},"end":{"line":58,"column":5}},"38":{"start":{"line":57,"column":6},"end":{"line":57,"column":39}},"39":{"start":{"line":59,"column":4},"end":{"line":59,"column":14}},"40":{"start":{"line":62,"column":2},"end":{"line":66,"column":3}},"41":{"start":{"line":63,"column":4},"end":{"line":63,"column":39}},"42":{"start":{"line":64,"column":4},"end":{"line":65,"column":29}},"43":{"start":{"line":65,"column":6},"end":{"line":65,"column":29}},"44":{"start":{"line":68,"column":2},"end":{"line":75,"column":3}},"45":{"start":{"line":69,"column":4},"end":{"line":69,"column":30}},"46":{"start":{"line":70,"column":4},"end":{"line":73,"column":5}},"47":{"start":{"line":71,"column":6},"end":{"line":72,"column":16}},"48":{"start":{"line":72,"column":8},"end":{"line":72,"column":16}},"49":{"start":{"line":74,"column":4},"end":{"line":74,"column":13}},"50":{"start":{"line":77,"column":2},"end":{"line":82,"column":3}},"51":{"start":{"line":78,"column":4},"end":{"line":78,"column":39}},"52":{"start":{"line":79,"column":4},"end":{"line":80,"column":26}},"53":{"start":{"line":80,"column":6},"end":{"line":80,"column":26}},"54":{"start":{"line":81,"column":4},"end":{"line":81,"column":15}},"55":{"start":{"line":84,"column":2},"end":{"line":86,"column":3}},"56":{"start":{"line":85,"column":4},"end":{"line":85,"column":43}},"57":{"start":{"line":88,"column":2},"end":{"line":88,"column":51}},"58":{"start":{"line":91,"column":2},"end":{"line":98,"column":3}},"59":{"start":{"line":93,"column":4},"end":{"line":96,"column":5}},"60":{"start":{"line":94,"column":6},"end":{"line":95,"column":16}},"61":{"start":{"line":95,"column":8},"end":{"line":95,"column":16}},"62":{"start":{"line":97,"column":4},"end":{"line":97,"column":12}},"63":{"start":{"line":100,"column":2},"end":{"line":104,"column":3}},"64":{"start":{"line":101,"column":4},"end":{"line":101,"column":24}},"65":{"start":{"line":102,"column":4},"end":{"line":102,"column":34}},"66":{"start":{"line":103,"column":4},"end":{"line":103,"column":34}},"67":{"start":{"line":106,"column":2},"end":{"line":106,"column":14}},"68":{"start":{"line":109,"column":0},"end":{"line":114,"column":1}},"69":{"start":{"line":110,"column":2},"end":{"line":113,"column":4}},"70":{"start":{"line":111,"column":4},"end":{"line":111,"column":27}},"71":{"start":{"line":111,"column":13},"end":{"line":111,"column":27}},"72":{"start":{"line":112,"column":4},"end":{"line":112,"column":29}},"73":{"start":{"line":116,"column":0},"end":{"line":121,"column":1}},"74":{"start":{"line":117,"column":2},"end":{"line":120,"column":3}},"75":{"start":{"line":118,"column":4},"end":{"line":119,"column":21}},"76":{"start":{"line":119,"column":6},"end":{"line":119,"column":21}}},"branchMap":{"1":{"line":20,"type":"cond-expr","locations":[{"start":{"line":20,"column":40},"end":{"line":20,"column":42}},{"start":{"line":20,"column":45},"end":{"line":20,"column":65}}]},"2":{"line":22,"type":"if","locations":[{"start":{"line":22,"column":6},"end":{"line":22,"column":6}},{"start":{"line":22,"column":6},"end":{"line":22,"column":6}}]},"3":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":8},"end":{"line":24,"column":8}},{"start":{"line":24,"column":8},"end":{"line":24,"column":8}}]},"4":{"line":30,"type":"if","locations":[{"start":{"line":30,"column":4},"end":{"line":30,"column":4}},{"start":{"line":30,"column":4},"end":{"line":30,"column":4}}]},"5":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":4},"end":{"line":37,"column":4}},{"start":{"line":37,"column":4},"end":{"line":37,"column":4}}]},"6":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":6},"end":{"line":39,"column":6}},{"start":{"line":39,"column":6},"end":{"line":39,"column":6}}]},"7":{"line":55,"type":"if","locations":[{"start":{"line":55,"column":4},"end":{"line":55,"column":4}},{"start":{"line":55,"column":4},"end":{"line":55,"column":4}}]},"8":{"line":64,"type":"if","locations":[{"start":{"line":64,"column":4},"end":{"line":64,"column":4}},{"start":{"line":64,"column":4},"end":{"line":64,"column":4}}]},"9":{"line":69,"type":"binary-expr","locations":[{"start":{"line":69,"column":14},"end":{"line":69,"column":21}},{"start":{"line":69,"column":25},"end":{"line":69,"column":30}}]},"10":{"line":71,"type":"if","locations":[{"start":{"line":71,"column":6},"end":{"line":71,"column":6}},{"start":{"line":71,"column":6},"end":{"line":71,"column":6}}]},"11":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":4},"end":{"line":79,"column":4}},{"start":{"line":79,"column":4},"end":{"line":79,"column":4}}]},"12":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":6},"end":{"line":94,"column":6}},{"start":{"line":94,"column":6},"end":{"line":94,"column":6}}]},"13":{"line":111,"type":"if","locations":[{"start":{"line":111,"column":4},"end":{"line":111,"column":4}},{"start":{"line":111,"column":4},"end":{"line":111,"column":4}}]},"14":{"line":117,"type":"cond-expr","locations":[{"start":{"line":117,"column":29},"end":{"line":117,"column":41}},{"start":{"line":117,"column":44},"end":{"line":117,"column":45}}]},"15":{"line":118,"type":"if","locations":[{"start":{"line":118,"column":4},"end":{"line":118,"column":4}},{"start":{"line":118,"column":4},"end":{"line":118,"column":4}}]}},"code":["var mlib = require('ssb-msgs')","var multicb = require('multicb')","var EventEmitter = require('events').EventEmitter","var threadlib = require('patchwork-threads')","","// constant used to decide if an index-entry was recent enough to emit an 'add' event for","var IS_RECENT_MAX = 1e3 * 60 * 60 * 48 // 2 days","","module.exports.index = function (name) {","  var index = new EventEmitter()","  index.name = name","  index.rows = []","  index.lastAccessed = Date.now()","","  index.touch = function () {","    index.lastAccessed = Date.now()","  }","","  index.sortedInsert = function (ts, key) {","    var row = (typeof ts == 'object') ? ts : { ts: ts, key: key }","    for (var i=0; i < index.rows.length; i++) {","      if (index.rows[i].ts < row.ts) {","        index.rows.splice(i, 0, row)","        if (timestampIsRecent(row.ts))","          index.emit('add', row)","        return row","      }","    }","    index.rows.push(row)","    if (timestampIsRecent(row.ts))","      index.emit('add', row)","    return row","  }","","  index.sortedUpdate = function (ts, key) {","    var i = index.indexOf(key)","    if (i !== -1) {","      // readd to index at new TS","      if (index.rows[i].ts < ts) {","        var row = index.rows[i]","        // remove from old position","        index.rows.splice(i, 1)","        // update values","        row.ts = ts","        // reinsert","        index.sortedInsert(row)","        return row","      } else","        return index.rows[i]","    }","  }","","  index.sortedUpsert = function (ts, key) {","    var row = index.sortedUpdate(ts, key)","    if (!row) {","      // add to index","      row = index.sortedInsert(ts, key)","    }","    return row","  }","","  index.remove = function (key, keyname) {","    var i = index.indexOf(key, keyname)","    if (i !== -1)","      index.rows.splice(i, 1)","  }","","  index.indexOf = function (key, keyname) {","    keyname = keyname || 'key'","    for (var i=0; i < index.rows.length; i++) {","      if (index.rows[i][keyname] === key)","        return i","    }","    return -1","  }","","  index.find = function (key, keyname) {","    var i = index.indexOf(key, keyname)","    if (i !== -1)","      return index.rows[i]","    return null","  }","","  index.contains = function (key) {","    return index.indexOf(index, key) !== -1","  }","","  index.filter = index.rows.filter.bind(index.rows)","","  // helper to count # of messages that are new","  index.countUntouched = function () {","    // iterate until we find a ts older than lastAccessed, then return that #","    for (var i=0; i < index.rows.length; i++) {","      if (index.rows[i].ts < index.lastAccessed)","        return i","    }","    return 0","  }","","  function timestampIsRecent (ts) {","    var now = Date.now()","    var delta = Math.abs(now - ts)","    return (delta < IS_RECENT_MAX)","  }","","  return index","}","","module.exports.getThreadHasUnread = function (sbot, msg, cb) {","  threadlib.getParentPostSummary(sbot, msg, { isRead: true }, function (err, thread) {","    if (err) return cb(err)","    cb(err, thread.hasUnread)","  })","}","","module.exports.findLink = function (links, id) {","  for (var i=0; i < (links ? links.length : 0); i++) {","    if (links[i].link === id)","      return links[i]","  }","}"],"l":{"1":1,"2":1,"3":1,"4":1,"7":1,"9":1,"10":0,"11":0,"12":0,"13":0,"15":0,"16":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"29":0,"30":0,"31":0,"32":0,"35":0,"36":0,"37":0,"39":0,"40":0,"42":0,"44":0,"46":0,"47":0,"49":0,"53":0,"54":0,"55":0,"57":0,"59":0,"62":0,"63":0,"64":0,"65":0,"68":0,"69":0,"70":0,"71":0,"72":0,"74":0,"77":0,"78":0,"79":0,"80":0,"81":0,"84":0,"85":0,"88":0,"91":0,"93":0,"94":0,"95":0,"97":0,"100":1,"101":0,"102":0,"103":0,"106":0,"109":1,"110":0,"111":0,"112":0,"116":1,"117":0,"118":0,"119":0}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/api/manifest.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/api/manifest.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":46,"column":1}}},"branchMap":{},"code":["module.exports = {","  createEventStream: 'source',","","  getIndexCounts: 'async',","  createInboxStream: 'source',","  createBookmarkStream: 'source',","  createMentionStream: 'source',","  createNoticeStream: 'source',","  createPrivatePostStream: 'source',","  createPublicPostStream: 'source',","  createChannelStream: 'source',","  createSearchStream: 'source',","","  markRead: 'async',","  markUnread: 'async',","  markAllRead: 'async',","  toggleRead: 'async',","  isRead: 'async',","","  bookmark: 'async',","  unbookmark: 'async',","  toggleBookmark: 'async',","  isBookmarked: 'async',","","  getChannels: 'async',","  pinChannel: 'async',","  unpinChannel: 'async',","  toggleChannelPinned: 'async',","  watchChannel: 'async',","  unwatchChannel: 'async',","  toggleChannelWatched: 'async',","","  addFileToBlobs: 'async',","  saveBlobToFile: 'async',","","  useLookupCode: 'source',","","  getMyProfile: 'async',","  getProfile: 'async',","  getAllProfiles: 'async',","","  getNamesById: 'async',","  getIdsByName: 'async',","  getName: 'async',","  getActionItems: 'async'","}"],"l":{"1":1}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/api/permissions.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/api/permissions.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":76}}},"branchMap":{},"code":["module.exports = { anonymous: { allow: [] } } // allow nothing unless master"],"l":{"1":1}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/api/processor.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/api/processor.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":1,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":1,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":1,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":1,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":1,"177":0,"178":0,"179":0,"180":0,"181":0,"182":1,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":1,"194":0,"195":0,"196":0,"197":0,"198":0,"199":1,"200":0,"201":0,"202":0,"203":0,"204":0,"205":1,"206":0,"207":1,"208":0,"209":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"216":0,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"223":0,"224":0,"225":1,"226":0,"227":1,"228":1,"229":0,"230":0,"231":0,"232":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0,0],"28":[0,0],"29":[0,0],"30":[0,0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0],"52":[0,0],"53":[0,0],"54":[0,0],"55":[0,0],"56":[0,0],"57":[0,0],"58":[0,0],"59":[0,0],"60":[0,0],"61":[0,0],"62":[0,0],"63":[0,0],"64":[0,0],"65":[0,0],"66":[0,0],"67":[0,0],"68":[0,0],"69":[0,0],"70":[0,0],"71":[0,0],"72":[0,0],"73":[0,0],"74":[0,0],"75":[0,0],"76":[0,0],"77":[0,0],"78":[0,0],"79":[0,0],"80":[0,0],"81":[0,0],"82":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0},"fnMap":{"1":{"name":"(anonymous_1)","line":4,"loc":{"start":{"line":4,"column":17},"end":{"line":4,"column":50}}},"2":{"name":"(anonymous_2)","line":7,"loc":{"start":{"line":7,"column":10},"end":{"line":7,"column":25}}},"3":{"name":"(anonymous_3)","line":104,"loc":{"start":{"line":104,"column":13},"end":{"line":104,"column":28}}},"4":{"name":"(anonymous_4)","line":105,"loc":{"start":{"line":105,"column":60},"end":{"line":105,"column":76}}},"5":{"name":"(anonymous_5)","line":119,"loc":{"start":{"line":119,"column":11},"end":{"line":119,"column":26}}},"6":{"name":"(anonymous_6)","line":121,"loc":{"start":{"line":121,"column":58},"end":{"line":121,"column":74}}},"7":{"name":"(anonymous_7)","line":128,"loc":{"start":{"line":128,"column":10},"end":{"line":128,"column":25}}},"8":{"name":"getProfile","line":148,"loc":{"start":{"line":148,"column":2},"end":{"line":148,"column":28}}},"9":{"name":"updateSelfContact","line":167,"loc":{"start":{"line":167,"column":2},"end":{"line":167,"column":43}}},"10":{"name":"(anonymous_10)","line":177,"loc":{"start":{"line":177,"column":55},"end":{"line":177,"column":69}}},"11":{"name":"(anonymous_11)","line":194,"loc":{"start":{"line":194,"column":61},"end":{"line":194,"column":75}}},"12":{"name":"updateOtherContact","line":208,"loc":{"start":{"line":208,"column":2},"end":{"line":208,"column":52}}},"13":{"name":"(anonymous_13)","line":219,"loc":{"start":{"line":219,"column":55},"end":{"line":219,"column":69}}},"14":{"name":"(anonymous_14)","line":237,"loc":{"start":{"line":237,"column":61},"end":{"line":237,"column":75}}},"15":{"name":"rebuildNamesFor","line":262,"loc":{"start":{"line":262,"column":2},"end":{"line":262,"column":37}}},"16":{"name":"attachIsRead","line":320,"loc":{"start":{"line":320,"column":2},"end":{"line":320,"column":40}}},"17":{"name":"(anonymous_17)","line":323,"loc":{"start":{"line":323,"column":23},"end":{"line":323,"column":41}}},"18":{"name":"attachChildIsRead","line":330,"loc":{"start":{"line":330,"column":2},"end":{"line":330,"column":54}}},"19":{"name":"(anonymous_19)","line":335,"loc":{"start":{"line":335,"column":28},"end":{"line":335,"column":46}}},"20":{"name":"(anonymous_20)","line":344,"loc":{"start":{"line":344,"column":34},"end":{"line":344,"column":52}}},"21":{"name":"next","line":350,"loc":{"start":{"line":350,"column":4},"end":{"line":350,"column":21}}},"22":{"name":"follows","line":363,"loc":{"start":{"line":363,"column":2},"end":{"line":363,"column":26}}},"23":{"name":"ts","line":372,"loc":{"start":{"line":372,"column":2},"end":{"line":372,"column":20}}},"24":{"name":"fn","line":378,"loc":{"start":{"line":378,"column":2},"end":{"line":378,"column":23}}},"25":{"name":"(anonymous_25)","line":381,"loc":{"start":{"line":381,"column":27},"end":{"line":381,"column":49}}},"26":{"name":"nonEmptyStr","line":411,"loc":{"start":{"line":411,"column":0},"end":{"line":411,"column":27}}},"27":{"name":"makeNameSafe","line":417,"loc":{"start":{"line":417,"column":0},"end":{"line":417,"column":28}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":30}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":25}},"3":{"start":{"line":4,"column":0},"end":{"line":409,"column":1}},"4":{"start":{"line":6,"column":2},"end":{"line":146,"column":3}},"5":{"start":{"line":8,"column":6},"end":{"line":8,"column":34}},"6":{"start":{"line":9,"column":6},"end":{"line":9,"column":35}},"7":{"start":{"line":10,"column":6},"end":{"line":10,"column":38}},"8":{"start":{"line":11,"column":6},"end":{"line":11,"column":31}},"9":{"start":{"line":12,"column":6},"end":{"line":12,"column":41}},"10":{"start":{"line":13,"column":6},"end":{"line":13,"column":37}},"11":{"start":{"line":14,"column":6},"end":{"line":14,"column":43}},"12":{"start":{"line":18,"column":6},"end":{"line":18,"column":18}},"13":{"start":{"line":19,"column":6},"end":{"line":38,"column":7}},"14":{"start":{"line":21,"column":8},"end":{"line":22,"column":70}},"15":{"start":{"line":22,"column":10},"end":{"line":22,"column":70}},"16":{"start":{"line":23,"column":8},"end":{"line":26,"column":9}},"17":{"start":{"line":25,"column":10},"end":{"line":25,"column":68}},"18":{"start":{"line":27,"column":8},"end":{"line":27,"column":48}},"19":{"start":{"line":28,"column":8},"end":{"line":28,"column":44}},"20":{"start":{"line":31,"column":11},"end":{"line":38,"column":7}},"21":{"start":{"line":32,"column":8},"end":{"line":32,"column":46}},"22":{"start":{"line":33,"column":8},"end":{"line":37,"column":9}},"23":{"start":{"line":34,"column":10},"end":{"line":34,"column":59}},"24":{"start":{"line":35,"column":10},"end":{"line":35,"column":50}},"25":{"start":{"line":36,"column":10},"end":{"line":36,"column":46}},"26":{"start":{"line":43,"column":6},"end":{"line":43,"column":21}},"27":{"start":{"line":44,"column":6},"end":{"line":73,"column":7}},"28":{"start":{"line":45,"column":8},"end":{"line":45,"column":27}},"29":{"start":{"line":47,"column":8},"end":{"line":60,"column":9}},"30":{"start":{"line":48,"column":10},"end":{"line":48,"column":62}},"31":{"start":{"line":49,"column":10},"end":{"line":53,"column":11}},"32":{"start":{"line":50,"column":12},"end":{"line":50,"column":63}},"33":{"start":{"line":51,"column":12},"end":{"line":51,"column":59}},"34":{"start":{"line":52,"column":12},"end":{"line":52,"column":55}},"35":{"start":{"line":56,"column":13},"end":{"line":60,"column":9}},"36":{"start":{"line":57,"column":10},"end":{"line":57,"column":96}},"37":{"start":{"line":58,"column":10},"end":{"line":58,"column":57}},"38":{"start":{"line":59,"column":10},"end":{"line":59,"column":53}},"39":{"start":{"line":63,"column":11},"end":{"line":73,"column":7}},"40":{"start":{"line":64,"column":8},"end":{"line":64,"column":56}},"41":{"start":{"line":65,"column":8},"end":{"line":65,"column":52}},"42":{"start":{"line":66,"column":8},"end":{"line":66,"column":47}},"43":{"start":{"line":69,"column":11},"end":{"line":73,"column":7}},"44":{"start":{"line":70,"column":8},"end":{"line":70,"column":89}},"45":{"start":{"line":71,"column":8},"end":{"line":71,"column":51}},"46":{"start":{"line":72,"column":8},"end":{"line":72,"column":46}},"47":{"start":{"line":76,"column":6},"end":{"line":79,"column":7}},"48":{"start":{"line":77,"column":8},"end":{"line":77,"column":75}},"49":{"start":{"line":78,"column":8},"end":{"line":78,"column":54}},"50":{"start":{"line":81,"column":6},"end":{"line":101,"column":7}},"51":{"start":{"line":83,"column":8},"end":{"line":83,"column":44}},"52":{"start":{"line":84,"column":8},"end":{"line":84,"column":79}},"53":{"start":{"line":85,"column":8},"end":{"line":85,"column":75}},"54":{"start":{"line":86,"column":8},"end":{"line":86,"column":50}},"55":{"start":{"line":89,"column":8},"end":{"line":100,"column":9}},"56":{"start":{"line":90,"column":10},"end":{"line":90,"column":22}},"57":{"start":{"line":91,"column":10},"end":{"line":95,"column":65}},"58":{"start":{"line":93,"column":12},"end":{"line":93,"column":67}},"59":{"start":{"line":95,"column":12},"end":{"line":95,"column":65}},"60":{"start":{"line":96,"column":10},"end":{"line":99,"column":11}},"61":{"start":{"line":97,"column":12},"end":{"line":97,"column":52}},"62":{"start":{"line":98,"column":12},"end":{"line":98,"column":48}},"63":{"start":{"line":105,"column":6},"end":{"line":116,"column":8}},"64":{"start":{"line":107,"column":8},"end":{"line":107,"column":51}},"65":{"start":{"line":108,"column":8},"end":{"line":109,"column":72}},"66":{"start":{"line":108,"column":20},"end":{"line":108,"column":60}},"67":{"start":{"line":109,"column":20},"end":{"line":109,"column":72}},"68":{"start":{"line":112,"column":8},"end":{"line":115,"column":9}},"69":{"start":{"line":113,"column":10},"end":{"line":113,"column":54}},"70":{"start":{"line":114,"column":10},"end":{"line":114,"column":52}},"71":{"start":{"line":121,"column":6},"end":{"line":125,"column":8}},"72":{"start":{"line":122,"column":8},"end":{"line":122,"column":51}},"73":{"start":{"line":123,"column":8},"end":{"line":124,"column":72}},"74":{"start":{"line":123,"column":20},"end":{"line":123,"column":60}},"75":{"start":{"line":124,"column":20},"end":{"line":124,"column":72}},"76":{"start":{"line":130,"column":6},"end":{"line":130,"column":60}},"77":{"start":{"line":131,"column":6},"end":{"line":134,"column":7}},"78":{"start":{"line":132,"column":8},"end":{"line":132,"column":52}},"79":{"start":{"line":133,"column":8},"end":{"line":133,"column":50}},"80":{"start":{"line":137,"column":6},"end":{"line":137,"column":62}},"81":{"start":{"line":138,"column":6},"end":{"line":144,"column":7}},"82":{"start":{"line":139,"column":8},"end":{"line":139,"column":46}},"83":{"start":{"line":140,"column":8},"end":{"line":143,"column":50}},"84":{"start":{"line":141,"column":10},"end":{"line":141,"column":90}},"85":{"start":{"line":143,"column":10},"end":{"line":143,"column":50}},"86":{"start":{"line":148,"column":2},"end":{"line":165,"column":3}},"87":{"start":{"line":149,"column":4},"end":{"line":150,"column":16}},"88":{"start":{"line":150,"column":6},"end":{"line":150,"column":16}},"89":{"start":{"line":152,"column":4},"end":{"line":152,"column":37}},"90":{"start":{"line":153,"column":4},"end":{"line":163,"column":5}},"91":{"start":{"line":154,"column":6},"end":{"line":162,"column":7}},"92":{"start":{"line":164,"column":4},"end":{"line":164,"column":18}},"93":{"start":{"line":167,"column":2},"end":{"line":206,"column":3}},"94":{"start":{"line":168,"column":4},"end":{"line":168,"column":29}},"95":{"start":{"line":169,"column":4},"end":{"line":169,"column":31}},"96":{"start":{"line":172,"column":4},"end":{"line":186,"column":5}},"97":{"start":{"line":173,"column":6},"end":{"line":173,"column":41}},"98":{"start":{"line":176,"column":6},"end":{"line":180,"column":7}},"99":{"start":{"line":177,"column":8},"end":{"line":177,"column":97}},"100":{"start":{"line":177,"column":71},"end":{"line":177,"column":95}},"101":{"start":{"line":178,"column":8},"end":{"line":179,"column":35}},"102":{"start":{"line":179,"column":10},"end":{"line":179,"column":35}},"103":{"start":{"line":183,"column":6},"end":{"line":183,"column":33}},"104":{"start":{"line":184,"column":6},"end":{"line":184,"column":77}},"105":{"start":{"line":185,"column":6},"end":{"line":185,"column":29}},"106":{"start":{"line":189,"column":4},"end":{"line":205,"column":5}},"107":{"start":{"line":190,"column":6},"end":{"line":190,"column":48}},"108":{"start":{"line":191,"column":6},"end":{"line":204,"column":7}},"109":{"start":{"line":193,"column":8},"end":{"line":197,"column":9}},"110":{"start":{"line":194,"column":10},"end":{"line":194,"column":103}},"111":{"start":{"line":194,"column":77},"end":{"line":194,"column":101}},"112":{"start":{"line":195,"column":10},"end":{"line":196,"column":39}},"113":{"start":{"line":196,"column":12},"end":{"line":196,"column":39}},"114":{"start":{"line":200,"column":8},"end":{"line":200,"column":37}},"115":{"start":{"line":201,"column":8},"end":{"line":202,"column":39}},"116":{"start":{"line":202,"column":10},"end":{"line":202,"column":39}},"117":{"start":{"line":203,"column":8},"end":{"line":203,"column":93}},"118":{"start":{"line":208,"column":2},"end":{"line":260,"column":3}},"119":{"start":{"line":209,"column":4},"end":{"line":209,"column":29}},"120":{"start":{"line":210,"column":4},"end":{"line":210,"column":31}},"121":{"start":{"line":211,"column":4},"end":{"line":211,"column":31}},"122":{"start":{"line":214,"column":4},"end":{"line":229,"column":5}},"123":{"start":{"line":215,"column":6},"end":{"line":215,"column":41}},"124":{"start":{"line":218,"column":6},"end":{"line":222,"column":7}},"125":{"start":{"line":219,"column":8},"end":{"line":219,"column":97}},"126":{"start":{"line":219,"column":71},"end":{"line":219,"column":95}},"127":{"start":{"line":220,"column":8},"end":{"line":221,"column":35}},"128":{"start":{"line":221,"column":10},"end":{"line":221,"column":35}},"129":{"start":{"line":225,"column":6},"end":{"line":225,"column":77}},"130":{"start":{"line":226,"column":6},"end":{"line":227,"column":35}},"131":{"start":{"line":227,"column":8},"end":{"line":227,"column":35}},"132":{"start":{"line":228,"column":6},"end":{"line":228,"column":29}},"133":{"start":{"line":232,"column":4},"end":{"line":247,"column":5}},"134":{"start":{"line":233,"column":6},"end":{"line":233,"column":48}},"135":{"start":{"line":234,"column":6},"end":{"line":246,"column":7}},"136":{"start":{"line":236,"column":8},"end":{"line":240,"column":9}},"137":{"start":{"line":237,"column":10},"end":{"line":237,"column":103}},"138":{"start":{"line":237,"column":77},"end":{"line":237,"column":101}},"139":{"start":{"line":238,"column":10},"end":{"line":239,"column":39}},"140":{"start":{"line":239,"column":12},"end":{"line":239,"column":39}},"141":{"start":{"line":243,"column":8},"end":{"line":243,"column":93}},"142":{"start":{"line":244,"column":8},"end":{"line":245,"column":39}},"143":{"start":{"line":245,"column":10},"end":{"line":245,"column":39}},"144":{"start":{"line":250,"column":4},"end":{"line":259,"column":5}},"145":{"start":{"line":251,"column":6},"end":{"line":254,"column":42}},"146":{"start":{"line":252,"column":8},"end":{"line":252,"column":42}},"147":{"start":{"line":254,"column":8},"end":{"line":254,"column":42}},"148":{"start":{"line":257,"column":6},"end":{"line":258,"column":31}},"149":{"start":{"line":258,"column":8},"end":{"line":258,"column":31}},"150":{"start":{"line":262,"column":2},"end":{"line":318,"column":3}},"151":{"start":{"line":263,"column":4},"end":{"line":263,"column":33}},"152":{"start":{"line":266,"column":4},"end":{"line":266,"column":41}},"153":{"start":{"line":267,"column":4},"end":{"line":283,"column":5}},"154":{"start":{"line":268,"column":6},"end":{"line":282,"column":7}},"155":{"start":{"line":270,"column":8},"end":{"line":270,"column":33}},"156":{"start":{"line":271,"column":13},"end":{"line":282,"column":7}},"157":{"start":{"line":273,"column":8},"end":{"line":273,"column":54}},"158":{"start":{"line":274,"column":8},"end":{"line":281,"column":9}},"159":{"start":{"line":275,"column":10},"end":{"line":275,"column":41}},"160":{"start":{"line":276,"column":10},"end":{"line":280,"column":11}},"161":{"start":{"line":278,"column":12},"end":{"line":278,"column":45}},"162":{"start":{"line":279,"column":12},"end":{"line":279,"column":54}},"163":{"start":{"line":286,"column":4},"end":{"line":286,"column":32}},"164":{"start":{"line":289,"column":4},"end":{"line":290,"column":30}},"165":{"start":{"line":290,"column":6},"end":{"line":290,"column":30}},"166":{"start":{"line":293,"column":4},"end":{"line":294,"column":12}},"167":{"start":{"line":294,"column":6},"end":{"line":294,"column":12}},"168":{"start":{"line":297,"column":4},"end":{"line":297,"column":34}},"169":{"start":{"line":300,"column":4},"end":{"line":317,"column":5}},"170":{"start":{"line":301,"column":6},"end":{"line":316,"column":7}},"171":{"start":{"line":303,"column":8},"end":{"line":303,"column":36}},"172":{"start":{"line":306,"column":8},"end":{"line":309,"column":57}},"173":{"start":{"line":307,"column":10},"end":{"line":307,"column":42}},"174":{"start":{"line":309,"column":10},"end":{"line":309,"column":57}},"175":{"start":{"line":311,"column":8},"end":{"line":315,"column":9}},"176":{"start":{"line":320,"column":2},"end":{"line":327,"column":3}},"177":{"start":{"line":321,"column":4},"end":{"line":321,"column":29}},"178":{"start":{"line":322,"column":4},"end":{"line":322,"column":16}},"179":{"start":{"line":323,"column":4},"end":{"line":326,"column":6}},"180":{"start":{"line":324,"column":6},"end":{"line":324,"column":27}},"181":{"start":{"line":325,"column":6},"end":{"line":325,"column":18}},"182":{"start":{"line":330,"column":2},"end":{"line":361,"column":3}},"183":{"start":{"line":331,"column":4},"end":{"line":331,"column":16}},"184":{"start":{"line":332,"column":4},"end":{"line":332,"column":31}},"185":{"start":{"line":335,"column":4},"end":{"line":338,"column":6}},"186":{"start":{"line":336,"column":6},"end":{"line":336,"column":23}},"187":{"start":{"line":337,"column":6},"end":{"line":337,"column":12}},"188":{"start":{"line":341,"column":4},"end":{"line":348,"column":5}},"189":{"start":{"line":342,"column":6},"end":{"line":342,"column":34}},"190":{"start":{"line":344,"column":6},"end":{"line":347,"column":8}},"191":{"start":{"line":345,"column":8},"end":{"line":345,"column":24}},"192":{"start":{"line":346,"column":8},"end":{"line":346,"column":14}},"193":{"start":{"line":350,"column":4},"end":{"line":360,"column":5}},"194":{"start":{"line":352,"column":6},"end":{"line":353,"column":14}},"195":{"start":{"line":353,"column":8},"end":{"line":353,"column":14}},"196":{"start":{"line":356,"column":6},"end":{"line":356,"column":49}},"197":{"start":{"line":358,"column":6},"end":{"line":358,"column":37}},"198":{"start":{"line":359,"column":6},"end":{"line":359,"column":18}},"199":{"start":{"line":363,"column":2},"end":{"line":367,"column":3}},"200":{"start":{"line":364,"column":4},"end":{"line":364,"column":22}},"201":{"start":{"line":364,"column":14},"end":{"line":364,"column":22}},"202":{"start":{"line":365,"column":4},"end":{"line":365,"column":22}},"203":{"start":{"line":365,"column":14},"end":{"line":365,"column":22}},"204":{"start":{"line":366,"column":4},"end":{"line":366,"column":49}},"205":{"start":{"line":372,"column":2},"end":{"line":374,"column":3}},"206":{"start":{"line":373,"column":4},"end":{"line":373,"column":54}},"207":{"start":{"line":378,"column":2},"end":{"line":406,"column":3}},"208":{"start":{"line":379,"column":4},"end":{"line":379,"column":16}},"209":{"start":{"line":380,"column":4},"end":{"line":380,"column":26}},"210":{"start":{"line":381,"column":4},"end":{"line":405,"column":6}},"211":{"start":{"line":382,"column":6},"end":{"line":382,"column":64}},"212":{"start":{"line":383,"column":6},"end":{"line":403,"column":7}},"213":{"start":{"line":385,"column":8},"end":{"line":389,"column":9}},"214":{"start":{"line":386,"column":10},"end":{"line":386,"column":59}},"215":{"start":{"line":387,"column":10},"end":{"line":388,"column":31}},"216":{"start":{"line":388,"column":12},"end":{"line":388,"column":31}},"217":{"start":{"line":392,"column":8},"end":{"line":393,"column":36}},"218":{"start":{"line":393,"column":10},"end":{"line":393,"column":36}},"219":{"start":{"line":396,"column":8},"end":{"line":396,"column":56}},"220":{"start":{"line":397,"column":8},"end":{"line":398,"column":22}},"221":{"start":{"line":398,"column":10},"end":{"line":398,"column":22}},"222":{"start":{"line":402,"column":8},"end":{"line":402,"column":74}},"223":{"start":{"line":404,"column":6},"end":{"line":404,"column":18}},"224":{"start":{"line":408,"column":2},"end":{"line":408,"column":11}},"225":{"start":{"line":411,"column":0},"end":{"line":413,"column":3}},"226":{"start":{"line":412,"column":4},"end":{"line":412,"column":57}},"227":{"start":{"line":416,"column":0},"end":{"line":416,"column":40}},"228":{"start":{"line":417,"column":0},"end":{"line":422,"column":1}},"229":{"start":{"line":418,"column":2},"end":{"line":418,"column":43}},"230":{"start":{"line":419,"column":2},"end":{"line":420,"column":32}},"231":{"start":{"line":420,"column":4},"end":{"line":420,"column":32}},"232":{"start":{"line":421,"column":2},"end":{"line":421,"column":12}}},"branchMap":{"1":{"line":19,"type":"if","locations":[{"start":{"line":19,"column":6},"end":{"line":19,"column":6}},{"start":{"line":19,"column":6},"end":{"line":19,"column":6}}]},"2":{"line":19,"type":"binary-expr","locations":[{"start":{"line":19,"column":10},"end":{"line":19,"column":39}},{"start":{"line":19,"column":43},"end":{"line":19,"column":69}}]},"3":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":8},"end":{"line":21,"column":8}},{"start":{"line":21,"column":8},"end":{"line":21,"column":8}}]},"4":{"line":23,"type":"if","locations":[{"start":{"line":23,"column":8},"end":{"line":23,"column":8}},{"start":{"line":23,"column":8},"end":{"line":23,"column":8}}]},"5":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":11},"end":{"line":31,"column":11}},{"start":{"line":31,"column":11},"end":{"line":31,"column":11}}]},"6":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":8},"end":{"line":33,"column":8}},{"start":{"line":33,"column":8},"end":{"line":33,"column":8}}]},"7":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":6},"end":{"line":44,"column":6}},{"start":{"line":44,"column":6},"end":{"line":44,"column":6}}]},"8":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":8},"end":{"line":47,"column":8}},{"start":{"line":47,"column":8},"end":{"line":47,"column":8}}]},"9":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":10},"end":{"line":49,"column":10}},{"start":{"line":49,"column":10},"end":{"line":49,"column":10}}]},"10":{"line":56,"type":"if","locations":[{"start":{"line":56,"column":13},"end":{"line":56,"column":13}},{"start":{"line":56,"column":13},"end":{"line":56,"column":13}}]},"11":{"line":57,"type":"cond-expr","locations":[{"start":{"line":57,"column":76},"end":{"line":57,"column":85}},{"start":{"line":57,"column":88},"end":{"line":57,"column":95}}]},"12":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":11},"end":{"line":63,"column":11}},{"start":{"line":63,"column":11},"end":{"line":63,"column":11}}]},"13":{"line":63,"type":"binary-expr","locations":[{"start":{"line":63,"column":15},"end":{"line":63,"column":19}},{"start":{"line":63,"column":24},"end":{"line":63,"column":69}}]},"14":{"line":69,"type":"if","locations":[{"start":{"line":69,"column":11},"end":{"line":69,"column":11}},{"start":{"line":69,"column":11},"end":{"line":69,"column":11}}]},"15":{"line":70,"type":"cond-expr","locations":[{"start":{"line":70,"column":69},"end":{"line":70,"column":78}},{"start":{"line":70,"column":81},"end":{"line":70,"column":88}}]},"16":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":6},"end":{"line":76,"column":6}},{"start":{"line":76,"column":6},"end":{"line":76,"column":6}}]},"17":{"line":77,"type":"cond-expr","locations":[{"start":{"line":77,"column":55},"end":{"line":77,"column":64}},{"start":{"line":77,"column":67},"end":{"line":77,"column":74}}]},"18":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":6},"end":{"line":81,"column":6}},{"start":{"line":81,"column":6},"end":{"line":81,"column":6}}]},"19":{"line":81,"type":"binary-expr","locations":[{"start":{"line":81,"column":10},"end":{"line":81,"column":19}},{"start":{"line":81,"column":23},"end":{"line":81,"column":52}}]},"20":{"line":84,"type":"binary-expr","locations":[{"start":{"line":84,"column":40},"end":{"line":84,"column":56}},{"start":{"line":84,"column":60},"end":{"line":84,"column":78}}]},"21":{"line":85,"type":"cond-expr","locations":[{"start":{"line":85,"column":55},"end":{"line":85,"column":64}},{"start":{"line":85,"column":67},"end":{"line":85,"column":74}}]},"22":{"line":89,"type":"if","locations":[{"start":{"line":89,"column":8},"end":{"line":89,"column":8}},{"start":{"line":89,"column":8},"end":{"line":89,"column":8}}]},"23":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":10},"end":{"line":91,"column":10}},{"start":{"line":91,"column":10},"end":{"line":91,"column":10}}]},"24":{"line":96,"type":"if","locations":[{"start":{"line":96,"column":10},"end":{"line":96,"column":10}},{"start":{"line":96,"column":10},"end":{"line":96,"column":10}}]},"25":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":8},"end":{"line":108,"column":8}},{"start":{"line":108,"column":8},"end":{"line":108,"column":8}}]},"26":{"line":112,"type":"if","locations":[{"start":{"line":112,"column":8},"end":{"line":112,"column":8}},{"start":{"line":112,"column":8},"end":{"line":112,"column":8}}]},"27":{"line":112,"type":"binary-expr","locations":[{"start":{"line":112,"column":12},"end":{"line":112,"column":33}},{"start":{"line":112,"column":38},"end":{"line":112,"column":70}},{"start":{"line":112,"column":74},"end":{"line":112,"column":105}}]},"28":{"line":123,"type":"if","locations":[{"start":{"line":123,"column":8},"end":{"line":123,"column":8}},{"start":{"line":123,"column":8},"end":{"line":123,"column":8}}]},"29":{"line":131,"type":"if","locations":[{"start":{"line":131,"column":6},"end":{"line":131,"column":6}},{"start":{"line":131,"column":6},"end":{"line":131,"column":6}}]},"30":{"line":131,"type":"binary-expr","locations":[{"start":{"line":131,"column":10},"end":{"line":131,"column":17}},{"start":{"line":131,"column":21},"end":{"line":131,"column":60}},{"start":{"line":131,"column":64},"end":{"line":131,"column":81}}]},"31":{"line":138,"type":"if","locations":[{"start":{"line":138,"column":6},"end":{"line":138,"column":6}},{"start":{"line":138,"column":6},"end":{"line":138,"column":6}}]},"32":{"line":140,"type":"if","locations":[{"start":{"line":140,"column":8},"end":{"line":140,"column":8}},{"start":{"line":140,"column":8},"end":{"line":140,"column":8}}]},"33":{"line":149,"type":"if","locations":[{"start":{"line":149,"column":4},"end":{"line":149,"column":4}},{"start":{"line":149,"column":4},"end":{"line":149,"column":4}}]},"34":{"line":153,"type":"if","locations":[{"start":{"line":153,"column":4},"end":{"line":153,"column":4}},{"start":{"line":153,"column":4},"end":{"line":153,"column":4}}]},"35":{"line":172,"type":"if","locations":[{"start":{"line":172,"column":4},"end":{"line":172,"column":4}},{"start":{"line":172,"column":4},"end":{"line":172,"column":4}}]},"36":{"line":178,"type":"if","locations":[{"start":{"line":178,"column":8},"end":{"line":178,"column":8}},{"start":{"line":178,"column":8},"end":{"line":178,"column":8}}]},"37":{"line":184,"type":"binary-expr","locations":[{"start":{"line":184,"column":32},"end":{"line":184,"column":54}},{"start":{"line":184,"column":56},"end":{"line":184,"column":58}}]},"38":{"line":189,"type":"if","locations":[{"start":{"line":189,"column":4},"end":{"line":189,"column":4}},{"start":{"line":189,"column":4},"end":{"line":189,"column":4}}]},"39":{"line":191,"type":"if","locations":[{"start":{"line":191,"column":6},"end":{"line":191,"column":6}},{"start":{"line":191,"column":6},"end":{"line":191,"column":6}}]},"40":{"line":195,"type":"if","locations":[{"start":{"line":195,"column":10},"end":{"line":195,"column":10}},{"start":{"line":195,"column":10},"end":{"line":195,"column":10}}]},"41":{"line":201,"type":"if","locations":[{"start":{"line":201,"column":8},"end":{"line":201,"column":8}},{"start":{"line":201,"column":8},"end":{"line":201,"column":8}}]},"42":{"line":203,"type":"binary-expr","locations":[{"start":{"line":203,"column":41},"end":{"line":203,"column":70}},{"start":{"line":203,"column":72},"end":{"line":203,"column":74}}]},"43":{"line":214,"type":"if","locations":[{"start":{"line":214,"column":4},"end":{"line":214,"column":4}},{"start":{"line":214,"column":4},"end":{"line":214,"column":4}}]},"44":{"line":220,"type":"if","locations":[{"start":{"line":220,"column":8},"end":{"line":220,"column":8}},{"start":{"line":220,"column":8},"end":{"line":220,"column":8}}]},"45":{"line":225,"type":"binary-expr","locations":[{"start":{"line":225,"column":32},"end":{"line":225,"column":54}},{"start":{"line":225,"column":56},"end":{"line":225,"column":58}}]},"46":{"line":226,"type":"if","locations":[{"start":{"line":226,"column":6},"end":{"line":226,"column":6}},{"start":{"line":226,"column":6},"end":{"line":226,"column":6}}]},"47":{"line":232,"type":"if","locations":[{"start":{"line":232,"column":4},"end":{"line":232,"column":4}},{"start":{"line":232,"column":4},"end":{"line":232,"column":4}}]},"48":{"line":234,"type":"if","locations":[{"start":{"line":234,"column":6},"end":{"line":234,"column":6}},{"start":{"line":234,"column":6},"end":{"line":234,"column":6}}]},"49":{"line":238,"type":"if","locations":[{"start":{"line":238,"column":10},"end":{"line":238,"column":10}},{"start":{"line":238,"column":10},"end":{"line":238,"column":10}}]},"50":{"line":243,"type":"binary-expr","locations":[{"start":{"line":243,"column":41},"end":{"line":243,"column":70}},{"start":{"line":243,"column":72},"end":{"line":243,"column":74}}]},"51":{"line":244,"type":"if","locations":[{"start":{"line":244,"column":8},"end":{"line":244,"column":8}},{"start":{"line":244,"column":8},"end":{"line":244,"column":8}}]},"52":{"line":250,"type":"if","locations":[{"start":{"line":250,"column":4},"end":{"line":250,"column":4}},{"start":{"line":250,"column":4},"end":{"line":250,"column":4}}]},"53":{"line":251,"type":"if","locations":[{"start":{"line":251,"column":6},"end":{"line":251,"column":6}},{"start":{"line":251,"column":6},"end":{"line":251,"column":6}}]},"54":{"line":257,"type":"if","locations":[{"start":{"line":257,"column":6},"end":{"line":257,"column":6}},{"start":{"line":257,"column":6},"end":{"line":257,"column":6}}]},"55":{"line":267,"type":"if","locations":[{"start":{"line":267,"column":4},"end":{"line":267,"column":4}},{"start":{"line":267,"column":4},"end":{"line":267,"column":4}}]},"56":{"line":268,"type":"if","locations":[{"start":{"line":268,"column":6},"end":{"line":268,"column":6}},{"start":{"line":268,"column":6},"end":{"line":268,"column":6}}]},"57":{"line":271,"type":"if","locations":[{"start":{"line":271,"column":13},"end":{"line":271,"column":13}},{"start":{"line":271,"column":13},"end":{"line":271,"column":13}}]},"58":{"line":274,"type":"if","locations":[{"start":{"line":274,"column":8},"end":{"line":274,"column":8}},{"start":{"line":274,"column":8},"end":{"line":274,"column":8}}]},"59":{"line":276,"type":"if","locations":[{"start":{"line":276,"column":10},"end":{"line":276,"column":10}},{"start":{"line":276,"column":10},"end":{"line":276,"column":10}}]},"60":{"line":289,"type":"if","locations":[{"start":{"line":289,"column":4},"end":{"line":289,"column":4}},{"start":{"line":289,"column":4},"end":{"line":289,"column":4}}]},"61":{"line":289,"type":"binary-expr","locations":[{"start":{"line":289,"column":8},"end":{"line":289,"column":30}},{"start":{"line":289,"column":34},"end":{"line":289,"column":51}}]},"62":{"line":293,"type":"if","locations":[{"start":{"line":293,"column":4},"end":{"line":293,"column":4}},{"start":{"line":293,"column":4},"end":{"line":293,"column":4}}]},"63":{"line":300,"type":"if","locations":[{"start":{"line":300,"column":4},"end":{"line":300,"column":4}},{"start":{"line":300,"column":4},"end":{"line":300,"column":4}}]},"64":{"line":300,"type":"binary-expr","locations":[{"start":{"line":300,"column":8},"end":{"line":300,"column":30}},{"start":{"line":300,"column":34},"end":{"line":300,"column":60}}]},"65":{"line":301,"type":"if","locations":[{"start":{"line":301,"column":6},"end":{"line":301,"column":6}},{"start":{"line":301,"column":6},"end":{"line":301,"column":6}}]},"66":{"line":306,"type":"if","locations":[{"start":{"line":306,"column":8},"end":{"line":306,"column":8}},{"start":{"line":306,"column":8},"end":{"line":306,"column":8}}]},"67":{"line":321,"type":"binary-expr","locations":[{"start":{"line":321,"column":10},"end":{"line":321,"column":13}},{"start":{"line":321,"column":17},"end":{"line":321,"column":29}}]},"68":{"line":341,"type":"if","locations":[{"start":{"line":341,"column":4},"end":{"line":341,"column":4}},{"start":{"line":341,"column":4},"end":{"line":341,"column":4}}]},"69":{"line":352,"type":"if","locations":[{"start":{"line":352,"column":6},"end":{"line":352,"column":6}},{"start":{"line":352,"column":6},"end":{"line":352,"column":6}}]},"70":{"line":352,"type":"binary-expr","locations":[{"start":{"line":352,"column":10},"end":{"line":352,"column":40}},{"start":{"line":352,"column":44},"end":{"line":352,"column":75}}]},"71":{"line":356,"type":"binary-expr","locations":[{"start":{"line":356,"column":24},"end":{"line":356,"column":34}},{"start":{"line":356,"column":38},"end":{"line":356,"column":49}}]},"72":{"line":358,"type":"binary-expr","locations":[{"start":{"line":358,"column":6},"end":{"line":358,"column":8}},{"start":{"line":358,"column":12},"end":{"line":358,"column":37}}]},"73":{"line":364,"type":"if","locations":[{"start":{"line":364,"column":4},"end":{"line":364,"column":4}},{"start":{"line":364,"column":4},"end":{"line":364,"column":4}}]},"74":{"line":365,"type":"if","locations":[{"start":{"line":365,"column":4},"end":{"line":365,"column":4}},{"start":{"line":365,"column":4},"end":{"line":365,"column":4}}]},"75":{"line":366,"type":"binary-expr","locations":[{"start":{"line":366,"column":12},"end":{"line":366,"column":18}},{"start":{"line":366,"column":22},"end":{"line":366,"column":48}}]},"76":{"line":385,"type":"if","locations":[{"start":{"line":385,"column":8},"end":{"line":385,"column":8}},{"start":{"line":385,"column":8},"end":{"line":385,"column":8}}]},"77":{"line":385,"type":"binary-expr","locations":[{"start":{"line":385,"column":12},"end":{"line":385,"column":44}},{"start":{"line":385,"column":48},"end":{"line":385,"column":81}}]},"78":{"line":387,"type":"if","locations":[{"start":{"line":387,"column":10},"end":{"line":387,"column":10}},{"start":{"line":387,"column":10},"end":{"line":387,"column":10}}]},"79":{"line":392,"type":"if","locations":[{"start":{"line":392,"column":8},"end":{"line":392,"column":8}},{"start":{"line":392,"column":8},"end":{"line":392,"column":8}}]},"80":{"line":397,"type":"if","locations":[{"start":{"line":397,"column":8},"end":{"line":397,"column":8}},{"start":{"line":397,"column":8},"end":{"line":397,"column":8}}]},"81":{"line":412,"type":"binary-expr","locations":[{"start":{"line":412,"column":12},"end":{"line":412,"column":35}},{"start":{"line":412,"column":39},"end":{"line":412,"column":56}}]},"82":{"line":419,"type":"if","locations":[{"start":{"line":419,"column":2},"end":{"line":419,"column":2}},{"start":{"line":419,"column":2},"end":{"line":419,"column":2}}]}},"code":["var mlib = require('ssb-msgs')","var u = require('./util')","","module.exports = function (sbot, db, state, emit) {","","  var processors = {","    post: function (msg) {","      var me = getProfile(sbot.id)","      var author = msg.value.author","      var by_me = (author === sbot.id)","      var c = msg.value.content","      var root = mlib.link(c.root, 'msg')","      var recps = mlib.links(c.recps)","      var mentions = mlib.links(c.mentions)","","      // inbox index:","      // add msgs that mention or address the user","      var inboxRow","      if (u.findLink(mentions, sbot.id) || u.findLink(recps, sbot.id)) {","        // if a reply, make sure we have the root already","        if (root)","          inboxRow = state.inbox.sortedUpdate(msg.received, root.link)","        if (!inboxRow) {","          // fallback to inserting the current message, if the root isnt available (or its not a reply)","          inboxRow = state.inbox.sortedUpsert(msg.received, msg.key)","        }","        emit('index-change', { index: 'inbox' })","        attachChildIsRead(inboxRow, msg.key)","      }","      // update for replies","      else if (root) {","        inboxRow = state.inbox.find(root.link)","        if (inboxRow) {","          state.inbox.sortedUpsert(msg.received, root.link)","          emit('index-change', { index: 'inbox' })","          attachChildIsRead(inboxRow, msg.key)","        }","      }","","      // inbox sub-indexes","      // note, these sub-indexes shouldnt have overlap: thus the else/if","      // private posts index","      var bookmarkRow","      if (u.findLink(recps, sbot.id)) {","        var privatePostsRow","        // update replies","        if (root) {","          privatePostsRow = state.privatePosts.find(root.link)","          if (privatePostsRow) {","            state.privatePosts.sortedUpsert(ts(msg), root.link)","            emit('index-change', { index: 'privatePosts' })","            attachChildIsRead(privatePostsRow, msg.key)","          }","        }","        // add msgs addressed to the user","        else if (!privatePostsRow) {        ","          privatePostsRow = state.privatePosts.sortedUpsert(ts(msg), root ? root.link : msg.key)","          emit('index-change', { index: 'privatePosts' })","          attachChildIsRead(privatePostsRow, msg.key)","        }","      }","      // bookmarks index: update for replies","      else if (root && (bookmarkRow = state.bookmarks.find(root.link))) {","        state.bookmarks.sortedUpsert(ts(msg), root.link)","        emit('index-change', { index: 'bookmarks' })","        attachChildIsRead(bookmarkRow, msg.key)","      }","      // mentions index: add msgs that mention the user","      else if (u.findLink(mentions, sbot.id)) {","        var mentionRow = state.mentions.sortedUpsert(ts(msg), root ? root.link : msg.key)","        emit('index-change', { index: 'mentions' })","        attachChildIsRead(mentionRow, msg.key)","      }","","      // public posts index: add public posts / replies","      if (recps.length === 0) {","        state.publicPosts.sortedUpsert(ts(msg), root ? root.link : msg.key)","        emit('index-change', { index: 'publicPosts' })","      }","","      if (c.channel && typeof c.channel === 'string') {","        // channels index: add public posts / replies","        var indexName = 'channel-'+c.channel","        var index = state[indexName] = (state[indexName] || u.index(indexName))","        index.sortedUpsert(msg.value.timestamp, root ? root.link : msg.key)","        emit('index-change', { index: indexName })","","        // inbox index: add watched channels","        if (index.watched) {","          var inboxRow","          if (root)","            // only do updates if a reply, we dont want inbox items that dont have a root","            inboxRow = state.inbox.sortedUpdate(ts(msg), root.link)","          else","            inboxRow = state.inbox.sortedInsert(ts(msg), msg.key)","          if (inboxRow) {","            emit('index-change', { index: 'inbox' })","            attachChildIsRead(inboxRow, msg.key)","          }","        }","      }","    },","","    contact: function (msg) {      ","      mlib.links(msg.value.content.contact, 'feed').forEach(function (link) {","        // update profiles","        var toself = link.link === msg.value.author","        if (toself) updateSelfContact(msg.value.author, msg)","        else        updateOtherContact(msg.value.author, link.link, msg)","","        // notices index: add follows or blocks","        if (link.link === sbot.id && ('following' in msg.value.content || 'blocking' in msg.value.content)) {","          state.notices.sortedUpsert(ts(msg), msg.key)","          emit('index-change', { index: 'notices' })","        }","      })","    },","","    about: function (msg) {","      // update profiles","      mlib.links(msg.value.content.about, 'feed').forEach(function (link) {","        var toself = link.link === msg.value.author","        if (toself) updateSelfContact(msg.value.author, msg)","        else        updateOtherContact(msg.value.author, link.link, msg)","      })","    },","","    vote: function (msg) {","      // notices index: add upvotes on your messages","      var msgLink = mlib.link(msg.value.content.vote, 'msg')","      if (msgLink && state.mymsgs.indexOf(msgLink.link) >= 0 && msgLink.value > 0) {","        state.notices.sortedUpsert(ts(msg), msg.key)","        emit('index-change', { index: 'notices' })","      }","","      // user flags","      var voteLink = mlib.link(msg.value.content.vote, 'feed')","      if (voteLink) {","        var target = getProfile(voteLink.link)","        if (voteLink.value < 0)","          target.flaggers[msg.value.author] = { msgKey: msg.key, reason: voteLink.reason }","        else","          delete target.flaggers[msg.value.author]","      }","    }","  }","","  function getProfile (pid) {","    if (pid.id) // already a profile?","      return pid","","    var profile = state.profiles[pid]","    if (!profile) {","      state.profiles[pid] = profile = {","        id: pid,","        self: { name: null, image: null }, // values set by this user about this user","        byMe: { name: null, image: null }, // values set by the local user about this user","        names: {}, // map of name -> array of users to use that name","        images: {}, // map of images -> array of users to use that pic","        followers: {}, // map of followers -> true","        flaggers: {}, // map of flaggers -> flag-msg","      }","    }","    return profile","  }","","  function updateSelfContact (author, msg) {","    var c = msg.value.content","    author = getProfile(author)","","    // name: a non-empty string","    if (nonEmptyStr(c.name)) {","      var safeName = makeNameSafe(c.name)","","      // remove old assignment, if it exists","      for (var name in author.names) {","        author.names[name] = author.names[name].filter(function (id) { return id !== author.id })","        if (!author.names[name][0])","          delete author.names[name]","      }","","      // add new assignment","      author.self.name = safeName","      author.names[safeName] = (author.names[safeName]||[]).concat(author.id)","      rebuildNamesFor(author)","    }","","    // image: link to image","    if ('image' in c) {","      var imageLink = mlib.link(c.image, 'blob')","      if (imageLink) {","        // remove old assignment, if it exists","        for (var image in author.images) {","          author.images[image] = author.images[image].filter(function (id) { return id !== author.id })","          if (!author.images[image][0])","            delete author.images[image]","        }","","        // add new assignment","        author.self.image = imageLink","        if (author.id == sbot.id)","          author.byMe.image = imageLink","        author.images[imageLink.link] = (author.images[imageLink.link]||[]).concat(author.id)","      }","    }","  }","","  function updateOtherContact (source, target, msg) {","    var c = msg.value.content","    source = getProfile(source)","    target = getProfile(target)","","    // name: a non-empty string","    if (nonEmptyStr(c.name)) {","      var safeName = makeNameSafe(c.name)","","      // remove old assignment, if it exists","      for (var name in target.names) {","        target.names[name] = target.names[name].filter(function (id) { return id !== source.id })","        if (!target.names[name][0])","          delete target.names[name]","      }","","      // add new assignment","      target.names[safeName] = (target.names[safeName]||[]).concat(source.id)","      if (source.id === sbot.id)","        target.byMe.name = safeName","      rebuildNamesFor(target)","    }","","    // image: link to image","    if ('image' in c) {","      var imageLink = mlib.link(c.image, 'blob')","      if (imageLink) {","        // remove old assignment, if it exists","        for (var image in target.images) {","          target.images[image] = target.images[image].filter(function (id) { return id !== source.id })","          if (!target.images[image][0])","            delete target.images[image]","        }","","        // add new assignment","        target.images[imageLink.link] = (target.images[imageLink.link]||[]).concat(source.id)","        if (source.id == sbot.id)","          target.byMe.image = imageLink","      }","    }","","    // following: bool","    if (typeof c.following === 'boolean') {","      if (c.following)","        target.followers[source.id] = true","      else","        delete target.followers[source.id]","","      // if from the user, update names (in case un/following changes conflict status)","      if (msg.value.author == sbot.id)","        rebuildNamesFor(target)","    }","  }","","  function rebuildNamesFor (profile) {","    profile = getProfile(profile)","","    // remove oldname from id->name map","    var oldname = state.names[profile.id]","    if (oldname) {","      if (state.ids[oldname] == profile.id) {","        // remove","        delete state.ids[oldname]","      } else if (Array.isArray(state.ids[oldname])) {","        // is in a conflict, remove from conflict array","        var i = state.ids[oldname].indexOf(profile.id)","        if (i !== -1) {","          state.ids[oldname].splice(i, 1)","          if (state.ids[oldname].length === 1) {","            // conflict resolved","            delete state.actionItems[oldname]","            state.ids[oldname] = state.ids[oldname][0]","          }","        }","      }","    }","","    // default to self-assigned name","    var name = profile.self.name","","    // override with name assigned by the local user","    if (profile.id !== sbot.id && profile.byMe.name)","      name = profile.byMe.name","","    // abort if there's no name at all","    if (!name)","      return","","    // store","    state.names[profile.id] = name","","    // if following, update id->name map","    if (profile.id === sbot.id || profile.followers[sbot.id]) {","      if (!state.ids[name]) { // no conflict?","        // take it","        state.ids[name] = profile.id","      } else {","        // keep track of all assigned ids","        if (Array.isArray(state.ids[name]))","          state.ids[name].push(profile.id)","        else","          state.ids[name] = [state.ids[name], profile.id]","        // conflict, this needs to be handled by the user","        state.actionItems[name] = {","          type: 'name-conflict',","          name: name,","          ids: state.ids[name]","        }","      }","    }","  }","","  function attachIsRead (indexRow, key) {","    key = key || indexRow.key","    state.pinc()","    db.isread.get(key, function (err, v) {","      indexRow.isread = !!v","      state.pdec()","    })","  }","","  // look up the child and root isread state, combine them with the current row's isread state","  function attachChildIsRead (indexRow, childKey, cb) {","    state.pinc()","    var rootIsRead, childIsRead","","    // get child isread","    db.isread.get(childKey, function (err, v) {","      childIsRead = !!v","      next()","    })","","    // lookup the root isread from DB if not already on the row","    if (typeof indexRow.isread == 'boolean') {","      rootIsRead = indexRow.isread","    } else {","      db.isread.get(indexRow.key, function (err, v) {","        rootIsRead = !!v","        next()","      })      ","    }","","    function next () {","      // wait for both","      if (typeof rootIsRead != 'boolean' || typeof childIsRead != 'boolean')","        return","","      // combine child and root isread state","      indexRow.isread = rootIsRead && childIsRead","      ","      cb && cb(null, indexRow.isread)","      state.pdec() // call this last, after all async work is done","    }","  }","","  function follows (a, b) {","    if (a.id) a = a.id // if `a` is a profile, just get its id","    if (b.id) b = b.id // if `b` is a profile, just get its id","    return (a != b && getProfile(b).followers[a])","  }","","  // helper to get the most reliable timestamp for a message","  // - stops somebody from boosting their ranking (accidentally, maliciously) with a future TS","  // - applies only when ordering by most-recent","  function ts (msg) {","    return Math.min(msg.received, msg.value.timestamp)","  }","","  // exported api","","  function fn (logkey) {","    state.pinc()","    var key = logkey.value","    sbot.get(logkey.value, function (err, value) {","      var msg = { key: key, value: value, received: logkey.key }","      try {","        // encrypted? try to decrypt","        if (typeof value.content == 'string' && value.content.slice(-4) == '.box') {","          value.content = sbot.private.unbox(value.content)","          if (!value.content)","            return state.pdec()","        }","","        // collect keys of user's messages","        if (msg.value.author === sbot.id)","          state.mymsgs.push(msg.key)","","        // type processing","        var process = processors[msg.value.content.type]","        if (process)","          process(msg)","      }","      catch (e) {","        // :TODO: use sbot logging plugin","        console.error('Failed to process message', e, e.stack, key, value)","      }","      state.pdec()","    })","  }","","  return fn","}","","function nonEmptyStr (str) {","    return (typeof str === 'string' && !!(''+str).trim())","  }","","// allow A-z0-9._-, dont allow a trailing .","var badNameCharsRegex = /[^A-z0-9\\._-]/g","function makeNameSafe (str) {","  str = str.replace(badNameCharsRegex, '_')","  if (str.charAt(str.length - 1) == '.')","    str = str.slice(0, -1) + '_'","  return str","}"],"l":{"1":1,"2":1,"4":1,"6":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"18":0,"19":0,"21":0,"22":0,"23":0,"25":0,"27":0,"28":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"43":0,"44":0,"45":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"56":0,"57":0,"58":0,"59":0,"63":0,"64":0,"65":0,"66":0,"69":0,"70":0,"71":0,"72":0,"76":0,"77":0,"78":0,"81":0,"83":0,"84":0,"85":0,"86":0,"89":0,"90":0,"91":0,"93":0,"95":0,"96":0,"97":0,"98":0,"105":0,"107":0,"108":0,"109":0,"112":0,"113":0,"114":0,"121":0,"122":0,"123":0,"124":0,"130":0,"131":0,"132":0,"133":0,"137":0,"138":0,"139":0,"140":0,"141":0,"143":0,"148":1,"149":0,"150":0,"152":0,"153":0,"154":0,"164":0,"167":1,"168":0,"169":0,"172":0,"173":0,"176":0,"177":0,"178":0,"179":0,"183":0,"184":0,"185":0,"189":0,"190":0,"191":0,"193":0,"194":0,"195":0,"196":0,"200":0,"201":0,"202":0,"203":0,"208":1,"209":0,"210":0,"211":0,"214":0,"215":0,"218":0,"219":0,"220":0,"221":0,"225":0,"226":0,"227":0,"228":0,"232":0,"233":0,"234":0,"236":0,"237":0,"238":0,"239":0,"243":0,"244":0,"245":0,"250":0,"251":0,"252":0,"254":0,"257":0,"258":0,"262":1,"263":0,"266":0,"267":0,"268":0,"270":0,"271":0,"273":0,"274":0,"275":0,"276":0,"278":0,"279":0,"286":0,"289":0,"290":0,"293":0,"294":0,"297":0,"300":0,"301":0,"303":0,"306":0,"307":0,"309":0,"311":0,"320":1,"321":0,"322":0,"323":0,"324":0,"325":0,"330":1,"331":0,"332":0,"335":0,"336":0,"337":0,"341":0,"342":0,"344":0,"345":0,"346":0,"350":1,"352":0,"353":0,"356":0,"358":0,"359":0,"363":1,"364":0,"365":0,"366":0,"372":1,"373":0,"378":1,"379":0,"380":0,"381":0,"382":0,"383":0,"385":0,"386":0,"387":0,"388":0,"392":0,"393":0,"396":0,"397":0,"398":0,"402":0,"404":0,"408":0,"411":1,"412":0,"416":1,"417":1,"418":0,"419":0,"420":0,"421":0}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/electron/menu.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/electron/menu.js","s":{"1":2,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":1,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0},"fnMap":{"1":{"name":"showAbout","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":24}}},"2":{"name":"(anonymous_2)","line":20,"loc":{"start":{"line":20,"column":5},"end":{"line":20,"column":20}}},"3":{"name":"showLicense","line":26,"loc":{"start":{"line":26,"column":0},"end":{"line":26,"column":26}}},"4":{"name":"(anonymous_4)","line":35,"loc":{"start":{"line":35,"column":17},"end":{"line":35,"column":41}}},"5":{"name":"(anonymous_5)","line":43,"loc":{"start":{"line":43,"column":17},"end":{"line":43,"column":38}}},"6":{"name":"(anonymous_6)","line":75,"loc":{"start":{"line":75,"column":17},"end":{"line":75,"column":38}}},"7":{"name":"(anonymous_7)","line":123,"loc":{"start":{"line":123,"column":17},"end":{"line":123,"column":38}}},"8":{"name":"(anonymous_8)","line":130,"loc":{"start":{"line":130,"column":17},"end":{"line":130,"column":38}}},"9":{"name":"(anonymous_9)","line":137,"loc":{"start":{"line":137,"column":17},"end":{"line":137,"column":38}}},"10":{"name":"(anonymous_10)","line":149,"loc":{"start":{"line":149,"column":17},"end":{"line":149,"column":38}}},"11":{"name":"(anonymous_11)","line":156,"loc":{"start":{"line":156,"column":17},"end":{"line":156,"column":38}}},"12":{"name":"(anonymous_12)","line":163,"loc":{"start":{"line":163,"column":17},"end":{"line":163,"column":38}}},"13":{"name":"(anonymous_13)","line":173,"loc":{"start":{"line":173,"column":17},"end":{"line":173,"column":38}}},"14":{"name":"(anonymous_14)","line":185,"loc":{"start":{"line":185,"column":17},"end":{"line":185,"column":38}}},"15":{"name":"(anonymous_15)","line":192,"loc":{"start":{"line":192,"column":17},"end":{"line":192,"column":38}}},"16":{"name":"(anonymous_16)","line":199,"loc":{"start":{"line":199,"column":17},"end":{"line":199,"column":38}}},"17":{"name":"(anonymous_17)","line":210,"loc":{"start":{"line":210,"column":17},"end":{"line":210,"column":38}}},"18":{"name":"(anonymous_18)","line":217,"loc":{"start":{"line":217,"column":17},"end":{"line":217,"column":38}}},"19":{"name":"(anonymous_19)","line":224,"loc":{"start":{"line":224,"column":17},"end":{"line":224,"column":38}}},"20":{"name":"(anonymous_20)","line":236,"loc":{"start":{"line":236,"column":17},"end":{"line":236,"column":38}}},"21":{"name":"(anonymous_21)","line":243,"loc":{"start":{"line":243,"column":17},"end":{"line":243,"column":38}}},"22":{"name":"(anonymous_22)","line":251,"loc":{"start":{"line":251,"column":17},"end":{"line":251,"column":38}}},"23":{"name":"(anonymous_23)","line":258,"loc":{"start":{"line":258,"column":17},"end":{"line":258,"column":38}}},"24":{"name":"(anonymous_24)","line":269,"loc":{"start":{"line":269,"column":17},"end":{"line":269,"column":38}}},"25":{"name":"(anonymous_25)","line":281,"loc":{"start":{"line":281,"column":17},"end":{"line":281,"column":38}}},"26":{"name":"(anonymous_26)","line":289,"loc":{"start":{"line":289,"column":17},"end":{"line":289,"column":38}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":35}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":39}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":31}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":34}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":26}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":41}},"7":{"start":{"line":8,"column":0},"end":{"line":8,"column":42}},"8":{"start":{"line":10,"column":0},"end":{"line":24,"column":1}},"9":{"start":{"line":11,"column":2},"end":{"line":23,"column":4}},"10":{"start":{"line":21,"column":4},"end":{"line":22,"column":22}},"11":{"start":{"line":22,"column":6},"end":{"line":22,"column":22}},"12":{"start":{"line":26,"column":0},"end":{"line":33,"column":1}},"13":{"start":{"line":27,"column":2},"end":{"line":32,"column":4}},"14":{"start":{"line":35,"column":0},"end":{"line":313,"column":1}},"15":{"start":{"line":36,"column":2},"end":{"line":309,"column":3}},"16":{"start":{"line":44,"column":12},"end":{"line":44,"column":26}},"17":{"start":{"line":76,"column":12},"end":{"line":76,"column":42}},"18":{"start":{"line":124,"column":12},"end":{"line":124,"column":71}},"19":{"start":{"line":131,"column":12},"end":{"line":131,"column":70}},"20":{"start":{"line":138,"column":12},"end":{"line":138,"column":74}},"21":{"start":{"line":150,"column":12},"end":{"line":150,"column":69}},"22":{"start":{"line":157,"column":12},"end":{"line":157,"column":70}},"23":{"start":{"line":164,"column":12},"end":{"line":164,"column":72}},"24":{"start":{"line":174,"column":12},"end":{"line":174,"column":32}},"25":{"start":{"line":186,"column":12},"end":{"line":186,"column":36}},"26":{"start":{"line":193,"column":12},"end":{"line":193,"column":39}},"27":{"start":{"line":200,"column":12},"end":{"line":200,"column":24}},"28":{"start":{"line":211,"column":12},"end":{"line":211,"column":80}},"29":{"start":{"line":218,"column":12},"end":{"line":218,"column":88}},"30":{"start":{"line":225,"column":12},"end":{"line":225,"column":88}},"31":{"start":{"line":237,"column":12},"end":{"line":237,"column":87}},"32":{"start":{"line":244,"column":12},"end":{"line":244,"column":122}},"33":{"start":{"line":252,"column":12},"end":{"line":252,"column":84}},"34":{"start":{"line":259,"column":12},"end":{"line":259,"column":84}},"35":{"start":{"line":270,"column":12},"end":{"line":270,"column":73}},"36":{"start":{"line":282,"column":12},"end":{"line":282,"column":44}},"37":{"start":{"line":283,"column":12},"end":{"line":283,"column":57}},"38":{"start":{"line":290,"column":12},"end":{"line":290,"column":23}},"39":{"start":{"line":311,"column":2},"end":{"line":311,"column":41}},"40":{"start":{"line":312,"column":2},"end":{"line":312,"column":31}}},"branchMap":{"1":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":4}},{"start":{"line":21,"column":4},"end":{"line":21,"column":4}}]},"2":{"line":47,"type":"cond-expr","locations":[{"start":{"line":47,"column":23},"end":{"line":68,"column":7}},{"start":{"line":68,"column":10},"end":{"line":68,"column":12}}]},"3":{"line":172,"type":"cond-expr","locations":[{"start":{"line":172,"column":31},"end":{"line":172,"column":46}},{"start":{"line":172,"column":49},"end":{"line":172,"column":63}}]},"4":{"line":293,"type":"cond-expr","locations":[{"start":{"line":293,"column":23},"end":{"line":307,"column":7}},{"start":{"line":307,"column":10},"end":{"line":307,"column":12}}]}},"code":["var Menu = require('electron').Menu","var dialog = require('electron').dialog","var pkg = require('../package')","var windows = require('./windows')","var path = require('path')","var t = require('patchwork-translations')","","var isMac = (process.platform == 'darwin')","","function showAbout(win) {","  dialog.showMessageBox(win, {","    title: t('AboutPatchwork'),","    buttons: [t('Close'), t('License')],","    type: 'info',","    icon: path.join(__dirname, '../ui/img/icon.png'),","    message: pkg.name + ' v' + pkg.version,","    detail: pkg.description + '\\n\\n' +","      t('Copyright', {years: '2016-2016'}) + '\\n\\n' +","      'http://ssbc.github.io/patchwork/'","  }, function (btn) {","    if (btn == 1)","      showLicense(win)","  })","}","","function showLicense(win) {","  dialog.showMessageBox(win, {","    title: t('License'),","    buttons: [t('Close')],","    message: pkg.license,","    detail: t('LicenseDialog')","  })","}","","module.exports = function (configOracle) {","  var template = [","    {","      label: t('Patchwork'),","      submenu: [","        {","          label: t('AboutPatchwork'),","          role: 'about',","          click: function (item, win) {","            showAbout(win)","          }","        },","      ].concat(isMac ? [","        {","          type: 'separator'","        },","        {","          label: t('macApp.HidePatchwork'),","          accelerator: 'Command+H',","          selector: 'hide:',","          role: 'hide'","        },","        {","          label: t('macApp.HideOthers'),","          accelerator: 'Option+Command+H',","          selector: 'hideOtherApplications:',","        role: 'hideothers'","        },","        {","          label: t('macApp.ShowAll'),","          selector: 'unhideAllApplications:',","          role: 'unhide'","        },","      ] : [], [","        {","          type: 'separator'","        },","        {","          label: t('Quit'),","          accelerator: 'CmdOrCtrl+Q',","          click: function (item, win) {","            require('electron').app.quit()","          }","        }","      ])","    },","    {","      label: t('Edit'),","      submenu: [","        {","          label: t('Undo'),","          accelerator: 'CmdOrCtrl+Z',","          role: 'undo'","        },","        {","          label: t('Redo'),","          accelerator: 'Shift+CmdOrCtrl+Z',","          role: 'redo'","        },","        {","          type: 'separator'","        },","        {","          label: t('Cut'),","          accelerator: 'CmdOrCtrl+X',","          role: 'cut'","        },","        {","          label: t('Copy'),","          accelerator: 'CmdOrCtrl+C',","          role: 'copy'","        },","        {","          label: t('Paste'),","          accelerator: 'CmdOrCtrl+V',","          role: 'paste'","        },","        {","          label: t('SelectAll'),","          accelerator: 'CmdOrCtrl+A',","          role: 'selectall'","        },","        {","          type: 'separator'","        },","        {","          label: t('Find2'),","          accelerator: 'CmdOrCtrl+F',","          click: function (item, win) {","            win.webContents.executeJavaScript('app.emit(\"focus:find\")')","          }","        },","        {","          label: t('FindNext'),","          accelerator: 'CmdOrCtrl+G',","          click: function (item, win) {","            win.webContents.executeJavaScript('app.emit(\"find:next\")')","          }","        },","        {","          label: t('FindPrevious'),","          accelerator: 'CmdOrCtrl+Shift+G',","          click: function (item, win) {","            win.webContents.executeJavaScript('app.emit(\"find:previous\")')","          }","        }","      ]","    },","    {","      label: t('View'),","      submenu: [","        {","          label: t('ZoomIn'),","          accelerator: 'CmdOrCtrl+=',","          click: function (item, win) {","            win.webContents.executeJavaScript('window.zoom.zoomIn()')","          }","        },","        {","          label: t('ZoomOut'),","          accelerator: 'CmdOrCtrl+-',","          click: function (item, win) {","            win.webContents.executeJavaScript('window.zoom.zoomOut()')","          }","        },","        {","          label: t('NormalSize'),","          accelerator: 'CmdOrCtrl+0',","          click: function (item, win) {","            win.webContents.executeJavaScript('window.zoom.zoomReset()')","          }","        },","        {","          type: 'separator'","        },","        {","          label: t('ToggleDevTools'),","          accelerator: isMac ? 'Alt+Command+I' : 'Ctrl+Shift+I',","          click: function (item, win) { ","            win.toggleDevTools()","          }","        }","      ]","    },","    {","      label: t('Go'),","      submenu: [","        {","          label: t('Back'),","          accelerator: 'Alt+Left',","          click: function (item, win) {","            win.webContents.goBack()","          }","        },","        {","          label: t('Forward'),","          accelerator: 'Alt+Right',","          click: function (item, win) {","            win.webContents.goForward()","          }","        },","        {","          label: t('Reload'),","          accelerator: 'CmdOrCtrl+R',","          click: function (item, win) {","            win.reload()","          }","        },","        {","          type: 'separator'","        },","","        {","          label: t('Inbox'),","          accelerator: 'CmdOrCtrl+1',","          click: function (item, win) {","            win.webContents.executeJavaScript('app.history.pushState(null, \"\")')","          }","        },","        {","          label: t('ActivityFeed'),","          accelerator: 'CmdOrCtrl+2',","          click: function (item, win) {","            win.webContents.executeJavaScript('app.history.pushState(null, \"activity\")')","          }","        },","        {","          label: t('Contacts'),","          accelerator: 'CmdOrCtrl+3',","          click: function (item, win) {","            win.webContents.executeJavaScript('app.history.pushState(null, \"contacts\")')","          }","        },","","        {","          type: 'separator'","        },","","        {","          label: t('NoticesMenuItem'),","          accelerator: 'CmdOrCtrl+Shift+D',","          click: function (item, win) {","            win.webContents.executeJavaScript('app.history.pushState(null, \"notices\")')","          }","        },","        {","          label: t('YourProfile'),","          accelerator: 'CmdOrCtrl+Shift+P',","          click: function (item, win) {","            win.webContents.executeJavaScript('app.history.pushState(null, \"profile/\" + encodeURIComponent(app.user.id))')","          }","        },","","        {","          label: t('NetworkSync'),","          accelerator: 'CmdOrCtrl+4',","          click: function (item, win) {","            win.webContents.executeJavaScript('app.history.pushState(null, \"sync\")')","          }","        },","        {","          label: t('DataFeed'),","          accelerator: 'CmdOrCtrl+5',","          click: function (item, win) {","            win.webContents.executeJavaScript('app.history.pushState(null, \"data\")')","          }","        },","","        {","          type: 'separator'","        },","        {","          label: t('Search'),","          accelerator: 'CmdOrCtrl+K',","          click: function (item, win) {","            win.webContents.executeJavaScript('app.emit(\"focus:search\")')","          }","        }","      ]","    },","    {","      label: 'Window',","      submenu: [","        {","          label: t('NewWindow'),","          accelerator: 'CmdOrCtrl+N',","          click: function (item, win) {","            var newWindow = windows.create()","            newWindow.loadURL(configOracle.getLocalUrl())","          }","        },","        {","          label: t('Close'),","          accelerator: 'CmdOrCtrl+W',","          click: function (item, win) {","            win.close()","          }","        },","      ].concat(isMac ? [","        {","          label: t('Minimize'),","          accelerator: 'CmdOrCtrl+M',","          role: 'minimize'","        },","        {","          type: 'separator'","        },","        {","          label: t('macApp.BringAllToFront'),","          selector: 'arrangeInFront:',","          role: 'front'","        }","      ] : [])","    }","  ]","","  menu = Menu.buildFromTemplate(template)","  Menu.setApplicationMenu(menu)","}"],"l":{"1":2,"2":0,"3":0,"4":0,"5":0,"6":0,"8":0,"10":1,"11":0,"21":0,"22":0,"26":1,"27":0,"35":0,"36":0,"44":0,"76":0,"124":0,"131":0,"138":0,"150":0,"157":0,"164":0,"174":0,"186":0,"193":0,"200":0,"211":0,"218":0,"225":0,"237":0,"244":0,"252":0,"259":0,"270":0,"282":0,"283":0,"290":0,"311":0,"312":0}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/electron/windows.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/electron/windows.js","s":{"1":2,"2":2,"3":0,"4":0,"5":0,"6":0,"7":1,"8":0,"9":0,"10":0,"11":1,"12":0,"13":1,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0},"b":{},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"_createWindow","line":24,"loc":{"start":{"line":24,"column":0},"end":{"line":24,"column":30}}},"2":{"name":"_unref","line":32,"loc":{"start":{"line":32,"column":0},"end":{"line":32,"column":19}}},"3":{"name":"create","line":36,"loc":{"start":{"line":36,"column":0},"end":{"line":36,"column":23}}},"4":{"name":"(anonymous_4)","line":47,"loc":{"start":{"line":47,"column":38},"end":{"line":47,"column":56}}},"5":{"name":"(anonymous_5)","line":58,"loc":{"start":{"line":58,"column":21},"end":{"line":58,"column":33}}},"6":{"name":"(anonymous_6)","line":59,"loc":{"start":{"line":59,"column":31},"end":{"line":59,"column":45}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":26}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":53}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":37}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":29}},"5":{"start":{"line":6,"column":0},"end":{"line":18,"column":1}},"6":{"start":{"line":22,"column":0},"end":{"line":22,"column":17}},"7":{"start":{"line":24,"column":0},"end":{"line":28,"column":1}},"8":{"start":{"line":25,"column":2},"end":{"line":25,"column":38}},"9":{"start":{"line":26,"column":2},"end":{"line":26,"column":30}},"10":{"start":{"line":27,"column":2},"end":{"line":27,"column":15}},"11":{"start":{"line":32,"column":0},"end":{"line":34,"column":1}},"12":{"start":{"line":33,"column":2},"end":{"line":33,"column":26}},"13":{"start":{"line":36,"column":0},"end":{"line":53,"column":1}},"14":{"start":{"line":37,"column":2},"end":{"line":42,"column":10}},"15":{"start":{"line":44,"column":2},"end":{"line":44,"column":34}},"16":{"start":{"line":45,"column":2},"end":{"line":45,"column":36}},"17":{"start":{"line":46,"column":2},"end":{"line":46,"column":36}},"18":{"start":{"line":47,"column":2},"end":{"line":51,"column":4}},"19":{"start":{"line":49,"column":4},"end":{"line":49,"column":22}},"20":{"start":{"line":50,"column":4},"end":{"line":50,"column":27}},"21":{"start":{"line":52,"column":2},"end":{"line":52,"column":15}},"22":{"start":{"line":55,"column":0},"end":{"line":64,"column":1}},"23":{"start":{"line":59,"column":4},"end":{"line":62,"column":6}},"24":{"start":{"line":60,"column":6},"end":{"line":60,"column":31}},"25":{"start":{"line":61,"column":6},"end":{"line":61,"column":31}}},"branchMap":{},"code":["var path = require('path')","var BrowserWindow = require('electron').BrowserWindow","var shell = require('electron').shell","var extend = require('xtend')","","var webPreferences = {","  nodeIntegration: false,","  javascript: true,","  webSecurity: true,","  images: true,","  java: false,","  webgl: false, // maybe allow?","  webaudio: false, // maybe allow?","  plugins: false,","  experimentalFeatures: false,","  experimentalCanvasFeatures: false,","  sharedWorker: false","}","","// retain global references, if not, window will be closed automatically when","// garbage collected","var _windows = {}","","function _createWindow (opts) {","  var window = new BrowserWindow(opts)","  _windows[window.id] = window","  return window","}","","// should not need to be called directly, but just in case","// window.destroy() is ever called","function _unref () {","  delete _windows[this.id]","}","","function create (opts) {","  opts = extend({","    width: 1100,","    height: 800,","    preload: require('path').join(__dirname, '../ui/preload.js'),","    webPreferences: webPreferences","  }, opts)","","  var window = _createWindow(opts)","  window.unref = _unref.bind(window)","  window.once('close', window.unref)","  window.webContents.on('new-window', function (e, url) {","    // open in the browser","    e.preventDefault()","    shell.openExternal(url)","  })","  return window","}","","module.exports = {","  create: create,","  windows: _windows,","  hasVisibleWindows: function () {","    Object.keys(_windows).some(function (id) {","      var window = _windows[id]","      return window.isVisible()","    })","  }","}",""],"l":{"1":2,"2":2,"3":0,"4":0,"6":0,"22":0,"24":1,"25":0,"26":0,"27":0,"32":1,"33":0,"36":1,"37":0,"44":0,"45":0,"46":0,"47":0,"49":0,"50":0,"52":0,"55":0,"59":0,"60":0,"61":0}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/lib/friends-with-gossip-priority.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/lib/friends-with-gossip-priority.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":1,"12":0,"13":1,"14":0,"15":1,"16":1,"17":1,"18":1,"19":0,"20":0,"21":1,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":1,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0},"b":{"1":[0,0,0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0,0],"26":[0,0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0,0],"38":[0,0,0],"39":[0,0],"40":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},"fnMap":{"1":{"name":"isFunction","line":14,"loc":{"start":{"line":14,"column":0},"end":{"line":14,"column":24}}},"2":{"name":"isString","line":18,"loc":{"start":{"line":18,"column":0},"end":{"line":18,"column":22}}},"3":{"name":"isFriend","line":22,"loc":{"start":{"line":22,"column":0},"end":{"line":22,"column":34}}},"4":{"name":"(anonymous_4)","line":30,"loc":{"start":{"line":30,"column":15},"end":{"line":30,"column":39}}},"5":{"name":"awaitSync","line":39,"loc":{"start":{"line":39,"column":2},"end":{"line":39,"column":26}}},"6":{"name":"(anonymous_6)","line":45,"loc":{"start":{"line":45,"column":56},"end":{"line":45,"column":71}}},"7":{"name":"(anonymous_7)","line":48,"loc":{"start":{"line":48,"column":22},"end":{"line":48,"column":36}}},"8":{"name":"(anonymous_8)","line":54,"loc":{"start":{"line":54,"column":36},"end":{"line":54,"column":51}}},"9":{"name":"(anonymous_9)","line":66,"loc":{"start":{"line":66,"column":46},"end":{"line":66,"column":62}}},"10":{"name":"(anonymous_10)","line":86,"loc":{"start":{"line":86,"column":20},"end":{"line":86,"column":36}}},"11":{"name":"(anonymous_11)","line":92,"loc":{"start":{"line":92,"column":21},"end":{"line":92,"column":42}}},"12":{"name":"(anonymous_12)","line":99,"loc":{"start":{"line":99,"column":16},"end":{"line":99,"column":28}}},"13":{"name":"(anonymous_13)","line":104,"loc":{"start":{"line":104,"column":21},"end":{"line":104,"column":37}}},"14":{"name":"(anonymous_14)","line":111,"loc":{"start":{"line":111,"column":37},"end":{"line":111,"column":53}}},"15":{"name":"(anonymous_15)","line":119,"loc":{"start":{"line":119,"column":32},"end":{"line":119,"column":44}}},"16":{"name":"push","line":123,"loc":{"start":{"line":123,"column":6},"end":{"line":123,"column":31}}},"17":{"name":"(anonymous_17)","line":136,"loc":{"start":{"line":136,"column":14},"end":{"line":136,"column":37}}},"18":{"name":"(anonymous_18)","line":146,"loc":{"start":{"line":146,"column":22},"end":{"line":146,"column":56}}},"19":{"name":"(anonymous_19)","line":173,"loc":{"start":{"line":173,"column":16},"end":{"line":173,"column":28}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":40}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":40}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":37}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":42}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":42}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":39}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":54}},"8":{"start":{"line":8,"column":0},"end":{"line":8,"column":59}},"9":{"start":{"line":14,"column":0},"end":{"line":16,"column":1}},"10":{"start":{"line":15,"column":2},"end":{"line":15,"column":32}},"11":{"start":{"line":18,"column":0},"end":{"line":20,"column":1}},"12":{"start":{"line":19,"column":2},"end":{"line":19,"column":30}},"13":{"start":{"line":22,"column":0},"end":{"line":24,"column":1}},"14":{"start":{"line":23,"column":2},"end":{"line":23,"column":67}},"15":{"start":{"line":26,"column":0},"end":{"line":26,"column":24}},"16":{"start":{"line":27,"column":0},"end":{"line":27,"column":25}},"17":{"start":{"line":28,"column":0},"end":{"line":28,"column":39}},"18":{"start":{"line":30,"column":0},"end":{"line":178,"column":1}},"19":{"start":{"line":32,"column":2},"end":{"line":35,"column":3}},"20":{"start":{"line":38,"column":2},"end":{"line":38,"column":18}},"21":{"start":{"line":39,"column":2},"end":{"line":42,"column":3}},"22":{"start":{"line":40,"column":4},"end":{"line":41,"column":13}},"23":{"start":{"line":40,"column":17},"end":{"line":40,"column":33}},"24":{"start":{"line":41,"column":9},"end":{"line":41,"column":13}},"25":{"start":{"line":45,"column":2},"end":{"line":82,"column":5}},"26":{"start":{"line":47,"column":4},"end":{"line":62,"column":5}},"27":{"start":{"line":48,"column":6},"end":{"line":48,"column":45}},"28":{"start":{"line":48,"column":38},"end":{"line":48,"column":43}},"29":{"start":{"line":49,"column":6},"end":{"line":49,"column":20}},"30":{"start":{"line":51,"column":6},"end":{"line":59,"column":7}},"31":{"start":{"line":53,"column":8},"end":{"line":53,"column":47}},"32":{"start":{"line":54,"column":8},"end":{"line":58,"column":10}},"33":{"start":{"line":55,"column":10},"end":{"line":57,"column":11}},"34":{"start":{"line":56,"column":12},"end":{"line":56,"column":44}},"35":{"start":{"line":61,"column":6},"end":{"line":61,"column":12}},"36":{"start":{"line":64,"column":4},"end":{"line":64,"column":29}},"37":{"start":{"line":65,"column":4},"end":{"line":81,"column":5}},"38":{"start":{"line":66,"column":6},"end":{"line":80,"column":8}},"39":{"start":{"line":67,"column":8},"end":{"line":73,"column":9}},"40":{"start":{"line":68,"column":10},"end":{"line":71,"column":58}},"41":{"start":{"line":69,"column":12},"end":{"line":69,"column":65}},"42":{"start":{"line":71,"column":12},"end":{"line":71,"column":58}},"43":{"start":{"line":74,"column":8},"end":{"line":79,"column":9}},"44":{"start":{"line":75,"column":10},"end":{"line":78,"column":56}},"45":{"start":{"line":76,"column":12},"end":{"line":76,"column":68}},"46":{"start":{"line":78,"column":12},"end":{"line":78,"column":56}},"47":{"start":{"line":84,"column":2},"end":{"line":177,"column":3}},"48":{"start":{"line":87,"column":6},"end":{"line":87,"column":44}},"49":{"start":{"line":88,"column":6},"end":{"line":88,"column":59}},"50":{"start":{"line":88,"column":13},"end":{"line":88,"column":59}},"51":{"start":{"line":89,"column":6},"end":{"line":89,"column":42}},"52":{"start":{"line":93,"column":6},"end":{"line":96,"column":7}},"53":{"start":{"line":94,"column":8},"end":{"line":94,"column":18}},"54":{"start":{"line":95,"column":8},"end":{"line":95,"column":20}},"55":{"start":{"line":97,"column":6},"end":{"line":98,"column":24}},"56":{"start":{"line":98,"column":8},"end":{"line":98,"column":24}},"57":{"start":{"line":99,"column":6},"end":{"line":101,"column":8}},"58":{"start":{"line":100,"column":8},"end":{"line":100,"column":63}},"59":{"start":{"line":105,"column":6},"end":{"line":106,"column":44}},"60":{"start":{"line":106,"column":8},"end":{"line":106,"column":44}},"61":{"start":{"line":107,"column":6},"end":{"line":107,"column":37}},"62":{"start":{"line":112,"column":6},"end":{"line":112,"column":23}},"63":{"start":{"line":113,"column":6},"end":{"line":113,"column":35}},"64":{"start":{"line":114,"column":6},"end":{"line":114,"column":35}},"65":{"start":{"line":115,"column":6},"end":{"line":115,"column":39}},"66":{"start":{"line":116,"column":6},"end":{"line":116,"column":48}},"67":{"start":{"line":117,"column":6},"end":{"line":118,"column":67}},"68":{"start":{"line":118,"column":8},"end":{"line":118,"column":67}},"69":{"start":{"line":119,"column":6},"end":{"line":121,"column":8}},"70":{"start":{"line":120,"column":8},"end":{"line":120,"column":26}},"71":{"start":{"line":123,"column":6},"end":{"line":125,"column":7}},"72":{"start":{"line":124,"column":8},"end":{"line":124,"column":56}},"73":{"start":{"line":128,"column":6},"end":{"line":129,"column":22}},"74":{"start":{"line":129,"column":8},"end":{"line":129,"column":22}},"75":{"start":{"line":131,"column":6},"end":{"line":131,"column":37}},"76":{"start":{"line":132,"column":6},"end":{"line":139,"column":8}},"77":{"start":{"line":137,"column":10},"end":{"line":137,"column":41}},"78":{"start":{"line":137,"column":27},"end":{"line":137,"column":41}},"79":{"start":{"line":141,"column":6},"end":{"line":141,"column":38}},"80":{"start":{"line":141,"column":18},"end":{"line":141,"column":27}},"81":{"start":{"line":141,"column":28},"end":{"line":141,"column":37}},"82":{"start":{"line":143,"column":6},"end":{"line":143,"column":15}},"83":{"start":{"line":147,"column":6},"end":{"line":153,"column":7}},"84":{"start":{"line":148,"column":8},"end":{"line":148,"column":17}},"85":{"start":{"line":149,"column":8},"end":{"line":149,"column":19}},"86":{"start":{"line":150,"column":13},"end":{"line":153,"column":7}},"87":{"start":{"line":151,"column":8},"end":{"line":151,"column":18}},"88":{"start":{"line":152,"column":8},"end":{"line":152,"column":27}},"89":{"start":{"line":154,"column":6},"end":{"line":154,"column":23}},"90":{"start":{"line":155,"column":6},"end":{"line":162,"column":7}},"91":{"start":{"line":157,"column":8},"end":{"line":157,"column":26}},"92":{"start":{"line":158,"column":13},"end":{"line":162,"column":7}},"93":{"start":{"line":160,"column":8},"end":{"line":161,"column":28}},"94":{"start":{"line":161,"column":10},"end":{"line":161,"column":28}},"95":{"start":{"line":164,"column":6},"end":{"line":164,"column":37}},"96":{"start":{"line":165,"column":6},"end":{"line":165,"column":42}},"97":{"start":{"line":166,"column":6},"end":{"line":166,"column":53}},"98":{"start":{"line":167,"column":6},"end":{"line":167,"column":51}},"99":{"start":{"line":169,"column":6},"end":{"line":169,"column":39}},"100":{"start":{"line":170,"column":6},"end":{"line":171,"column":58}},"101":{"start":{"line":171,"column":8},"end":{"line":171,"column":58}},"102":{"start":{"line":173,"column":6},"end":{"line":175,"column":8}},"103":{"start":{"line":174,"column":8},"end":{"line":174,"column":34}}},"branchMap":{"1":{"line":23,"type":"binary-expr","locations":[{"start":{"line":23,"column":9},"end":{"line":23,"column":19}},{"start":{"line":23,"column":23},"end":{"line":23,"column":33}},{"start":{"line":23,"column":37},"end":{"line":23,"column":50}},{"start":{"line":23,"column":54},"end":{"line":23,"column":67}}]},"2":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":4},"end":{"line":40,"column":4}},{"start":{"line":40,"column":4},"end":{"line":40,"column":4}}]},"3":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":4},"end":{"line":47,"column":4}},{"start":{"line":47,"column":4},"end":{"line":47,"column":4}}]},"4":{"line":51,"type":"if","locations":[{"start":{"line":51,"column":6},"end":{"line":51,"column":6}},{"start":{"line":51,"column":6},"end":{"line":51,"column":6}}]},"5":{"line":55,"type":"if","locations":[{"start":{"line":55,"column":10},"end":{"line":55,"column":10}},{"start":{"line":55,"column":10},"end":{"line":55,"column":10}}]},"6":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":4},"end":{"line":65,"column":4}},{"start":{"line":65,"column":4},"end":{"line":65,"column":4}}]},"7":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":8},"end":{"line":67,"column":8}},{"start":{"line":67,"column":8},"end":{"line":67,"column":8}}]},"8":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":10},"end":{"line":68,"column":10}},{"start":{"line":68,"column":10},"end":{"line":68,"column":10}}]},"9":{"line":74,"type":"if","locations":[{"start":{"line":74,"column":8},"end":{"line":74,"column":8}},{"start":{"line":74,"column":8},"end":{"line":74,"column":8}}]},"10":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":10},"end":{"line":75,"column":10}},{"start":{"line":75,"column":10},"end":{"line":75,"column":10}}]},"11":{"line":87,"type":"binary-expr","locations":[{"start":{"line":87,"column":21},"end":{"line":87,"column":31}},{"start":{"line":87,"column":35},"end":{"line":87,"column":43}}]},"12":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":6},"end":{"line":88,"column":6}},{"start":{"line":88,"column":6},"end":{"line":88,"column":6}}]},"13":{"line":93,"type":"if","locations":[{"start":{"line":93,"column":6},"end":{"line":93,"column":6}},{"start":{"line":93,"column":6},"end":{"line":93,"column":6}}]},"14":{"line":97,"type":"if","locations":[{"start":{"line":97,"column":6},"end":{"line":97,"column":6}},{"start":{"line":97,"column":6},"end":{"line":97,"column":6}}]},"15":{"line":100,"type":"cond-expr","locations":[{"start":{"line":100,"column":33},"end":{"line":100,"column":55}},{"start":{"line":100,"column":58},"end":{"line":100,"column":62}}]},"16":{"line":105,"type":"if","locations":[{"start":{"line":105,"column":6},"end":{"line":105,"column":6}},{"start":{"line":105,"column":6},"end":{"line":105,"column":6}}]},"17":{"line":112,"type":"binary-expr","locations":[{"start":{"line":112,"column":13},"end":{"line":112,"column":17}},{"start":{"line":112,"column":21},"end":{"line":112,"column":23}}]},"18":{"line":115,"type":"binary-expr","locations":[{"start":{"line":115,"column":18},"end":{"line":115,"column":28}},{"start":{"line":115,"column":32},"end":{"line":115,"column":39}}]},"19":{"line":116,"type":"binary-expr","locations":[{"start":{"line":116,"column":25},"end":{"line":116,"column":35}},{"start":{"line":116,"column":39},"end":{"line":116,"column":47}}]},"20":{"line":117,"type":"if","locations":[{"start":{"line":117,"column":6},"end":{"line":117,"column":6}},{"start":{"line":117,"column":6},"end":{"line":117,"column":6}}]},"21":{"line":120,"type":"binary-expr","locations":[{"start":{"line":120,"column":8},"end":{"line":120,"column":14}},{"start":{"line":120,"column":18},"end":{"line":120,"column":26}}]},"22":{"line":124,"type":"cond-expr","locations":[{"start":{"line":124,"column":30},"end":{"line":124,"column":50}},{"start":{"line":124,"column":53},"end":{"line":124,"column":55}}]},"23":{"line":128,"type":"if","locations":[{"start":{"line":128,"column":6},"end":{"line":128,"column":6}},{"start":{"line":128,"column":6},"end":{"line":128,"column":6}}]},"24":{"line":131,"type":"binary-expr","locations":[{"start":{"line":131,"column":17},"end":{"line":131,"column":31}},{"start":{"line":131,"column":35},"end":{"line":131,"column":37}}]},"25":{"line":134,"type":"binary-expr","locations":[{"start":{"line":134,"column":14},"end":{"line":134,"column":23}},{"start":{"line":134,"column":27},"end":{"line":134,"column":36}},{"start":{"line":134,"column":40},"end":{"line":134,"column":41}}]},"26":{"line":135,"type":"binary-expr","locations":[{"start":{"line":135,"column":13},"end":{"line":135,"column":24}},{"start":{"line":135,"column":28},"end":{"line":135,"column":39}},{"start":{"line":135,"column":43},"end":{"line":135,"column":46}}]},"27":{"line":137,"type":"if","locations":[{"start":{"line":137,"column":10},"end":{"line":137,"column":10}},{"start":{"line":137,"column":10},"end":{"line":137,"column":10}}]},"28":{"line":141,"type":"if","locations":[{"start":{"line":141,"column":6},"end":{"line":141,"column":6}},{"start":{"line":141,"column":6},"end":{"line":141,"column":6}}]},"29":{"line":147,"type":"if","locations":[{"start":{"line":147,"column":6},"end":{"line":147,"column":6}},{"start":{"line":147,"column":6},"end":{"line":147,"column":6}}]},"30":{"line":150,"type":"if","locations":[{"start":{"line":150,"column":13},"end":{"line":150,"column":13}},{"start":{"line":150,"column":13},"end":{"line":150,"column":13}}]},"31":{"line":154,"type":"binary-expr","locations":[{"start":{"line":154,"column":13},"end":{"line":154,"column":17}},{"start":{"line":154,"column":21},"end":{"line":154,"column":23}}]},"32":{"line":155,"type":"if","locations":[{"start":{"line":155,"column":6},"end":{"line":155,"column":6}},{"start":{"line":155,"column":6},"end":{"line":155,"column":6}}]},"33":{"line":158,"type":"if","locations":[{"start":{"line":158,"column":13},"end":{"line":158,"column":13}},{"start":{"line":158,"column":13},"end":{"line":158,"column":13}}]},"34":{"line":158,"type":"binary-expr","locations":[{"start":{"line":158,"column":17},"end":{"line":158,"column":22}},{"start":{"line":158,"column":26},"end":{"line":158,"column":50}}]},"35":{"line":164,"type":"binary-expr","locations":[{"start":{"line":164,"column":17},"end":{"line":164,"column":31}},{"start":{"line":164,"column":35},"end":{"line":164,"column":37}}]},"36":{"line":165,"type":"binary-expr","locations":[{"start":{"line":165,"column":20},"end":{"line":165,"column":30}},{"start":{"line":165,"column":35},"end":{"line":165,"column":42}}]},"37":{"line":166,"type":"binary-expr","locations":[{"start":{"line":166,"column":20},"end":{"line":166,"column":31}},{"start":{"line":166,"column":35},"end":{"line":166,"column":46}},{"start":{"line":166,"column":50},"end":{"line":166,"column":53}}]},"38":{"line":167,"type":"binary-expr","locations":[{"start":{"line":167,"column":20},"end":{"line":167,"column":29}},{"start":{"line":167,"column":35},"end":{"line":167,"column":44}},{"start":{"line":167,"column":50},"end":{"line":167,"column":51}}]},"39":{"line":169,"type":"binary-expr","locations":[{"start":{"line":169,"column":21},"end":{"line":169,"column":26}},{"start":{"line":169,"column":30},"end":{"line":169,"column":38}}]},"40":{"line":170,"type":"if","locations":[{"start":{"line":170,"column":6},"end":{"line":170,"column":6}},{"start":{"line":170,"column":6},"end":{"line":170,"column":6}}]}},"code":["var Graphmitter = require('graphmitter')","var pull        = require('pull-stream')","var mlib        = require('ssb-msgs')","var memview     = require('level-memview')","var pushable    = require('pull-pushable')","var mdm         = require('mdmanifest')","var valid       = require('scuttlebot/lib/validators')","var apidoc      = require('scuttlebot/lib/apidocs').friends","","// friends plugin","// methods to analyze the social graph","// maintains a 'follow' and 'flag' graph","","function isFunction (f) {","  return 'function' === typeof f","}","","function isString (s) {","  return 'string' === typeof s","}","","function isFriend (friends, a, b) {","  return friends[a] && friends[b] && friends[a][b] && friends[b][a]","}","","exports.name = 'friends'","exports.version = '1.0.0'","exports.manifest = mdm.manifest(apidoc)","","exports.init = function (sbot, config) {","","  var graphs = {","    follow: new Graphmitter(),","    flag: new Graphmitter()","  }","","  // view processor","  var syncCbs = []","  function awaitSync (cb) {","    if (syncCbs) syncCbs.push(cb)","    else cb()","  }","","  // read/watch the log for changes to the social graph","  pull(sbot.createLogStream({ live: true }), pull.drain(function (msg) {","","    if (msg.sync) {","      syncCbs.forEach(function (cb) { cb() })","      syncCbs = null","","      if (sbot.gossip) {","        // prioritize friends","        var friends = graphs['follow'].toJSON()","        sbot.gossip.peers().forEach(function(peer) {","          if (isFriend(friends, sbot.id, peer.key)) {","            sbot.gossip.add(peer, 'friends')","          }","        })","      }","","      return","    }","","    var c = msg.value.content","    if (c.type == 'contact') {","      mlib.asLinks(c.contact, 'feed').forEach(function (link) {","        if ('following' in c) {","          if (c.following)","            graphs.follow.edge(msg.value.author, link.link, true)","          else","            graphs.follow.del(msg.value.author, link.link)","","        }","        if ('flagged' in c) {","          if (c.flagged)","            graphs.flag.edge(msg.value.author, link.link, c.flagged)","          else","            graphs.flag.del(msg.value.author, link.link)","        }","      })","    }","  }))","","  return {","","    get: valid.sync(function (opts) {","      var g = graphs[opts.graph || 'follow']","      if(!g) throw new Error('opts.graph must be provided')","      return g.get(opts.source, opts.dest)","    }, 'object?'),","","    all: valid.async(function (graph, cb) {","      if (typeof graph == 'function') {","        cb = graph","        graph = null","      }","      if (!graph)","        graph = 'follow'","      awaitSync(function () {","        cb(null, graphs[graph] ? graphs[graph].toJSON() : null)","      })","    }, 'string?'),","","    path: valid.sync(function (opts) {","      if(isString(opts))","        opts = {source: sbot.id, dest: opts}","      return graphs.follow.path(opts)","","    }, 'string|object'),","","    createFriendStream: valid.source(function (opts) {","      opts = opts || {}","      var live = opts.live === true","      var meta = opts.meta === true","      var start = opts.start || sbot.id","      var graph = graphs[opts.graph || 'follow']","      if(!graph)","        return pull.error(new Error('unknown graph:' + opts.graph))","      var cancel, ps = pushable(function () {","        cancel && cancel()","      })","","      function push (to, hops) {","        return ps.push(meta ? {id: to, hops: hops} : to)","      }","","      //by default, also emit your own key.","      if(opts.self !== false)","        push(start, 0)","","      var conf = config.friends || {}","      cancel = graph.traverse({","        start: start,","        hops: opts.hops || conf.hops || 3,","        max: opts.dunbar || conf.dunbar || 150,","        each: function (_, to, hops) {","          if(to !== start) push(to, hops)","        }","      })","","      if(!live) { cancel(); ps.end() }","","      return ps","    }, 'createFriendStreamOpts?'),","","    hops: valid.async(function (start, graph, opts, cb) {","      if (typeof opts == 'function') { // (start|opts, graph, cb)","        cb = opts","        opts = null","      } else if (typeof graph == 'function') { // (start|opts, cb)","        cb = graph","        opts = graph = null","      }","      opts = opts || {}","      if(isString(start)) { // (start, ...)","        // first arg is id string","        opts.start = start","      } else if (start && typeof start == 'object') { // (opts, ...)","        // first arg is opts","        for (var k in start)","          opts[k] = start[k]","      }","","      var conf = config.friends || {}","      opts.start  = opts.start  || sbot.id","      opts.dunbar = opts.dunbar || conf.dunbar || 150","      opts.hops   = opts.hops   || conf.hops   || 3","","      var g = graphs[graph || 'follow']","      if (!g)","        return cb(new Error('Invalid graph type: '+graph))","","      awaitSync(function () {","        cb(null, g.traverse(opts))","      })","    }, ['feedId', 'string?', 'object?'], ['createFriendStreamOpts'])","  }","}",""],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"14":1,"15":0,"18":1,"19":0,"22":1,"23":0,"26":1,"27":1,"28":1,"30":1,"32":0,"38":0,"39":1,"40":0,"41":0,"45":0,"47":0,"48":0,"49":0,"51":0,"53":0,"54":0,"55":0,"56":0,"61":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"71":0,"74":0,"75":0,"76":0,"78":0,"84":0,"87":0,"88":0,"89":0,"93":0,"94":0,"95":0,"97":0,"98":0,"99":0,"100":0,"105":0,"106":0,"107":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"123":1,"124":0,"128":0,"129":0,"131":0,"132":0,"137":0,"141":0,"143":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"154":0,"155":0,"157":0,"158":0,"160":0,"161":0,"164":0,"165":0,"166":0,"167":0,"169":0,"170":0,"171":0,"173":0,"174":0}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/ui/loading.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/ui/loading.js","s":{"1":2,"2":2,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":1,"10":0,"11":0,"12":2,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":2,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":3,"loc":{"start":{"line":3,"column":1},"end":{"line":3,"column":13}}},"2":{"name":"tryLocale","line":28,"loc":{"start":{"line":28,"column":0},"end":{"line":28,"column":27}}},"3":{"name":"t","line":34,"loc":{"start":{"line":34,"column":0},"end":{"line":34,"column":16}}},"4":{"name":"(anonymous_4)","line":41,"loc":{"start":{"line":41,"column":26},"end":{"line":41,"column":39}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":65,"column":4}},"2":{"start":{"line":5,"column":0},"end":{"line":26,"column":1}},"3":{"start":{"line":28,"column":0},"end":{"line":32,"column":1}},"4":{"start":{"line":29,"column":2},"end":{"line":29,"column":38}},"5":{"start":{"line":29,"column":25},"end":{"line":29,"column":38}},"6":{"start":{"line":30,"column":2},"end":{"line":30,"column":48}},"7":{"start":{"line":31,"column":2},"end":{"line":31,"column":38}},"8":{"start":{"line":31,"column":25},"end":{"line":31,"column":38}},"9":{"start":{"line":34,"column":0},"end":{"line":39,"column":1}},"10":{"start":{"line":35,"column":2},"end":{"line":37,"column":19}},"11":{"start":{"line":38,"column":2},"end":{"line":38,"column":29}},"12":{"start":{"line":41,"column":0},"end":{"line":60,"column":1}},"13":{"start":{"line":42,"column":2},"end":{"line":42,"column":29}},"14":{"start":{"line":45,"column":2},"end":{"line":45,"column":59}},"15":{"start":{"line":48,"column":2},"end":{"line":48,"column":39}},"16":{"start":{"line":49,"column":2},"end":{"line":49,"column":34}},"17":{"start":{"line":50,"column":2},"end":{"line":50,"column":26}},"18":{"start":{"line":51,"column":2},"end":{"line":51,"column":31}},"19":{"start":{"line":54,"column":2},"end":{"line":54,"column":41}},"20":{"start":{"line":55,"column":2},"end":{"line":55,"column":27}},"21":{"start":{"line":56,"column":2},"end":{"line":56,"column":28}},"22":{"start":{"line":57,"column":2},"end":{"line":57,"column":51}},"23":{"start":{"line":58,"column":2},"end":{"line":58,"column":77}},"24":{"start":{"line":59,"column":2},"end":{"line":59,"column":32}},"25":{"start":{"line":61,"column":0},"end":{"line":61,"column":57}},"26":{"start":{"line":63,"column":0},"end":{"line":63,"column":55}}},"branchMap":{"1":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":2},"end":{"line":29,"column":2}},{"start":{"line":29,"column":2},"end":{"line":29,"column":2}}]},"2":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":2},"end":{"line":31,"column":2}},{"start":{"line":31,"column":2},"end":{"line":31,"column":2}}]},"3":{"line":35,"type":"binary-expr","locations":[{"start":{"line":35,"column":15},"end":{"line":35,"column":45}},{"start":{"line":36,"column":15},"end":{"line":36,"column":44}},{"start":{"line":37,"column":15},"end":{"line":37,"column":19}}]},"4":{"line":42,"type":"binary-expr","locations":[{"start":{"line":42,"column":16},"end":{"line":42,"column":23}},{"start":{"line":42,"column":27},"end":{"line":42,"column":28}}]},"5":{"line":58,"type":"cond-expr","locations":[{"start":{"line":58,"column":29},"end":{"line":58,"column":64}},{"start":{"line":58,"column":68},"end":{"line":58,"column":77}}]},"6":{"line":58,"type":"binary-expr","locations":[{"start":{"line":58,"column":29},"end":{"line":58,"column":42}},{"start":{"line":58,"column":46},"end":{"line":58,"column":64}}]}},"code":["// setup basic error-handling, in case app fails to load","","(function () {","","var locales = {","  da: {","    LoadingError: \"Beklager! Patchwork løbt ind i den fejl under indlæsning.\",","    Loading: \"Indlæser...\"","  },","  en: {","    LoadingError: \"We're sorry! Patchwork experienced an error while loading.\",","    Loading: \"Loading...\"","  },","  \"pt-BR\": {","    LoadingError: \"Lamentamos! Ocorreu um erro ao carregar o Patchwork.\",","    Loading: \"Carregando...\"","  },","  \"pt-PT\": {","    LoadingError: \"Pedimos desculpa! Ocorreu um erro ao carregar o Patchwork.\",","    Loading: \"Carregando...\"","  },","  \"zh-cn\": {","    LoadingError: \"抱歉！Patchwork加载时出现问题。\",","    Loading: \"载入中...\"","  }","}","","function tryLocale(locale) {","  if (locale in locales) return locale","  locale = String(locale).replace(/[._].*$/, '')","  if (locale in locales) return locale","}","","function t(str) {","  var locale = tryLocale(localStorage.locale)","            || tryLocale(navigator.language)","            || 'en'","  return locales[locale][str]","}","","window.loadErrorHandler = function (e) {","  console.error(e.error || e)","","  // hide spinner","  document.querySelector('.loading').style.display = 'none'","","  // render heading","  var h1 = document.createElement('h1')","  h1.innerText = t('LoadingError')","  h1.style.margin = '10px'","  document.body.appendChild(h1)","","  // render stack","  var pre = document.createElement('pre')","  pre.style.margin = '10px'","  pre.style.padding = '10px'","  pre.style.boxShadow = '0 2px 4px rgba(0,0,0,0.1)'","  pre.innerText = e.error ? (e.error.stack || e.error.toString()) : e.message","  document.body.appendChild(pre)","}","window.addEventListener('error', window.loadErrorHandler)","","document.querySelector('.loading').title = t('Loading')","","})()"],"l":{"3":2,"5":2,"28":1,"29":0,"30":0,"31":0,"34":1,"35":0,"38":0,"41":2,"42":0,"45":0,"48":0,"49":0,"50":0,"51":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"61":0,"63":0}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/ui/main.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/ui/main.js","s":{"1":2,"2":2,"3":2,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1,"16":0,"17":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":21,"loc":{"start":{"line":21,"column":21},"end":{"line":21,"column":33}}},"2":{"name":"onError","line":38,"loc":{"start":{"line":38,"column":0},"end":{"line":38,"column":21}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":37}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":35}},"3":{"start":{"line":10,"column":0},"end":{"line":10,"column":33}},"4":{"start":{"line":11,"column":0},"end":{"line":11,"column":18}},"5":{"start":{"line":14,"column":0},"end":{"line":14,"column":41}},"6":{"start":{"line":17,"column":0},"end":{"line":17,"column":41}},"7":{"start":{"line":18,"column":0},"end":{"line":18,"column":54}},"8":{"start":{"line":21,"column":0},"end":{"line":33,"column":2}},"9":{"start":{"line":24,"column":2},"end":{"line":25,"column":44}},"10":{"start":{"line":25,"column":4},"end":{"line":25,"column":44}},"11":{"start":{"line":29,"column":2},"end":{"line":29,"column":38}},"12":{"start":{"line":30,"column":2},"end":{"line":30,"column":63}},"13":{"start":{"line":31,"column":2},"end":{"line":31,"column":68}},"14":{"start":{"line":32,"column":2},"end":{"line":32,"column":62}},"15":{"start":{"line":38,"column":0},"end":{"line":41,"column":1}},"16":{"start":{"line":39,"column":2},"end":{"line":39,"column":20}},"17":{"start":{"line":40,"column":2},"end":{"line":40,"column":86}}},"branchMap":{"1":{"line":18,"type":"binary-expr","locations":[{"start":{"line":18,"column":12},"end":{"line":18,"column":31}},{"start":{"line":18,"column":35},"end":{"line":18,"column":53}}]},"2":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":2},"end":{"line":24,"column":2}},{"start":{"line":24,"column":2},"end":{"line":24,"column":2}}]},"3":{"line":40,"type":"binary-expr","locations":[{"start":{"line":40,"column":37},"end":{"line":40,"column":44}},{"start":{"line":40,"column":48},"end":{"line":40,"column":49}}]}},"code":["'use strict'","","var pull     = require('pull-stream')","var ReactDOM = require('react-dom')","","// Init","// ====","","// master state object","window.app = require('./lib/app')","window.pull = pull // pull is useful for debugging","","// toplevel events","window.addEventListener('error', onError)","","// init language","var t = require('patchwork-translations')","t.setLocale(localStorage.locale || navigator.language)","","// render","app.fetchLatestState(function () {","  // redirect to contacts page if new-user setup is occurring","  // that's where where we want the user to land after the modal flow","  if (app.user.needsSetup)","    app.history.pushState(null, '/contacts')","","","  // begin rendering","  var routes = require('./routes.jsx')","  document.body.removeChild(document.querySelector('.loading'))","  ReactDOM.render(routes.routes, document.body.querySelector('div'))","  window.removeEventListener('error', window.loadErrorHandler)","})","","// Handlers","// ========","","function onError (e) {","  e.preventDefault()","  app.minorIssue('Unexpected Error', e.error || e, 'This was an unhandled exception.')","}"],"l":{"3":2,"4":2,"10":2,"11":0,"14":0,"17":0,"18":0,"21":0,"24":0,"25":0,"29":0,"30":0,"31":0,"32":0,"38":1,"39":0,"40":0}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/ui/preload.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/ui/preload.js","s":{"1":2,"2":2,"3":0,"4":0},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":39}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":20}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":74}},"4":{"start":{"line":8,"column":0},"end":{"line":8,"column":40}}},"branchMap":{},"code":["console.log('Running electron preload')","window.electron = {}","","// add context menu","window.addEventListener('contextmenu', require('./electron/context-menu'))","","// add zoom controls","window.zoom = require('./electron/zoom')"],"l":{"1":2,"2":2,"5":0,"8":0}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/lib/persistent-gossip/init.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/lib/persistent-gossip/init.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":5,"loc":{"start":{"line":5,"column":17},"end":{"line":5,"column":51}}},"2":{"name":"(anonymous_2)","line":11,"loc":{"start":{"line":11,"column":11},"end":{"line":11,"column":27}}},"3":{"name":"(anonymous_3)","line":18,"loc":{"start":{"line":18,"column":15},"end":{"line":18,"column":30}}},"4":{"name":"(anonymous_4)","line":27,"loc":{"start":{"line":27,"column":21},"end":{"line":27,"column":38}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":27}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":33}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":28}},"4":{"start":{"line":5,"column":0},"end":{"line":31,"column":1}},"5":{"start":{"line":8,"column":2},"end":{"line":10,"column":3}},"6":{"start":{"line":10,"column":3},"end":{"line":11,"column":56}},"7":{"start":{"line":11,"column":29},"end":{"line":11,"column":54}},"8":{"start":{"line":14,"column":2},"end":{"line":24,"column":3}},"9":{"start":{"line":19,"column":6},"end":{"line":19,"column":25}},"10":{"start":{"line":19,"column":19},"end":{"line":19,"column":25}},"11":{"start":{"line":20,"column":6},"end":{"line":20,"column":37}},"12":{"start":{"line":20,"column":31},"end":{"line":20,"column":37}},"13":{"start":{"line":21,"column":6},"end":{"line":22,"column":46}},"14":{"start":{"line":22,"column":8},"end":{"line":22,"column":46}},"15":{"start":{"line":27,"column":2},"end":{"line":29,"column":4}},"16":{"start":{"line":28,"column":4},"end":{"line":28,"column":30}}},"branchMap":{"1":{"line":10,"type":"cond-expr","locations":[{"start":{"line":10,"column":22},"end":{"line":10,"column":27}},{"start":{"line":10,"column":30},"end":{"line":10,"column":37}}]},"2":{"line":19,"type":"if","locations":[{"start":{"line":19,"column":6},"end":{"line":19,"column":6}},{"start":{"line":19,"column":6},"end":{"line":19,"column":6}}]},"3":{"line":20,"type":"if","locations":[{"start":{"line":20,"column":6},"end":{"line":20,"column":6}},{"start":{"line":20,"column":6},"end":{"line":20,"column":6}}]},"4":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":6},"end":{"line":21,"column":6}},{"start":{"line":21,"column":6},"end":{"line":21,"column":6}}]}},"code":["var isArray = Array.isArray","var pull = require('pull-stream')","var ref = require('ssb-ref')","","module.exports = function (gossip, config, server) {","","  // populate peertable with configured seeds (mainly used in testing)","  var seeds = config.seeds","","  ;(isArray(seeds)  ? seeds : [seeds]).filter(Boolean)","  .forEach(function (addr) { gossip.add(addr, 'seed') })","","  // populate peertable with pub announcements on the feed","  pull(","    server.messagesByType({","      type: 'pub', live: true, keys: false","    }),","    pull.drain(function (msg) {","      if(msg.sync) return","      if(!msg.content.address) return","      if(ref.isAddress(msg.content.address))","        gossip.add(msg.content.address, 'pub')","    })","  )","","  // populate peertable with announcements on the LAN multicast","  server.on('local', function (_peer) {","    gossip.add(_peer, 'local')","  })","","}",""],"l":{"1":1,"2":1,"3":1,"5":1,"8":0,"10":0,"11":0,"14":0,"19":0,"20":0,"21":0,"22":0,"27":0,"28":0}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/lib/persistent-gossip/schedule.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/lib/persistent-gossip/schedule.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":1,"10":0,"11":0,"12":0,"13":0,"14":1,"15":0,"16":1,"17":0,"18":1,"19":0,"20":1,"21":0,"22":0,"23":0,"24":1,"25":1,"26":0,"27":1,"28":0,"29":1,"30":0,"31":1,"32":0,"33":1,"34":0,"35":1,"36":0,"37":1,"38":0,"39":1,"40":0,"41":0,"42":1,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":1,"54":0,"55":0,"56":0,"57":1,"58":0,"59":0,"60":0,"61":0,"62":1,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":1,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":1,"105":1,"106":1,"107":1,"108":1,"109":1,"110":1,"111":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0,0],"6":[0,0,0],"7":[0,0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0,0],"21":[0,0],"22":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0},"fnMap":{"1":{"name":"not","line":8,"loc":{"start":{"line":8,"column":0},"end":{"line":8,"column":18}}},"2":{"name":"(anonymous_2)","line":9,"loc":{"start":{"line":9,"column":9},"end":{"line":9,"column":22}}},"3":{"name":"and","line":12,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":16}}},"4":{"name":"(anonymous_4)","line":14,"loc":{"start":{"line":14,"column":9},"end":{"line":14,"column":26}}},"5":{"name":"(anonymous_5)","line":15,"loc":{"start":{"line":15,"column":22},"end":{"line":15,"column":36}}},"6":{"name":"delay","line":21,"loc":{"start":{"line":21,"column":0},"end":{"line":21,"column":39}}},"7":{"name":"maxStateChange","line":25,"loc":{"start":{"line":25,"column":0},"end":{"line":25,"column":31}}},"8":{"name":"peerNext","line":29,"loc":{"start":{"line":29,"column":0},"end":{"line":29,"column":30}}},"9":{"name":"isOffline","line":37,"loc":{"start":{"line":37,"column":0},"end":{"line":37,"column":23}}},"10":{"name":"isLocal","line":44,"loc":{"start":{"line":44,"column":0},"end":{"line":44,"column":21}}},"11":{"name":"isFriend","line":50,"loc":{"start":{"line":50,"column":0},"end":{"line":50,"column":22}}},"12":{"name":"isUnattempted","line":54,"loc":{"start":{"line":54,"column":0},"end":{"line":54,"column":27}}},"13":{"name":"isInactive","line":60,"loc":{"start":{"line":60,"column":0},"end":{"line":60,"column":24}}},"14":{"name":"isLongterm","line":64,"loc":{"start":{"line":64,"column":0},"end":{"line":64,"column":24}}},"15":{"name":"isLegacy","line":71,"loc":{"start":{"line":71,"column":0},"end":{"line":71,"column":25}}},"16":{"name":"isConnect","line":75,"loc":{"start":{"line":75,"column":0},"end":{"line":75,"column":23}}},"17":{"name":"earliest","line":80,"loc":{"start":{"line":80,"column":0},"end":{"line":80,"column":28}}},"18":{"name":"(anonymous_18)","line":81,"loc":{"start":{"line":81,"column":20},"end":{"line":81,"column":36}}},"19":{"name":"select","line":86,"loc":{"start":{"line":86,"column":0},"end":{"line":86,"column":41}}},"20":{"name":"(anonymous_20)","line":95,"loc":{"start":{"line":95,"column":35},"end":{"line":95,"column":51}}},"21":{"name":"(anonymous_21)","line":101,"loc":{"start":{"line":101,"column":0},"end":{"line":101,"column":34}}},"22":{"name":"conf","line":109,"loc":{"start":{"line":109,"column":2},"end":{"line":109,"column":27}}},"23":{"name":"connect","line":115,"loc":{"start":{"line":115,"column":2},"end":{"line":115,"column":51}}},"24":{"name":"(anonymous_24)","line":122,"loc":{"start":{"line":122,"column":17},"end":{"line":122,"column":33}}},"25":{"name":"(anonymous_25)","line":130,"loc":{"start":{"line":130,"column":15},"end":{"line":130,"column":31}}},"26":{"name":"connections","line":137,"loc":{"start":{"line":137,"column":2},"end":{"line":137,"column":26}}},"27":{"name":"(anonymous_27)","line":140,"loc":{"start":{"line":140,"column":15},"end":{"line":140,"column":27}}},"28":{"name":"(anonymous_28)","line":200,"loc":{"start":{"line":200,"column":38},"end":{"line":200,"column":51}}},"29":{"name":"(anonymous_29)","line":213,"loc":{"start":{"line":213,"column":17},"end":{"line":213,"column":31}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":22}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":35}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":44}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":39}},"5":{"start":{"line":6,"column":0},"end":{"line":6,"column":33}},"6":{"start":{"line":8,"column":0},"end":{"line":10,"column":1}},"7":{"start":{"line":9,"column":2},"end":{"line":9,"column":39}},"8":{"start":{"line":9,"column":24},"end":{"line":9,"column":38}},"9":{"start":{"line":12,"column":0},"end":{"line":17,"column":1}},"10":{"start":{"line":13,"column":2},"end":{"line":13,"column":37}},"11":{"start":{"line":14,"column":2},"end":{"line":16,"column":3}},"12":{"start":{"line":15,"column":4},"end":{"line":15,"column":68}},"13":{"start":{"line":15,"column":38},"end":{"line":15,"column":66}},"14":{"start":{"line":21,"column":0},"end":{"line":23,"column":1}},"15":{"start":{"line":22,"column":2},"end":{"line":22,"column":64}},"16":{"start":{"line":25,"column":0},"end":{"line":27,"column":1}},"17":{"start":{"line":26,"column":2},"end":{"line":26,"column":40}},"18":{"start":{"line":29,"column":0},"end":{"line":31,"column":1}},"19":{"start":{"line":30,"column":2},"end":{"line":30,"column":76}},"20":{"start":{"line":37,"column":0},"end":{"line":40,"column":1}},"21":{"start":{"line":38,"column":2},"end":{"line":38,"column":40}},"22":{"start":{"line":38,"column":28},"end":{"line":38,"column":40}},"23":{"start":{"line":39,"column":2},"end":{"line":39,"column":22}},"24":{"start":{"line":42,"column":0},"end":{"line":42,"column":29}},"25":{"start":{"line":44,"column":0},"end":{"line":48,"column":1}},"26":{"start":{"line":47,"column":2},"end":{"line":47,"column":53}},"27":{"start":{"line":50,"column":0},"end":{"line":52,"column":1}},"28":{"start":{"line":51,"column":2},"end":{"line":51,"column":31}},"29":{"start":{"line":54,"column":0},"end":{"line":56,"column":1}},"30":{"start":{"line":55,"column":2},"end":{"line":55,"column":23}},"31":{"start":{"line":60,"column":0},"end":{"line":62,"column":1}},"32":{"start":{"line":61,"column":2},"end":{"line":61,"column":63}},"33":{"start":{"line":64,"column":0},"end":{"line":66,"column":1}},"34":{"start":{"line":65,"column":2},"end":{"line":65,"column":52}},"35":{"start":{"line":71,"column":0},"end":{"line":73,"column":1}},"36":{"start":{"line":72,"column":2},"end":{"line":72,"column":77}},"37":{"start":{"line":75,"column":0},"end":{"line":77,"column":1}},"38":{"start":{"line":76,"column":2},"end":{"line":76,"column":60}},"39":{"start":{"line":80,"column":0},"end":{"line":84,"column":1}},"40":{"start":{"line":81,"column":2},"end":{"line":83,"column":29}},"41":{"start":{"line":82,"column":4},"end":{"line":82,"column":40}},"42":{"start":{"line":86,"column":0},"end":{"line":98,"column":1}},"43":{"start":{"line":87,"column":2},"end":{"line":87,"column":28}},"44":{"start":{"line":87,"column":19},"end":{"line":87,"column":28}},"45":{"start":{"line":89,"column":2},"end":{"line":89,"column":33}},"46":{"start":{"line":90,"column":2},"end":{"line":90,"column":45}},"47":{"start":{"line":91,"column":2},"end":{"line":91,"column":69}},"48":{"start":{"line":92,"column":2},"end":{"line":92,"column":63}},"49":{"start":{"line":93,"column":2},"end":{"line":93,"column":24}},"50":{"start":{"line":93,"column":15},"end":{"line":93,"column":24}},"51":{"start":{"line":95,"column":2},"end":{"line":97,"column":12}},"52":{"start":{"line":96,"column":4},"end":{"line":96,"column":36}},"53":{"start":{"line":100,"column":0},"end":{"line":224,"column":1}},"54":{"start":{"line":103,"column":2},"end":{"line":103,"column":32}},"55":{"start":{"line":106,"column":2},"end":{"line":106,"column":28}},"56":{"start":{"line":107,"column":2},"end":{"line":107,"column":29}},"57":{"start":{"line":109,"column":2},"end":{"line":113,"column":3}},"58":{"start":{"line":110,"column":4},"end":{"line":110,"column":33}},"59":{"start":{"line":110,"column":23},"end":{"line":110,"column":33}},"60":{"start":{"line":111,"column":4},"end":{"line":111,"column":35}},"61":{"start":{"line":112,"column":4},"end":{"line":112,"column":62}},"62":{"start":{"line":115,"column":2},"end":{"line":133,"column":3}},"63":{"start":{"line":116,"column":4},"end":{"line":116,"column":21}},"64":{"start":{"line":117,"column":4},"end":{"line":117,"column":58}},"65":{"start":{"line":120,"column":4},"end":{"line":125,"column":5}},"66":{"start":{"line":121,"column":6},"end":{"line":124,"column":10}},"67":{"start":{"line":123,"column":10},"end":{"line":123,"column":33}},"68":{"start":{"line":128,"column":4},"end":{"line":128,"column":65}},"69":{"start":{"line":129,"column":4},"end":{"line":132,"column":8}},"70":{"start":{"line":131,"column":8},"end":{"line":131,"column":28}},"71":{"start":{"line":136,"column":2},"end":{"line":136,"column":24}},"72":{"start":{"line":137,"column":2},"end":{"line":209,"column":3}},"73":{"start":{"line":138,"column":4},"end":{"line":138,"column":25}},"74":{"start":{"line":138,"column":19},"end":{"line":138,"column":25}},"75":{"start":{"line":139,"column":4},"end":{"line":139,"column":21}},"76":{"start":{"line":140,"column":4},"end":{"line":207,"column":25}},"77":{"start":{"line":141,"column":6},"end":{"line":141,"column":24}},"78":{"start":{"line":142,"column":6},"end":{"line":142,"column":25}},"79":{"start":{"line":143,"column":6},"end":{"line":143,"column":32}},"80":{"start":{"line":145,"column":6},"end":{"line":145,"column":86}},"81":{"start":{"line":146,"column":6},"end":{"line":146,"column":74}},"82":{"start":{"line":148,"column":6},"end":{"line":151,"column":8}},"83":{"start":{"line":154,"column":6},"end":{"line":157,"column":8}},"84":{"start":{"line":159,"column":6},"end":{"line":163,"column":10}},"85":{"start":{"line":160,"column":8},"end":{"line":163,"column":10}},"86":{"start":{"line":165,"column":6},"end":{"line":168,"column":8}},"87":{"start":{"line":171,"column":6},"end":{"line":178,"column":8}},"88":{"start":{"line":180,"column":6},"end":{"line":184,"column":10}},"89":{"start":{"line":181,"column":8},"end":{"line":184,"column":10}},"90":{"start":{"line":187,"column":6},"end":{"line":190,"column":8}},"91":{"start":{"line":192,"column":6},"end":{"line":192,"column":78}},"92":{"start":{"line":194,"column":6},"end":{"line":198,"column":8}},"93":{"start":{"line":200,"column":6},"end":{"line":205,"column":8}},"94":{"start":{"line":201,"column":8},"end":{"line":201,"column":67}},"95":{"start":{"line":202,"column":8},"end":{"line":204,"column":9}},"96":{"start":{"line":203,"column":10},"end":{"line":203,"column":30}},"97":{"start":{"line":211,"column":4},"end":{"line":217,"column":5}},"98":{"start":{"line":214,"column":8},"end":{"line":215,"column":23}},"99":{"start":{"line":215,"column":10},"end":{"line":215,"column":23}},"100":{"start":{"line":219,"column":4},"end":{"line":219,"column":43}},"101":{"start":{"line":220,"column":4},"end":{"line":220,"column":29}},"102":{"start":{"line":220,"column":18},"end":{"line":220,"column":29}},"103":{"start":{"line":222,"column":4},"end":{"line":222,"column":17}},"104":{"start":{"line":226,"column":0},"end":{"line":226,"column":37}},"105":{"start":{"line":227,"column":0},"end":{"line":227,"column":31}},"106":{"start":{"line":228,"column":0},"end":{"line":228,"column":31}},"107":{"start":{"line":229,"column":0},"end":{"line":229,"column":27}},"108":{"start":{"line":230,"column":0},"end":{"line":230,"column":25}},"109":{"start":{"line":231,"column":0},"end":{"line":231,"column":27}},"110":{"start":{"line":232,"column":0},"end":{"line":232,"column":43}},"111":{"start":{"line":233,"column":0},"end":{"line":233,"column":23}}},"branchMap":{"1":{"line":22,"type":"binary-expr","locations":[{"start":{"line":22,"column":48},"end":{"line":22,"column":51}},{"start":{"line":22,"column":55},"end":{"line":22,"column":63}}]},"2":{"line":26,"type":"binary-expr","locations":[{"start":{"line":26,"column":21},"end":{"line":26,"column":34}},{"start":{"line":26,"column":38},"end":{"line":26,"column":39}}]},"3":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":2},"end":{"line":38,"column":2}},{"start":{"line":38,"column":2},"end":{"line":38,"column":2}}]},"4":{"line":47,"type":"binary-expr","locations":[{"start":{"line":47,"column":9},"end":{"line":47,"column":29}},{"start":{"line":47,"column":33},"end":{"line":47,"column":53}}]},"5":{"line":61,"type":"binary-expr","locations":[{"start":{"line":61,"column":9},"end":{"line":61,"column":22}},{"start":{"line":61,"column":27},"end":{"line":61,"column":38}},{"start":{"line":61,"column":42},"end":{"line":61,"column":62}}]},"6":{"line":65,"type":"binary-expr","locations":[{"start":{"line":65,"column":9},"end":{"line":65,"column":15}},{"start":{"line":65,"column":19},"end":{"line":65,"column":29}},{"start":{"line":65,"column":33},"end":{"line":65,"column":52}}]},"7":{"line":72,"type":"binary-expr","locations":[{"start":{"line":72,"column":9},"end":{"line":72,"column":22}},{"start":{"line":72,"column":26},"end":{"line":72,"column":48}},{"start":{"line":72,"column":52},"end":{"line":72,"column":77}}]},"8":{"line":76,"type":"binary-expr","locations":[{"start":{"line":76,"column":9},"end":{"line":76,"column":32}},{"start":{"line":76,"column":36},"end":{"line":76,"column":60}}]},"9":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":2},"end":{"line":87,"column":2}},{"start":{"line":87,"column":2},"end":{"line":87,"column":2}}]},"10":{"line":93,"type":"if","locations":[{"start":{"line":93,"column":2},"end":{"line":93,"column":2}},{"start":{"line":93,"column":2},"end":{"line":93,"column":2}}]},"11":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":4},"end":{"line":110,"column":4}},{"start":{"line":110,"column":4},"end":{"line":110,"column":4}}]},"12":{"line":112,"type":"cond-expr","locations":[{"start":{"line":112,"column":51},"end":{"line":112,"column":54}},{"start":{"line":112,"column":57},"end":{"line":112,"column":62}}]},"13":{"line":112,"type":"binary-expr","locations":[{"start":{"line":112,"column":12},"end":{"line":112,"column":31}},{"start":{"line":112,"column":35},"end":{"line":112,"column":47}}]},"14":{"line":120,"type":"if","locations":[{"start":{"line":120,"column":4},"end":{"line":120,"column":4}},{"start":{"line":120,"column":4},"end":{"line":120,"column":4}}]},"15":{"line":138,"type":"if","locations":[{"start":{"line":138,"column":4},"end":{"line":138,"column":4}},{"start":{"line":138,"column":4},"end":{"line":138,"column":4}}]},"16":{"line":159,"type":"if","locations":[{"start":{"line":159,"column":6},"end":{"line":159,"column":6}},{"start":{"line":159,"column":6},"end":{"line":159,"column":6}}]},"17":{"line":180,"type":"if","locations":[{"start":{"line":180,"column":6},"end":{"line":180,"column":6}},{"start":{"line":180,"column":6},"end":{"line":180,"column":6}}]},"18":{"line":201,"type":"binary-expr","locations":[{"start":{"line":201,"column":24},"end":{"line":201,"column":45}},{"start":{"line":201,"column":49},"end":{"line":201,"column":67}}]},"19":{"line":202,"type":"if","locations":[{"start":{"line":202,"column":8},"end":{"line":202,"column":8}},{"start":{"line":202,"column":8},"end":{"line":202,"column":8}}]},"20":{"line":202,"type":"binary-expr","locations":[{"start":{"line":202,"column":12},"end":{"line":202,"column":22}},{"start":{"line":202,"column":26},"end":{"line":202,"column":50}},{"start":{"line":202,"column":55},"end":{"line":202,"column":80}}]},"21":{"line":214,"type":"if","locations":[{"start":{"line":214,"column":8},"end":{"line":214,"column":8}},{"start":{"line":214,"column":8},"end":{"line":214,"column":8}}]},"22":{"line":220,"type":"if","locations":[{"start":{"line":220,"column":4},"end":{"line":220,"column":4}},{"start":{"line":220,"column":4},"end":{"line":220,"column":4}}]}},"code":["var ip = require('ip')","var onWakeup = require('on-wakeup')","var onNetwork = require('on-change-network')","var hasNetwork = require('has-network')","","var pull = require('pull-stream')","","function not (fn) {","  return function (e) { return !fn(e) }","}","","function and () {","  var args = [].slice.call(arguments)","  return function (value) {","    return args.every(function (fn) { return fn.call(null, value) })","  }","}","","//min delay (delay since last disconnect of most recent peer in unconnected set)","//unconnected filter delay peer < min delay","function delay (failures, factor, max) {","  return Math.min(Math.pow(2, failures)*factor, max || Infinity)","}","","function maxStateChange (M, e) {","  return Math.max(M, e.stateChange || 0)","}","","function peerNext(peer, opts) {","  return (peer.stateChange|0) + delay(peer.failure|0, opts.factor, opts.max)","}","","","//detect if not connected to wifi or other network","//(i.e. if there is only localhost)","","function isOffline (e) {","  if(ip.isLoopback(e.host)) return false","  return !hasNetwork()","}","","var isOnline = not(isOffline)","","function isLocal (e) {","  // don't rely on private ip address, because","  // cjdns creates fake private ip addresses.","  return ip.isPrivate(e.host) && e.source === 'local'","}","","function isFriend (e) {","  return e.source === 'friends'","}","","function isUnattempted (e) {","  return !e.stateChange","}","","//select peers which have never been successfully connected to yet,","//but have been tried.","function isInactive (e) {","  return e.stateChange && (!e.duration || e.duration.mean == 0)","}","","function isLongterm (e) {","  return e.ping && e.ping.rtt && e.ping.rtt.mean > 0","}","","//peers which we can connect to, but are not upgraded.","//select peers which we can connect to, but are not upgraded to LT.","//assume any peer is legacy, until we know otherwise...","function isLegacy (peer) {","  return peer.duration && peer.duration.mean > 0 && !exports.isLongterm(peer)","}","","function isConnect (e) {","  return 'connected' === e.state || 'connecting' === e.state","}","","//sort oldest to newest then take first n","function earliest(peers, n) {","  return peers.sort(function (a, b) {","    return a.stateChange - b.stateChange","  }).slice(0, Math.max(n, 0))","}","","function select(peers, ts, filter, opts) {","  if(opts.disable) return []","  //opts: { quota, groupMin, min, factor, max }","  var type = peers.filter(filter)","  var unconnect = type.filter(not(isConnect))","  var count = Math.max(opts.quota - type.filter(isConnect).length, 0)","  var min = unconnect.reduce(maxStateChange, 0) + opts.groupMin","  if(ts < min) return []","","  return earliest(unconnect.filter(function (peer) {","    return peerNext(peer, opts) < ts","  }), count)","}","","var schedule = exports = module.exports =","function (gossip, config, server) {","//  return","  var min = 60e3, hour = 60*60e3","","  //trigger hard reconnect after suspend or local network changes","  onWakeup(gossip.reconnect)","  onNetwork(gossip.reconnect)","","  function conf(name, def) {","    if(!config.gossip) return def","    var value = config.gossip[name]","    return (value === undefined || value === '') ? def : value","  }","","  function connect (peers, ts, name, filter, opts) {","    opts.group = name","    var connected = peers.filter(isConnect).filter(filter)","","    //disconnect if over quota","    if(connected.length > opts.quota) {","      return earliest(connected, connected.length - opts.quota)","        .forEach(function (peer) {","          gossip.disconnect(peer)","        })","    }","","    //will return [] if the quota is full","    var selected = select(peers, ts, and(filter, isOnline), opts)","    selected","      .forEach(function (peer) {","        gossip.connect(peer)","      })","  }","","","  var connecting = false","  function connections () {","    if(connecting) return","    connecting = true","    setTimeout(function () {","      connecting = false","      var ts = Date.now()","      var peers = gossip.peers()","","      var connected = peers.filter(and(isConnect, not(isLocal), not(isFriend))).length","      var connectedFriends = peers.filter(and(isConnect, isFriend)).length","","      connect(peers, ts, 'local', exports.isLocal, {","        quota: 3, factor: 2e3, max: 10*min, groupMin: 1e3,","        disable: !conf('local', true)","      })","","      // prioritize friends","      connect(peers, ts, 'friends', and(exports.isFriend, exports.isLongterm), {","        quota: 2, factor: 10e3, max: 10*min, groupMin: 5e3,","        disable: !conf('local', true)","      })","","      if (connectedFriends < 2)","        connect(peers, ts, 'attemptFriend', and(exports.isFriend, exports.isUnattempted), {","          min: 0, quota: 1, factor: 0, max: 0, groupMin: 0,","          disable: !conf('global', true)","        })","","      connect(peers, ts, 'retryFriends', and(exports.isFriend, exports.isInactive), {","        min: 0,","        quota: 3, factor: 60e3, max: 3*60*60e3, groupMin: 5*60e3","      })","","      // standard longterm peers","      connect(peers, ts, 'longterm', and(","        exports.isLongterm,","        not(exports.isFriend),","        not(exports.isLocal)","      ), {","        quota: 2, factor: 10e3, max: 10*min, groupMin: 5e3,","        disable: !conf('global', true)","      })","","      if(!connected)","        connect(peers, ts, 'attempt', exports.isUnattempted, {","          min: 0, quota: 1, factor: 0, max: 0, groupMin: 0,","          disable: !conf('global', true)","        })","","      //quota, groupMin, min, factor, max","      connect(peers, ts, 'retry', exports.isInactive, {","        min: 0,","        quota: 3, factor: 5*60e3, max: 3*60*60e3, groupMin: 5*50e3","      })","","      var longterm = peers.filter(isConnect).filter(exports.isLongterm).length","","      connect(peers, ts, 'legacy', exports.isLegacy, {","        quota: 3 - longterm,","        factor: 5*min, max: 3*hour, groupMin: 5*min,","        disable: !conf('global', true)","      })","","      peers.filter(isConnect).forEach(function (e) {","        var permanent = exports.isLongterm(e) || exports.isLocal(e)","        if((!permanent || e.state === 'connecting') && e.stateChange + 10e3 < ts) {","          gossip.disconnect(e)","        }","      })","","    }, 100*Math.random())","","  }","","    pull(","      gossip.changes(),","      pull.drain(function (ev) {","        if(ev.type == 'disconnect')","          connections()","      })","    )","","    var int = setInterval(connections, 2e3)","    if(int.unref) int.unref()","","    connections()","","}","","exports.isUnattempted = isUnattempted","exports.isInactive = isInactive","exports.isLongterm = isLongterm","exports.isLegacy = isLegacy","exports.isLocal = isLocal","exports.isFriend = isFriend","exports.isConnectedOrConnecting = isConnect","exports.select = select",""],"l":{"1":1,"2":1,"3":1,"4":1,"6":1,"8":1,"9":1,"12":1,"13":0,"14":0,"15":0,"21":1,"22":0,"25":1,"26":0,"29":1,"30":0,"37":1,"38":0,"39":0,"42":1,"44":1,"47":0,"50":1,"51":0,"54":1,"55":0,"60":1,"61":0,"64":1,"65":0,"71":1,"72":0,"75":1,"76":0,"80":1,"81":0,"82":0,"86":1,"87":0,"89":0,"90":0,"91":0,"92":0,"93":0,"95":0,"96":0,"100":1,"103":0,"106":0,"107":0,"109":1,"110":0,"111":0,"112":0,"115":1,"116":0,"117":0,"120":0,"121":0,"123":0,"128":0,"129":0,"131":0,"136":0,"137":1,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"145":0,"146":0,"148":0,"154":0,"159":0,"160":0,"165":0,"171":0,"180":0,"181":0,"187":0,"192":0,"194":0,"200":0,"201":0,"202":0,"203":0,"211":0,"214":0,"215":0,"219":0,"220":0,"222":0,"226":1,"227":1,"228":1,"229":1,"230":1,"231":1,"232":1,"233":1}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/ui/electron/context-menu.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/ui/electron/context-menu.js","s":{"1":2,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":1,"41":0,"42":0,"43":0,"44":0,"45":1,"46":0,"47":0,"48":0,"49":0,"50":1,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0,0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"fnMap":{"1":{"name":"(anonymous_1)","line":18,"loc":{"start":{"line":18,"column":11},"end":{"line":18,"column":39}}},"2":{"name":"(anonymous_2)","line":27,"loc":{"start":{"line":27,"column":9},"end":{"line":27,"column":29}}},"3":{"name":"(anonymous_3)","line":29,"loc":{"start":{"line":29,"column":32},"end":{"line":29,"column":47}}},"4":{"name":"(anonymous_4)","line":44,"loc":{"start":{"line":44,"column":11},"end":{"line":44,"column":27}}},"5":{"name":"(anonymous_5)","line":57,"loc":{"start":{"line":57,"column":11},"end":{"line":57,"column":27}}},"6":{"name":"(anonymous_6)","line":63,"loc":{"start":{"line":63,"column":11},"end":{"line":63,"column":23}}},"7":{"name":"(anonymous_7)","line":84,"loc":{"start":{"line":84,"column":27},"end":{"line":84,"column":43}}},"8":{"name":"appendMenuItemGroup","line":100,"loc":{"start":{"line":100,"column":0},"end":{"line":100,"column":42}}},"9":{"name":"getContainingLink","line":111,"loc":{"start":{"line":111,"column":0},"end":{"line":111,"column":31}}},"10":{"name":"createMenu","line":119,"loc":{"start":{"line":119,"column":0},"end":{"line":119,"column":24}}},"11":{"name":"onContextMenu","line":149,"loc":{"start":{"line":149,"column":17},"end":{"line":149,"column":43}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":30}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":41}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":24}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":32}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":28}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":34}},"7":{"start":{"line":7,"column":0},"end":{"line":7,"column":31}},"8":{"start":{"line":8,"column":0},"end":{"line":8,"column":29}},"9":{"start":{"line":9,"column":0},"end":{"line":9,"column":33}},"10":{"start":{"line":12,"column":0},"end":{"line":12,"column":13}},"11":{"start":{"line":13,"column":0},"end":{"line":13,"column":15}},"12":{"start":{"line":15,"column":0},"end":{"line":52,"column":1}},"13":{"start":{"line":19,"column":6},"end":{"line":19,"column":25}},"14":{"start":{"line":20,"column":6},"end":{"line":20,"column":35}},"15":{"start":{"line":21,"column":6},"end":{"line":21,"column":72}},"16":{"start":{"line":22,"column":6},"end":{"line":23,"column":19}},"17":{"start":{"line":23,"column":8},"end":{"line":23,"column":19}},"18":{"start":{"line":25,"column":6},"end":{"line":33,"column":8}},"19":{"start":{"line":28,"column":8},"end":{"line":32,"column":9}},"20":{"start":{"line":29,"column":10},"end":{"line":31,"column":18}},"21":{"start":{"line":30,"column":12},"end":{"line":30,"column":52}},"22":{"start":{"line":45,"column":6},"end":{"line":45,"column":30}},"23":{"start":{"line":46,"column":6},"end":{"line":46,"column":60}},"24":{"start":{"line":47,"column":6},"end":{"line":48,"column":19}},"25":{"start":{"line":48,"column":8},"end":{"line":48,"column":19}},"26":{"start":{"line":49,"column":6},"end":{"line":49,"column":31}},"27":{"start":{"line":54,"column":0},"end":{"line":74,"column":1}},"28":{"start":{"line":58,"column":6},"end":{"line":58,"column":25}},"29":{"start":{"line":64,"column":6},"end":{"line":64,"column":49}},"30":{"start":{"line":65,"column":6},"end":{"line":65,"column":43}},"31":{"start":{"line":66,"column":6},"end":{"line":70,"column":7}},"32":{"start":{"line":67,"column":8},"end":{"line":67,"column":43}},"33":{"start":{"line":68,"column":8},"end":{"line":69,"column":21}},"34":{"start":{"line":69,"column":10},"end":{"line":69,"column":21}},"35":{"start":{"line":71,"column":6},"end":{"line":71,"column":31}},"36":{"start":{"line":76,"column":0},"end":{"line":78,"column":1}},"37":{"start":{"line":80,"column":0},"end":{"line":89,"column":1}},"38":{"start":{"line":85,"column":4},"end":{"line":85,"column":34}},"39":{"start":{"line":91,"column":0},"end":{"line":98,"column":1}},"40":{"start":{"line":100,"column":0},"end":{"line":109,"column":1}},"41":{"start":{"line":101,"column":2},"end":{"line":105,"column":3}},"42":{"start":{"line":102,"column":4},"end":{"line":104,"column":7}},"43":{"start":{"line":106,"column":2},"end":{"line":108,"column":3}},"44":{"start":{"line":107,"column":4},"end":{"line":107,"column":39}},"45":{"start":{"line":111,"column":0},"end":{"line":117,"column":1}},"46":{"start":{"line":112,"column":2},"end":{"line":116,"column":3}},"47":{"start":{"line":113,"column":4},"end":{"line":114,"column":15}},"48":{"start":{"line":114,"column":6},"end":{"line":114,"column":15}},"49":{"start":{"line":115,"column":4},"end":{"line":115,"column":22}},"50":{"start":{"line":119,"column":0},"end":{"line":147,"column":1}},"51":{"start":{"line":120,"column":2},"end":{"line":120,"column":23}},"52":{"start":{"line":121,"column":2},"end":{"line":121,"column":34}},"53":{"start":{"line":122,"column":2},"end":{"line":122,"column":16}},"54":{"start":{"line":124,"column":2},"end":{"line":139,"column":3}},"55":{"start":{"line":126,"column":6},"end":{"line":126,"column":45}},"56":{"start":{"line":127,"column":6},"end":{"line":127,"column":11}},"57":{"start":{"line":130,"column":6},"end":{"line":133,"column":52}},"58":{"start":{"line":131,"column":8},"end":{"line":131,"column":63}},"59":{"start":{"line":133,"column":8},"end":{"line":133,"column":52}},"60":{"start":{"line":134,"column":6},"end":{"line":134,"column":11}},"61":{"start":{"line":136,"column":6},"end":{"line":137,"column":57}},"62":{"start":{"line":137,"column":8},"end":{"line":137,"column":57}},"63":{"start":{"line":138,"column":6},"end":{"line":138,"column":11}},"64":{"start":{"line":141,"column":2},"end":{"line":144,"column":3}},"65":{"start":{"line":142,"column":4},"end":{"line":142,"column":22}},"66":{"start":{"line":143,"column":4},"end":{"line":143,"column":44}},"67":{"start":{"line":146,"column":2},"end":{"line":146,"column":13}},"68":{"start":{"line":149,"column":0},"end":{"line":154,"column":1}},"69":{"start":{"line":150,"column":2},"end":{"line":150,"column":20}},"70":{"start":{"line":151,"column":2},"end":{"line":151,"column":33}},"71":{"start":{"line":152,"column":2},"end":{"line":153,"column":41}},"72":{"start":{"line":153,"column":4},"end":{"line":153,"column":41}}},"branchMap":{"1":{"line":20,"type":"binary-expr","locations":[{"start":{"line":20,"column":17},"end":{"line":20,"column":24}},{"start":{"line":20,"column":28},"end":{"line":20,"column":35}}]},"2":{"line":22,"type":"if","locations":[{"start":{"line":22,"column":6},"end":{"line":22,"column":6}},{"start":{"line":22,"column":6},"end":{"line":22,"column":6}}]},"3":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":8},"end":{"line":28,"column":8}},{"start":{"line":28,"column":8},"end":{"line":28,"column":8}}]},"4":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":6},"end":{"line":47,"column":6}},{"start":{"line":47,"column":6},"end":{"line":47,"column":6}}]},"5":{"line":47,"type":"binary-expr","locations":[{"start":{"line":47,"column":10},"end":{"line":47,"column":11}},{"start":{"line":47,"column":15},"end":{"line":47,"column":34}}]},"6":{"line":66,"type":"if","locations":[{"start":{"line":66,"column":6},"end":{"line":66,"column":6}},{"start":{"line":66,"column":6},"end":{"line":66,"column":6}}]},"7":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":8},"end":{"line":68,"column":8}},{"start":{"line":68,"column":8},"end":{"line":68,"column":8}}]},"8":{"line":101,"type":"if","locations":[{"start":{"line":101,"column":2},"end":{"line":101,"column":2}},{"start":{"line":101,"column":2},"end":{"line":101,"column":2}}]},"9":{"line":113,"type":"if","locations":[{"start":{"line":113,"column":4},"end":{"line":113,"column":4}},{"start":{"line":113,"column":4},"end":{"line":113,"column":4}}]},"10":{"line":113,"type":"binary-expr","locations":[{"start":{"line":113,"column":8},"end":{"line":113,"column":26}},{"start":{"line":113,"column":30},"end":{"line":113,"column":37}}]},"11":{"line":124,"type":"switch","locations":[{"start":{"line":125,"column":4},"end":{"line":127,"column":11}},{"start":{"line":128,"column":4},"end":{"line":128,"column":17}},{"start":{"line":129,"column":4},"end":{"line":134,"column":11}},{"start":{"line":135,"column":4},"end":{"line":138,"column":11}}]},"12":{"line":130,"type":"if","locations":[{"start":{"line":130,"column":6},"end":{"line":130,"column":6}},{"start":{"line":130,"column":6},"end":{"line":130,"column":6}}]},"13":{"line":136,"type":"if","locations":[{"start":{"line":136,"column":6},"end":{"line":136,"column":6}},{"start":{"line":136,"column":6},"end":{"line":136,"column":6}}]},"14":{"line":136,"type":"binary-expr","locations":[{"start":{"line":136,"column":10},"end":{"line":136,"column":15}},{"start":{"line":136,"column":19},"end":{"line":136,"column":58}}]},"15":{"line":141,"type":"if","locations":[{"start":{"line":141,"column":2},"end":{"line":141,"column":2}},{"start":{"line":141,"column":2},"end":{"line":141,"column":2}}]},"16":{"line":152,"type":"if","locations":[{"start":{"line":152,"column":2},"end":{"line":152,"column":2}},{"start":{"line":152,"column":2},"end":{"line":152,"column":2}}]}},"code":["var remote = require('remote')","var electron = remote.require('electron')","var Menu = electron.Menu","var MenuItem = electron.MenuItem","var dialog = electron.dialog","var clipboard = electron.clipboard","var ssbref = require('ssb-ref')","var fs = remote.require('fs')","var http = remote.require('http')","","/* using globals because putting properties on the menu didn't seem to work */","var currentEl","var currentLink","","var imgMenuItems = [","  {","    label: 'Save Image As',","    click: function (item, mainWindow) {","      var img = currentEl","      var name = img.alt || img.src","      var m = /^http:\\/\\/localhost:7777\\/.*\\&name=([^&]*)/.exec(img.src)","      if (m)","        name = m[1]","","      dialog.showSaveDialog({","        defaultPath: name","      }, function (fileName) {","        if (fileName) {","          http.request(img.src, function (res) {","            res.pipe(fs.createWriteStream(fileName))","          }).end()","        }","      })","    }","  },","  /*","  {","    label: 'Copy Image',","    click: function () { }","  },","  */","  {","    label: 'Copy Image Location',","    click: function (item) {","      var link = currentEl.src","      var m = /^http:\\/\\/localhost:7777\\/([^?]*)/.exec(link)","      if (m && ssbref.isLink(m[1]))","        link = m[1]","      clipboard.writeText(link)","    }","  }","]","","var linkMenuItems = [","  {","    label: 'Open Link',","    click: function (item) {","      currentLink.click()","    }","  },","  {","    label: 'Copy Link Location',","    click: function () {","      var href = currentLink.getAttribute('href')","      var m = /^#\\/[^\\/]*\\/(.*)/.exec(href)","      if (m) {","        var link = decodeURIComponent(m[1])","        if (ssbref.isLink(link))","          href = link","      }","      clipboard.writeText(href)","    }","  },","]","","var textSelectionMenuItems = [","  {label: 'Copy', role: 'copy'}","]","","var texteditMenuItems = [","  {label: 'Cut', role: 'cut'},","  {label: 'Copy', role: 'copy'},","  {label: 'Paste', role: 'paste'},","  {label: 'Delete', click: function (item) {","    document.execCommand('delete')","  }},","  {type: 'separator'},","  {label: 'Select All', role: 'selectall'},","]","","var texteditMenuItemsNoSelection = [","  {label: 'Cut', role: 'cut', enabled: false},","  {label: 'Copy', role: 'copy', enabled: false},","  {label: 'Paste', role: 'paste'},","  {label: 'Delete', enabled: false},","  {type: 'separator'},","  {label: 'Select All', role: 'selectall'},","]","","function appendMenuItemGroup(menu, items) {","  if (menu.items.length) {","    menu.append(new MenuItem({","      type: 'separator'","    }))","  }","  for (var i = 0; i < items.length; i++) {","    menu.append(new MenuItem(items[i]))","  }","}","","function getContainingLink(el) {","  while (el) {","    if (el.nodeName == 'A' && el.href)","      return el","    el = el.parentNode","  }","}","","function createMenu(el) {","  var menu = new Menu()","  var link = getContainingLink(el)","  currentEl = el","","  switch (el.nodeName) {","    case 'IMG':","      appendMenuItemGroup(menu, imgMenuItems)","      break","    case 'INPUT':","    case 'TEXTAREA':","      if (el.selectionEnd == el.selectionStart)","        appendMenuItemGroup(menu, texteditMenuItemsNoSelection)","      else","        appendMenuItemGroup(menu, texteditMenuItems)","      break","    default:","      if (!link && document.getSelection().type == 'Range')","        appendMenuItemGroup(menu, textSelectionMenuItems)","      break","  }","","  if (link) {","    currentLink = link","    appendMenuItemGroup(menu, linkMenuItems)","  }","","  return menu","}","","module.exports = function onContextMenu(e) {","  e.preventDefault()","  var menu = createMenu(e.target)","  if (menu)","    menu.popup(remote.getCurrentWindow())","}"],"l":{"1":2,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"12":0,"13":0,"15":0,"19":0,"20":0,"21":0,"22":0,"23":0,"25":0,"28":0,"29":0,"30":0,"45":0,"46":0,"47":0,"48":0,"49":0,"54":0,"58":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"71":0,"76":0,"80":0,"85":0,"91":0,"100":1,"101":0,"102":0,"106":0,"107":0,"111":1,"112":0,"113":0,"114":0,"115":0,"119":1,"120":0,"121":0,"122":0,"124":0,"126":0,"127":0,"130":0,"131":0,"133":0,"134":0,"136":0,"137":0,"138":0,"141":0,"142":0,"143":0,"146":0,"149":0,"150":0,"151":0,"152":0,"153":0}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/ui/electron/zoom.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/ui/electron/zoom.js","s":{"1":2,"2":0,"3":0,"4":0,"5":0,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"setZoom","line":9,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":20}}},"2":{"name":"(anonymous_2)","line":17,"loc":{"start":{"line":17,"column":10},"end":{"line":17,"column":22}}},"3":{"name":"(anonymous_3)","line":20,"loc":{"start":{"line":20,"column":11},"end":{"line":20,"column":23}}},"4":{"name":"(anonymous_4)","line":23,"loc":{"start":{"line":23,"column":13},"end":{"line":23,"column":25}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":35}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":18}},"3":{"start":{"line":4,"column":0},"end":{"line":4,"column":34}},"4":{"start":{"line":5,"column":0},"end":{"line":7,"column":1}},"5":{"start":{"line":6,"column":2},"end":{"line":6,"column":29}},"6":{"start":{"line":9,"column":0},"end":{"line":13,"column":1}},"7":{"start":{"line":10,"column":2},"end":{"line":10,"column":10}},"8":{"start":{"line":11,"column":2},"end":{"line":11,"column":29}},"9":{"start":{"line":12,"column":2},"end":{"line":12,"column":23}},"10":{"start":{"line":15,"column":0},"end":{"line":26,"column":1}},"11":{"start":{"line":18,"column":4},"end":{"line":18,"column":28}},"12":{"start":{"line":21,"column":4},"end":{"line":21,"column":28}},"13":{"start":{"line":24,"column":4},"end":{"line":24,"column":14}}},"branchMap":{"1":{"line":4,"type":"binary-expr","locations":[{"start":{"line":4,"column":11},"end":{"line":4,"column":29}},{"start":{"line":4,"column":33},"end":{"line":4,"column":34}}]},"2":{"line":5,"type":"if","locations":[{"start":{"line":5,"column":0},"end":{"line":5,"column":0}},{"start":{"line":5,"column":0},"end":{"line":5,"column":0}}]}},"code":["var webFrame = require('web-frame')","","var zoomStep = 0.5","var zoom = +localStorage.zoom || 0","if (zoom) {","  webFrame.setZoomLevel(zoom)","}","","function setZoom(z) {","  zoom = z","  webFrame.setZoomLevel(zoom)","  localStorage.zoom = z","}","","module.exports = {","  setZoom: setZoom,","  zoomIn: function () {","    setZoom(zoom + zoomStep)","  },","  zoomOut: function () {","    setZoom(zoom - zoomStep)","  },","  zoomReset: function () {","    setZoom(0)","  }","}"],"l":{"1":2,"3":0,"4":0,"5":0,"6":0,"9":1,"10":0,"11":0,"12":0,"15":0,"18":0,"21":0,"24":0}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/ui/lib/app.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/ui/lib/app.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":2,"9":2,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":1,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":1,"26":0,"27":0,"28":1,"29":0,"30":0,"31":0,"32":1,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1,"42":0,"43":0,"44":1,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":1,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":1,"70":0,"71":0,"72":0,"73":1,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},"fnMap":{"1":{"name":"(anonymous_1)","line":42,"loc":{"start":{"line":42,"column":33},"end":{"line":42,"column":50}}},"2":{"name":"addIssue","line":81,"loc":{"start":{"line":81,"column":0},"end":{"line":81,"column":57}}},"3":{"name":"addNotification","line":99,"loc":{"start":{"line":99,"column":0},"end":{"line":99,"column":35}}},"4":{"name":"removeNotification","line":103,"loc":{"start":{"line":103,"column":0},"end":{"line":103,"column":43}}},"5":{"name":"updateChannels","line":108,"loc":{"start":{"line":108,"column":0},"end":{"line":108,"column":39}}},"6":{"name":"sortChannels","line":125,"loc":{"start":{"line":125,"column":0},"end":{"line":125,"column":25}}},"7":{"name":"(anonymous_7)","line":126,"loc":{"start":{"line":126,"column":20},"end":{"line":126,"column":36}}},"8":{"name":"onPatchworkEvent","line":132,"loc":{"start":{"line":132,"column":0},"end":{"line":132,"column":30}}},"9":{"name":"pollPeers","line":156,"loc":{"start":{"line":156,"column":0},"end":{"line":156,"column":22}}},"10":{"name":"(anonymous_10)","line":157,"loc":{"start":{"line":157,"column":23},"end":{"line":157,"column":45}}},"11":{"name":"updateTitle","line":168,"loc":{"start":{"line":168,"column":0},"end":{"line":168,"column":24}}},"12":{"name":"fetchLatestState","line":174,"loc":{"start":{"line":174,"column":0},"end":{"line":174,"column":31}}},"13":{"name":"(anonymous_13)","line":191,"loc":{"start":{"line":191,"column":7},"end":{"line":191,"column":28}}},"14":{"name":"(anonymous_14)","line":211,"loc":{"start":{"line":211,"column":49},"end":{"line":211,"column":66}}},"15":{"name":"(anonymous_15)","line":212,"loc":{"start":{"line":212,"column":60},"end":{"line":212,"column":77}}}},"statementMap":{"1":{"start":{"line":12,"column":0},"end":{"line":12,"column":28}},"2":{"start":{"line":14,"column":0},"end":{"line":14,"column":34}},"3":{"start":{"line":15,"column":0},"end":{"line":15,"column":38}},"4":{"start":{"line":16,"column":0},"end":{"line":16,"column":38}},"5":{"start":{"line":17,"column":0},"end":{"line":17,"column":49}},"6":{"start":{"line":18,"column":0},"end":{"line":18,"column":33}},"7":{"start":{"line":19,"column":0},"end":{"line":19,"column":40}},"8":{"start":{"line":20,"column":0},"end":{"line":20,"column":40}},"9":{"start":{"line":21,"column":0},"end":{"line":21,"column":36}},"10":{"start":{"line":22,"column":0},"end":{"line":22,"column":60}},"11":{"start":{"line":23,"column":0},"end":{"line":23,"column":49}},"12":{"start":{"line":26,"column":0},"end":{"line":26,"column":31}},"13":{"start":{"line":27,"column":0},"end":{"line":27,"column":29}},"14":{"start":{"line":30,"column":0},"end":{"line":78,"column":2}},"15":{"start":{"line":43,"column":6},"end":{"line":48,"column":7}},"16":{"start":{"line":79,"column":0},"end":{"line":79,"column":28}},"17":{"start":{"line":81,"column":0},"end":{"line":96,"column":1}},"18":{"start":{"line":82,"column":2},"end":{"line":82,"column":43}},"19":{"start":{"line":83,"column":2},"end":{"line":83,"column":45}},"20":{"start":{"line":84,"column":2},"end":{"line":84,"column":31}},"21":{"start":{"line":85,"column":2},"end":{"line":85,"column":74}},"22":{"start":{"line":87,"column":2},"end":{"line":94,"column":4}},"23":{"start":{"line":95,"column":2},"end":{"line":95,"column":27}},"24":{"start":{"line":98,"column":0},"end":{"line":98,"column":31}},"25":{"start":{"line":99,"column":0},"end":{"line":102,"column":1}},"26":{"start":{"line":100,"column":2},"end":{"line":100,"column":97}},"27":{"start":{"line":101,"column":2},"end":{"line":101,"column":34}},"28":{"start":{"line":103,"column":0},"end":{"line":106,"column":1}},"29":{"start":{"line":104,"column":2},"end":{"line":104,"column":71}},"30":{"start":{"line":104,"column":52},"end":{"line":104,"column":70}},"31":{"start":{"line":105,"column":2},"end":{"line":105,"column":34}},"32":{"start":{"line":108,"column":0},"end":{"line":123,"column":1}},"33":{"start":{"line":110,"column":2},"end":{"line":110,"column":7}},"34":{"start":{"line":111,"column":2},"end":{"line":117,"column":3}},"35":{"start":{"line":112,"column":4},"end":{"line":116,"column":5}},"36":{"start":{"line":114,"column":6},"end":{"line":114,"column":66}},"37":{"start":{"line":115,"column":6},"end":{"line":115,"column":11}},"38":{"start":{"line":118,"column":2},"end":{"line":119,"column":60}},"39":{"start":{"line":119,"column":4},"end":{"line":119,"column":60}},"40":{"start":{"line":122,"column":2},"end":{"line":122,"column":16}},"41":{"start":{"line":125,"column":0},"end":{"line":130,"column":1}},"42":{"start":{"line":126,"column":2},"end":{"line":129,"column":4}},"43":{"start":{"line":128,"column":4},"end":{"line":128,"column":40}},"44":{"start":{"line":132,"column":0},"end":{"line":154,"column":1}},"45":{"start":{"line":133,"column":2},"end":{"line":153,"column":3}},"46":{"start":{"line":134,"column":4},"end":{"line":135,"column":38}},"47":{"start":{"line":135,"column":6},"end":{"line":135,"column":38}},"48":{"start":{"line":136,"column":4},"end":{"line":136,"column":34}},"49":{"start":{"line":137,"column":4},"end":{"line":137,"column":17}},"50":{"start":{"line":138,"column":4},"end":{"line":141,"column":5}},"51":{"start":{"line":139,"column":6},"end":{"line":139,"column":83}},"52":{"start":{"line":140,"column":6},"end":{"line":140,"column":33}},"53":{"start":{"line":143,"column":7},"end":{"line":153,"column":3}},"54":{"start":{"line":144,"column":4},"end":{"line":144,"column":61}},"55":{"start":{"line":146,"column":7},"end":{"line":153,"column":3}},"56":{"start":{"line":147,"column":4},"end":{"line":147,"column":50}},"57":{"start":{"line":148,"column":4},"end":{"line":148,"column":31}},"58":{"start":{"line":150,"column":7},"end":{"line":153,"column":3}},"59":{"start":{"line":151,"column":4},"end":{"line":151,"column":51}},"60":{"start":{"line":152,"column":4},"end":{"line":152,"column":31}},"61":{"start":{"line":156,"column":0},"end":{"line":166,"column":1}},"62":{"start":{"line":157,"column":2},"end":{"line":165,"column":4}},"63":{"start":{"line":158,"column":4},"end":{"line":158,"column":70}},"64":{"start":{"line":159,"column":4},"end":{"line":159,"column":21}},"65":{"start":{"line":160,"column":4},"end":{"line":160,"column":28}},"66":{"start":{"line":161,"column":4},"end":{"line":164,"column":5}},"67":{"start":{"line":162,"column":6},"end":{"line":162,"column":33}},"68":{"start":{"line":163,"column":6},"end":{"line":163,"column":35}},"69":{"start":{"line":168,"column":0},"end":{"line":171,"column":1}},"70":{"start":{"line":169,"column":2},"end":{"line":169,"column":33}},"71":{"start":{"line":170,"column":2},"end":{"line":170,"column":56}},"72":{"start":{"line":172,"column":0},"end":{"line":172,"column":24}},"73":{"start":{"line":174,"column":0},"end":{"line":236,"column":1}},"74":{"start":{"line":175,"column":2},"end":{"line":176,"column":113}},"75":{"start":{"line":176,"column":4},"end":{"line":176,"column":113}},"76":{"start":{"line":177,"column":2},"end":{"line":180,"column":3}},"77":{"start":{"line":178,"column":4},"end":{"line":178,"column":46}},"78":{"start":{"line":179,"column":4},"end":{"line":179,"column":28}},"79":{"start":{"line":182,"column":2},"end":{"line":182,"column":34}},"80":{"start":{"line":183,"column":2},"end":{"line":183,"column":24}},"81":{"start":{"line":184,"column":2},"end":{"line":184,"column":40}},"82":{"start":{"line":185,"column":2},"end":{"line":185,"column":42}},"83":{"start":{"line":186,"column":2},"end":{"line":186,"column":42}},"84":{"start":{"line":187,"column":2},"end":{"line":187,"column":42}},"85":{"start":{"line":188,"column":2},"end":{"line":188,"column":30}},"86":{"start":{"line":189,"column":2},"end":{"line":190,"column":41}},"87":{"start":{"line":190,"column":4},"end":{"line":190,"column":41}},"88":{"start":{"line":191,"column":2},"end":{"line":235,"column":4}},"89":{"start":{"line":192,"column":4},"end":{"line":192,"column":30}},"90":{"start":{"line":192,"column":13},"end":{"line":192,"column":30}},"91":{"start":{"line":193,"column":4},"end":{"line":193,"column":36}},"92":{"start":{"line":194,"column":4},"end":{"line":194,"column":33}},"93":{"start":{"line":195,"column":4},"end":{"line":195,"column":33}},"94":{"start":{"line":196,"column":4},"end":{"line":196,"column":33}},"95":{"start":{"line":197,"column":4},"end":{"line":197,"column":33}},"96":{"start":{"line":198,"column":4},"end":{"line":198,"column":33}},"97":{"start":{"line":199,"column":4},"end":{"line":202,"column":5}},"98":{"start":{"line":200,"column":6},"end":{"line":200,"column":35}},"99":{"start":{"line":201,"column":6},"end":{"line":201,"column":20}},"100":{"start":{"line":203,"column":4},"end":{"line":203,"column":79}},"101":{"start":{"line":204,"column":4},"end":{"line":204,"column":57}},"102":{"start":{"line":205,"column":4},"end":{"line":205,"column":55}},"103":{"start":{"line":206,"column":4},"end":{"line":206,"column":17}},"104":{"start":{"line":209,"column":4},"end":{"line":209,"column":48}},"105":{"start":{"line":210,"column":4},"end":{"line":210,"column":65}},"106":{"start":{"line":211,"column":4},"end":{"line":211,"column":148}},"107":{"start":{"line":211,"column":68},"end":{"line":211,"column":146}},"108":{"start":{"line":212,"column":4},"end":{"line":212,"column":160}},"109":{"start":{"line":212,"column":79},"end":{"line":212,"column":158}},"110":{"start":{"line":213,"column":4},"end":{"line":213,"column":97}},"111":{"start":{"line":216,"column":4},"end":{"line":216,"column":32}},"112":{"start":{"line":217,"column":4},"end":{"line":231,"column":5}},"113":{"start":{"line":218,"column":6},"end":{"line":230,"column":7}},"114":{"start":{"line":219,"column":8},"end":{"line":229,"column":9}},"115":{"start":{"line":220,"column":10},"end":{"line":220,"column":40}},"116":{"start":{"line":221,"column":10},"end":{"line":228,"column":12}},"117":{"start":{"line":233,"column":4},"end":{"line":233,"column":26}},"118":{"start":{"line":234,"column":4},"end":{"line":234,"column":14}}},"branchMap":{"1":{"line":83,"type":"binary-expr","locations":[{"start":{"line":83,"column":16},"end":{"line":83,"column":27}},{"start":{"line":83,"column":31},"end":{"line":83,"column":45}}]},"2":{"line":84,"type":"binary-expr","locations":[{"start":{"line":84,"column":16},"end":{"line":84,"column":25}},{"start":{"line":84,"column":29},"end":{"line":84,"column":31}}]},"3":{"line":85,"type":"binary-expr","locations":[{"start":{"line":85,"column":55},"end":{"line":85,"column":69}},{"start":{"line":85,"column":71},"end":{"line":85,"column":73}}]},"4":{"line":112,"type":"if","locations":[{"start":{"line":112,"column":4},"end":{"line":112,"column":4}},{"start":{"line":112,"column":4},"end":{"line":112,"column":4}}]},"5":{"line":118,"type":"if","locations":[{"start":{"line":118,"column":2},"end":{"line":118,"column":2}},{"start":{"line":118,"column":2},"end":{"line":118,"column":2}}]},"6":{"line":133,"type":"if","locations":[{"start":{"line":133,"column":2},"end":{"line":133,"column":2}},{"start":{"line":133,"column":2},"end":{"line":133,"column":2}}]},"7":{"line":138,"type":"if","locations":[{"start":{"line":138,"column":4},"end":{"line":138,"column":4}},{"start":{"line":138,"column":4},"end":{"line":138,"column":4}}]},"8":{"line":143,"type":"if","locations":[{"start":{"line":143,"column":7},"end":{"line":143,"column":7}},{"start":{"line":143,"column":7},"end":{"line":143,"column":7}}]},"9":{"line":146,"type":"if","locations":[{"start":{"line":146,"column":7},"end":{"line":146,"column":7}},{"start":{"line":146,"column":7},"end":{"line":146,"column":7}}]},"10":{"line":150,"type":"if","locations":[{"start":{"line":150,"column":7},"end":{"line":150,"column":7}},{"start":{"line":150,"column":7},"end":{"line":150,"column":7}}]},"11":{"line":161,"type":"if","locations":[{"start":{"line":161,"column":4},"end":{"line":161,"column":4}},{"start":{"line":161,"column":4},"end":{"line":161,"column":4}}]},"12":{"line":175,"type":"if","locations":[{"start":{"line":175,"column":2},"end":{"line":175,"column":2}},{"start":{"line":175,"column":2},"end":{"line":175,"column":2}}]},"13":{"line":177,"type":"if","locations":[{"start":{"line":177,"column":2},"end":{"line":177,"column":2}},{"start":{"line":177,"column":2},"end":{"line":177,"column":2}}]},"14":{"line":189,"type":"if","locations":[{"start":{"line":189,"column":2},"end":{"line":189,"column":2}},{"start":{"line":189,"column":2},"end":{"line":189,"column":2}}]},"15":{"line":192,"type":"if","locations":[{"start":{"line":192,"column":4},"end":{"line":192,"column":4}},{"start":{"line":192,"column":4},"end":{"line":192,"column":4}}]},"16":{"line":199,"type":"if","locations":[{"start":{"line":199,"column":4},"end":{"line":199,"column":4}},{"start":{"line":199,"column":4},"end":{"line":199,"column":4}}]},"17":{"line":211,"type":"binary-expr","locations":[{"start":{"line":211,"column":75},"end":{"line":211,"column":96}},{"start":{"line":211,"column":100},"end":{"line":211,"column":145}}]},"18":{"line":212,"type":"binary-expr","locations":[{"start":{"line":212,"column":86},"end":{"line":212,"column":107}},{"start":{"line":212,"column":111},"end":{"line":212,"column":157}}]},"19":{"line":217,"type":"if","locations":[{"start":{"line":217,"column":4},"end":{"line":217,"column":4}},{"start":{"line":217,"column":4},"end":{"line":217,"column":4}}]},"20":{"line":219,"type":"if","locations":[{"start":{"line":219,"column":8},"end":{"line":219,"column":8}},{"start":{"line":219,"column":8},"end":{"line":219,"column":8}}]},"21":{"line":219,"type":"binary-expr","locations":[{"start":{"line":219,"column":12},"end":{"line":219,"column":37}},{"start":{"line":219,"column":41},"end":{"line":219,"column":83}}]},"22":{"line":224,"type":"binary-expr","locations":[{"start":{"line":224,"column":19},"end":{"line":224,"column":23}},{"start":{"line":224,"column":27},"end":{"line":224,"column":29}}]},"23":{"line":226,"type":"binary-expr","locations":[{"start":{"line":226,"column":22},"end":{"line":226,"column":26}},{"start":{"line":226,"column":30},"end":{"line":226,"column":32}}]},"24":{"line":227,"type":"cond-expr","locations":[{"start":{"line":227,"column":27},"end":{"line":227,"column":35}},{"start":{"line":227,"column":39},"end":{"line":227,"column":41}}]},"25":{"line":234,"type":"binary-expr","locations":[{"start":{"line":234,"column":4},"end":{"line":234,"column":6}},{"start":{"line":234,"column":10},"end":{"line":234,"column":14}}]}},"code":["'use strict'","","/*","Application Master State","========================","Common state which either exists as part of the session,","or which has  been  loaded  from  scuttlebot during page","refresh because  its  commonly  needed during rendering.","*/","","// constants","var POLL_PEER_INTERVAL = 5e3 // every 5 seconds","","var multicb   = require('multicb')","var pull      = require('pull-stream')","var SSBClient = require('./ws-client')","var emojis    = require('emoji-named-characters')","var Emitter   = require('events')","var extend    = require('xtend/mutable')","var pu        = require('patchkit-util')","var favicon   = require('./favicon')","var createHashHistory = require('history').createHashHistory","var t         = require('patchwork-translations')","","// event streams and listeners","var patchworkEventStream = null","var isWatchingNetwork = false","","// master state object","var app =","module.exports = extend(new Emitter(), {","  // sbot rpc connection","  ssb: SSBClient(),","","  // pull state from sbot, called on every view change","  fetchLatestState: fetchLatestState,","","  // ui data","  history: createHashHistory({ queryKey: false }),","  isComposerOpen: false,","  suggestOptions: { ","    ':': Object.keys(emojis).map(function (emoji) {","      return {","        image: './img/emoji/' + emoji + '.png',","        title: emoji,","        subtitle: emoji,","        value: ':' + emoji + ':'","      }","    }),","    '@': []","  },","  issues: [],","  issue: addIssue.bind(null, true), // helper to add an issue","  minorIssue: addIssue.bind(null, false), // helper to add an issue that shouldnt trigger a modal","  notifications: [],","  notice: addNotification,","  dismissNotice: removeNotification,","","  // application state, fetched every refresh","  actionItems: {},","  indexCounts: {},","  channels: [], // array of { name: str, pinned: bool, lastUpdated: ts, hasNew: bool }","  user: {","    id: null,","    profile: {},","    needsSetup: false, // does the setup flow need to occur?","    followeds: [], // people the user follows","    friends: [], // people the user follows, who follow the user back","    nonfriendFolloweds: [], // people the user follows, who dont follow the user back","    nonfriendFollowers: [] // people the user doesnt follow, who follows the user","  },","  users: {","    names: {},","    profiles: {}","  },","  peers: [],","  isWifiMode: false","})","app.on('notice', app.notice)","","function addIssue (isUrgent, title, err, extraIssueInfo) {","  console.error(title, err, extraIssueInfo)","  var message = err.message || err.toString()","  var stack   = err.stack || ''","  var issueDesc = message + '\\n\\n' + stack + '\\n\\n' + (extraIssueInfo||'')","","  app.issues.unshift({","    isRead: false,","    isUrgent: isUrgent,","    title: title,","    message: message,","    stack: stack,","    issueUrl: 'https://github.com/ssbc/patchwork/issues/new?body='+encodeURIComponent(issueDesc)","  })","  app.emit('update:issues')","}","","var notificationUuidCounter = 0","function addNotification (message) {","  app.notifications.push({ key: ++notificationUuidCounter, message: message, dismissAfter: 5e3 })","  app.emit('update:notifications')","}","function removeNotification (notification) {","  app.notifications = app.notifications.filter(n => n !== notification)","  app.emit('update:notifications')","}","","function updateChannels (name, values) {","  // upsert","  var i","  for (i = 0; i < app.channels.length; i++) {","    if (app.channels[i].name === name) {","      // immutable update - create a new object, so shouldUpdate works nicely in the channels list com","      app.channels[i] = Object.assign({}, app.channels[i], values)","      break","    }","  }","  if (i === app.channels.length)","    app.channels.push(Object.assign({ name: name }, values))","","  // sort","  sortChannels()","}","","function sortChannels () {","  app.channels.sort(function (a, b) {","    // go by last updated","    return b.lastUpdated - a.lastUpdated","  })","}","","function onPatchworkEvent (e) {","  if (e.type == 'index-change') {","    for (var k in e.counts)","      app.indexCounts[k] = e.counts[k]","    app.emit('update:indexCounts')","    updateTitle()","    if (e.index.indexOf('channel-') === 0) {","      updateChannels(e.index.slice('channel-'.length), { lastUpdated: Date.now() })","      app.emit('update:channels')      ","    }","  }","  else if (e.type == 'isread') {","    app.emit('update:isread', { key: e.key, value: e.value })","  }","  else if (e.type == 'channelpinned') {","    updateChannels(e.channel, { pinned: e.value })","    app.emit('update:channels')","  }","  else if (e.type == 'channelwatched') {","    updateChannels(e.channel, { watched: e.value })","    app.emit('update:channels')","  }","}","","function pollPeers () {","  app.ssb.gossip.peers(function (err, peers) {","    var isWifiMode = require('./util').getPubStats(peers).hasSyncIssue","    app.peers = peers","    app.emit('update:peers')","    if (isWifiMode !== app.isWifiMode) {","      app.isWifiMode = isWifiMode","      app.emit('update:isWifiMode')","    }","  })","}","","function updateTitle () {","  document.title = t('Patchwork')","  favicon.update({ label: app.indexCounts.inboxUnread })","}","window.favicon = favicon","","function fetchLatestState (cb) {","  if (!patchworkEventStream)","    pull((patchworkEventStream = app.ssb.patchwork.createEventStream()), pull.drain(onPatchworkEvent.bind(this)))","  if (!isWatchingNetwork) {","    setInterval(pollPeers, POLL_PEER_INTERVAL)","    isWatchingNetwork = true","  }","","  var done = multicb({ pluck: 1 })","  app.ssb.whoami(done())","  app.ssb.patchwork.getNamesById(done())","  app.ssb.patchwork.getAllProfiles(done())","  app.ssb.patchwork.getActionItems(done())","  app.ssb.patchwork.getIndexCounts(done())","  app.ssb.gossip.peers(done())","  if (!app.channels.length)","    app.ssb.patchwork.getChannels(done())","  done(function (err, data) {","    if (err) throw err.message","    app.user.id         = data[0].id","    app.users.names     = data[1]","    app.users.profiles  = data[2]","    app.actionItems     = data[3]","    app.indexCounts     = data[4]","    app.peers           = data[5]","    if (data[6]) {","      app.channels        = data[6]","      sortChannels()","    }","    app.isWifiMode      = require('./util').getPubStats(app.peers).hasSyncIssue","    app.user.profile    = app.users.profiles[app.user.id]","    app.user.needsSetup = !app.users.names[app.user.id]","    updateTitle()","","    // get friend list","    var social = require('patchkit-util/social')","    app.user.followeds = social.followeds(app.users, app.user.id)","    app.user.friends = app.user.followeds.filter(function (other) { return other !== app.user.id && social.follows(app.users, other, app.user.id) })","    app.user.nonfriendFolloweds = app.user.followeds.filter(function (other) { return other !== app.user.id && !social.follows(app.users, other, app.user.id) })","    app.user.nonfriendFollowers = social.unfollowedFollowers(app.users, app.user.id, app.user.id)","","    // refresh suggest options for usernames","    app.suggestOptions['@'] = []","    if (app.user.profile) {","      for (var id in app.users.profiles) {","        if (id == app.user.profile.id || social.follows(app.users, app.user.id, id)) {","          var name = app.users.names[id]","          app.suggestOptions['@'].push({","            id: id,","            cls: 'user',        ","            title: name || id,","            image: pu.getProfilePicUrl(app.users, id),","            subtitle: name || id,","            value: name ? ('@'+name) : id","          })","        }","      }","    }","","    app.emit('update:all')","    cb && cb()","  })","}"],"l":{"12":2,"14":2,"15":2,"16":2,"17":2,"18":2,"19":2,"20":2,"21":2,"22":0,"23":0,"26":0,"27":0,"30":0,"43":0,"79":0,"81":1,"82":0,"83":0,"84":0,"85":0,"87":0,"95":0,"98":0,"99":1,"100":0,"101":0,"103":1,"104":0,"105":0,"108":1,"110":0,"111":0,"112":0,"114":0,"115":0,"118":0,"119":0,"122":0,"125":1,"126":0,"128":0,"132":1,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"143":0,"144":0,"146":0,"147":0,"148":0,"150":0,"151":0,"152":0,"156":1,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"168":1,"169":0,"170":0,"172":0,"174":1,"175":0,"176":0,"177":0,"178":0,"179":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"203":0,"204":0,"205":0,"206":0,"209":0,"210":0,"211":0,"212":0,"213":0,"216":0,"217":0,"218":0,"219":0,"220":0,"221":0,"233":0,"234":0}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/ui/lib/ws-client.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/ui/lib/ws-client.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":1,"15":0,"16":0,"17":0,"18":0},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":7,"loc":{"start":{"line":7,"column":17},"end":{"line":7,"column":29}}},"2":{"name":"serialize","line":18,"loc":{"start":{"line":18,"column":0},"end":{"line":18,"column":28}}},"3":{"name":"onConnectionLost","line":22,"loc":{"start":{"line":22,"column":0},"end":{"line":22,"column":29}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":34}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":39}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":42}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":43}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":50}},"6":{"start":{"line":7,"column":0},"end":{"line":16,"column":1}},"7":{"start":{"line":9,"column":2},"end":{"line":9,"column":55}},"8":{"start":{"line":12,"column":2},"end":{"line":12,"column":72}},"9":{"start":{"line":13,"column":2},"end":{"line":13,"column":106}},"10":{"start":{"line":14,"column":2},"end":{"line":14,"column":42}},"11":{"start":{"line":15,"column":2},"end":{"line":15,"column":12}},"12":{"start":{"line":18,"column":0},"end":{"line":20,"column":1}},"13":{"start":{"line":19,"column":2},"end":{"line":19,"column":50}},"14":{"start":{"line":22,"column":0},"end":{"line":27,"column":1}},"15":{"start":{"line":23,"column":2},"end":{"line":23,"column":40}},"16":{"start":{"line":24,"column":2},"end":{"line":24,"column":34}},"17":{"start":{"line":25,"column":2},"end":{"line":25,"column":62}},"18":{"start":{"line":26,"column":2},"end":{"line":26,"column":58}}},"branchMap":{"1":{"line":12,"type":"cond-expr","locations":[{"start":{"line":12,"column":58},"end":{"line":12,"column":64}},{"start":{"line":12,"column":67},"end":{"line":12,"column":72}}]}},"code":["var muxrpc     = require('muxrpc')","var pull       = require('pull-stream')","var ws         = require('pull-ws-server')","var Serializer = require('pull-serializer')","var t          = require('patchwork-translations')","","module.exports = function () {","  // create rpc object","  var ssb = muxrpc(window.MANIFEST, false, serialize)()","","  // setup rpc stream over websockets","  var protocol = (window.location.protocol == 'https:') ? 'wss:' : 'ws:'","  var stream = ws.connect(protocol+'//'+(window.location.hostname)+':7777', { onClose: onConnectionLost })","  pull(stream, ssb.createStream(), stream)","  return ssb","}","","function serialize (stream) {","  return Serializer(stream, JSON, {split: '\\n\\n'})","}","","function onConnectionLost () {","  var el = document.createElement('div')","  el.className = 'connection-lost'","  el.appendChild(document.createTextNode(t('connectionLost')))","  document.body.insertBefore(el, document.body.firstChild)","}"],"l":{"1":1,"2":1,"3":1,"4":1,"5":1,"7":1,"9":0,"12":0,"13":0,"14":0,"15":0,"18":1,"19":0,"22":1,"23":0,"24":0,"25":0,"26":0}},"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/ui/lib/favicon.js":{"path":"/home/travis/build/npmtest/node-npmtest-ssb-patchwork/node_modules/ssb-patchwork/ui/lib/favicon.js","s":{"1":4,"2":4,"3":4,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":1,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":7,"loc":{"start":{"line":7,"column":24},"end":{"line":7,"column":40}}},"2":{"name":"draw","line":17,"loc":{"start":{"line":17,"column":0},"end":{"line":17,"column":17}}},"3":{"name":"loadImg","line":70,"loc":{"start":{"line":70,"column":0},"end":{"line":70,"column":22}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":33}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":43}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":45}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":14}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":17}},"6":{"start":{"line":7,"column":0},"end":{"line":15,"column":1}},"7":{"start":{"line":8,"column":2},"end":{"line":13,"column":3}},"8":{"start":{"line":9,"column":4},"end":{"line":12,"column":24}},"9":{"start":{"line":10,"column":6},"end":{"line":10,"column":28}},"10":{"start":{"line":12,"column":6},"end":{"line":12,"column":24}},"11":{"start":{"line":14,"column":2},"end":{"line":14,"column":15}},"12":{"start":{"line":17,"column":0},"end":{"line":67,"column":1}},"13":{"start":{"line":18,"column":2},"end":{"line":18,"column":53}},"14":{"start":{"line":19,"column":2},"end":{"line":19,"column":56}},"15":{"start":{"line":20,"column":2},"end":{"line":20,"column":49}},"16":{"start":{"line":21,"column":2},"end":{"line":21,"column":69}},"17":{"start":{"line":24,"column":2},"end":{"line":24,"column":29}},"18":{"start":{"line":25,"column":2},"end":{"line":25,"column":30}},"19":{"start":{"line":26,"column":2},"end":{"line":26,"column":25}},"20":{"start":{"line":27,"column":2},"end":{"line":27,"column":30}},"21":{"start":{"line":28,"column":2},"end":{"line":28,"column":25}},"22":{"start":{"line":29,"column":2},"end":{"line":29,"column":29}},"23":{"start":{"line":31,"column":2},"end":{"line":31,"column":42}},"24":{"start":{"line":32,"column":2},"end":{"line":32,"column":35}},"25":{"start":{"line":33,"column":2},"end":{"line":33,"column":50}},"26":{"start":{"line":36,"column":2},"end":{"line":36,"column":42}},"27":{"start":{"line":36,"column":15},"end":{"line":36,"column":41}},"28":{"start":{"line":37,"column":2},"end":{"line":37,"column":30}},"29":{"start":{"line":38,"column":2},"end":{"line":38,"column":27}},"30":{"start":{"line":40,"column":2},"end":{"line":60,"column":3}},"31":{"start":{"line":42,"column":4},"end":{"line":42,"column":32}},"32":{"start":{"line":43,"column":4},"end":{"line":43,"column":31}},"33":{"start":{"line":44,"column":4},"end":{"line":44,"column":29}},"34":{"start":{"line":45,"column":4},"end":{"line":45,"column":29}},"35":{"start":{"line":55,"column":4},"end":{"line":55,"column":30}},"36":{"start":{"line":56,"column":4},"end":{"line":59,"column":5}},"37":{"start":{"line":63,"column":2},"end":{"line":63,"column":25}},"38":{"start":{"line":64,"column":2},"end":{"line":64,"column":49}},"39":{"start":{"line":65,"column":2},"end":{"line":65,"column":44}},"40":{"start":{"line":65,"column":17},"end":{"line":65,"column":43}},"41":{"start":{"line":66,"column":2},"end":{"line":66,"column":30}},"42":{"start":{"line":69,"column":0},"end":{"line":69,"column":14}},"43":{"start":{"line":70,"column":0},"end":{"line":90,"column":1}},"44":{"start":{"line":72,"column":2},"end":{"line":73,"column":15}},"45":{"start":{"line":73,"column":4},"end":{"line":73,"column":15}},"46":{"start":{"line":76,"column":2},"end":{"line":77,"column":30}},"47":{"start":{"line":77,"column":4},"end":{"line":77,"column":30}},"48":{"start":{"line":80,"column":2},"end":{"line":80,"column":19}},"49":{"start":{"line":83,"column":2},"end":{"line":83,"column":37}},"50":{"start":{"line":84,"column":2},"end":{"line":84,"column":31}},"51":{"start":{"line":85,"column":2},"end":{"line":88,"column":3}},"52":{"start":{"line":86,"column":4},"end":{"line":86,"column":34}},"53":{"start":{"line":86,"column":29},"end":{"line":86,"column":33}},"54":{"start":{"line":87,"column":4},"end":{"line":87,"column":21}},"55":{"start":{"line":89,"column":2},"end":{"line":89,"column":21}}},"branchMap":{"1":{"line":8,"type":"if","locations":[{"start":{"line":8,"column":2},"end":{"line":8,"column":2}},{"start":{"line":8,"column":2},"end":{"line":8,"column":2}}]},"2":{"line":9,"type":"if","locations":[{"start":{"line":9,"column":4},"end":{"line":9,"column":4}},{"start":{"line":9,"column":4},"end":{"line":9,"column":4}}]},"3":{"line":9,"type":"binary-expr","locations":[{"start":{"line":9,"column":8},"end":{"line":9,"column":37}},{"start":{"line":9,"column":41},"end":{"line":9,"column":55}},{"start":{"line":9,"column":59},"end":{"line":9,"column":74}}]},"4":{"line":36,"type":"if","locations":[{"start":{"line":36,"column":2},"end":{"line":36,"column":2}},{"start":{"line":36,"column":2},"end":{"line":36,"column":2}}]},"5":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":2},"end":{"line":40,"column":2}},{"start":{"line":40,"column":2},"end":{"line":40,"column":2}}]},"6":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":2},"end":{"line":65,"column":2}},{"start":{"line":65,"column":2},"end":{"line":65,"column":2}}]},"7":{"line":72,"type":"if","locations":[{"start":{"line":72,"column":2},"end":{"line":72,"column":2}},{"start":{"line":72,"column":2},"end":{"line":72,"column":2}}]},"8":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":2},"end":{"line":76,"column":2}},{"start":{"line":76,"column":2},"end":{"line":76,"column":2}}]}},"code":["const ICON_PATH = '/img/icon.png'","const FONT = 'Helvetica, Arial, sans-serif'","var canvas = document.createElement('canvas')","var img = null","var label = false","","module.exports.update = function (opts) {","  if ('label' in opts) {","    if (typeof opts.label == 'number' && opts.label > 0 && opts.label < 10)","      label = ' '+opts.label","    else","      label = opts.label","  }","  loadImg(draw)","}","","function draw () {","  var head = document.getElementsByTagName('head')[0]","  var favicon = document.querySelector('link[rel=icon]')","  var newFavicon = document.createElement('link')","  var multiplier, fontSize, context, xOffset, yOffset, border, shadow","","  // scale canvas elements based on favicon size","  multiplier = img.width / 16","  fontSize   = multiplier * 11","  xOffset    = multiplier","  yOffset    = multiplier * 11","  border     = multiplier","  shadow     = multiplier * 4","","  canvas.height = canvas.width = img.width","  context = canvas.getContext('2d')","  context.font = 'bold ' + fontSize + 'px ' + FONT","","  // draw favicon background","  if (label) { context.globalAlpha = 0.8 }","  context.drawImage(img, 0, 0)","  context.globalAlpha = 1.0","","  if (label) {","    // draw drop shadow","    context.shadowColor = '#000'","    context.shadowBlur = shadow","    context.shadowOffsetX = 0","    context.shadowOffsetY = 0","","    // draw border","    // context.fillStyle = '#000'","    // context.fillText(label, xOffset, yOffset)","    // context.fillText(label, xOffset + border, yOffset)","    // context.fillText(label, xOffset, yOffset + border)","    // context.fillText(label, xOffset + border, yOffset + border)","","    // draw label","    context.fillStyle = '#FFF'","    context.fillText(label,","      xOffset + (border / 2.0),","      yOffset + (border / 2.0)","    )","  }","","  // replace favicon with new favicon","  newFavicon.rel = 'icon'","  newFavicon.href = canvas.toDataURL('image/png')","  if (favicon) { head.removeChild(favicon) }","  head.appendChild(newFavicon)","}","","var loadImgCbs","function loadImg (cb) {","  // already loaded?","  if (img)","    return cb() // go","","  // queue active?","  if (loadImgCbs)","    return loadImgCbs.push(cb) // add to queue","","  // start the queue","  loadImgCbs = [cb]","","  // load image","  img = document.createElement('img')","  img.crossOrigin = 'anonymous'","  img.onload = () => {","    loadImgCbs.forEach(cb => cb())","    loadImgCbs = null","  }","  img.src = ICON_PATH","}"],"l":{"1":4,"2":4,"3":4,"4":0,"5":0,"7":0,"8":0,"9":0,"10":0,"12":0,"14":0,"17":1,"18":0,"19":0,"20":0,"21":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"31":0,"32":0,"33":0,"36":0,"37":0,"38":0,"40":0,"42":0,"43":0,"44":0,"45":0,"55":0,"56":0,"63":0,"64":0,"65":0,"66":0,"69":0,"70":1,"72":0,"73":0,"76":0,"77":0,"80":0,"83":0,"84":0,"85":0,"86":0,"87":0,"89":0}}}